CREATE TABLE IF NOT EXISTS `rule` (
    `id`                         varchar(50)         NOT NULL,
    `name`                       varchar(50)         DEFAULT NULL UNIQUE COMMENT '规则名称',
    `status`                     tinyint(1)          DEFAULT 1 COMMENT '规则状态(启用1，停用0)',
    `severity`                   varchar(32)         DEFAULT NULL COMMENT '风险等级',
    `description`                varchar(1024)       DEFAULT NULL COMMENT '`描述',
    `script`                     mediumtext          DEFAULT NULL COMMENT '脚本',
    `parameter`                  varchar(1024)       DEFAULT NULL COMMENT '参数',
    `plugin_id`                  varchar(64)         DEFAULT NULL COMMENT '插件ID',
    `plugin_name`                varchar(64)         DEFAULT NULL COMMENT '云平台名称',
    `plugin_icon`                varchar(128)        DEFAULT NULL COMMENT '云平台图标',
    `last_modified`              bigint(14)          DEFAULT NULL COMMENT '上次更新时间',
    `flag`                       tinyint(1)          NOT NULL DEFAULT 0 COMMENT '是否内置',
    `scan_type`                  varchar(32)         DEFAULT NULL COMMENT '检测类型',
    PRIMARY KEY (`id`),
    KEY `IDX_NAME` (`name`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_bin;

CREATE TABLE IF NOT EXISTS `rule_tag` (
    `tag_key`                    varchar(50)         NOT NULL UNIQUE COMMENT '标签标识',
    `tag_name`                   varchar(100)        NOT NULL UNIQUE COMMENT '标签名',
    `_index`                     int(11)             NOT NULL AUTO_INCREMENT COMMENT '索引',
    `flag`                       tinyint(1)          NOT NULL DEFAULT 0 COMMENT '是否内置',
    PRIMARY KEY (`tag_key`),
    KEY `IDX_KEY_NAME` (`tag_name`),
    KEY `IDX_INDEX` (`_index`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4;


CREATE TABLE IF NOT EXISTS `rule_tag_mapping` (
    `id`                         int(10)             NOT NULL AUTO_INCREMENT,
    `rule_id`                    varchar(50)         NOT NULL COMMENT '规则ID',
    `tag_key`                    varchar(50)         NOT NULL COMMENT '标签标识',
    PRIMARY KEY (`id`),
    KEY `IDX_RULE_ID` (`rule_id`),
    KEY `IDX_TAG_KEY` (`tag_key`)
) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = utf8mb4;


CREATE TABLE IF NOT EXISTS `rule_type` (
    `id`                         varchar(50)         NOT NULL,
    `rule_id`                    varchar(50)         NOT NULL COMMENT '规则ID',
    `resource_type`              varchar(50)         NOT NULL COMMENT '资源类型',
    PRIMARY KEY (`id`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_bin;

CREATE TABLE IF NOT EXISTS `rule_account_parameter` (
    `id`                         int(11)             NOT NULL AUTO_INCREMENT,
    `account_id`                 varchar(50)         DEFAULT NULL COMMENT '云账号ID',
    `rule_id`                    varchar(50)         DEFAULT NULL COMMENT '规则ID',
    `parameter`                  varchar(1024)       DEFAULT NULL COMMENT '参数',
    `regions`                    longtext            DEFAULT NULL COMMENT '区域',
    PRIMARY KEY (`id`)
) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = utf8mb4;

CREATE TABLE IF NOT EXISTS `rule_group` (
    `id`                         int(10)             NOT NULL AUTO_INCREMENT,
    `name`                       varchar(50)         DEFAULT NULL COMMENT '规则组名称',
    `description`                varchar(1024)       DEFAULT NULL COMMENT '规则组描述',
    `level`                      varchar(64)         DEFAULT NULL COMMENT '风险级别',
    `plugin_id`                  varchar(64)         DEFAULT NULL COMMENT '插件ID',
    `flag`                       tinyint(1)          NOT NULL DEFAULT 0 COMMENT '是否内置',
    PRIMARY KEY (`id`)
) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = utf8mb4;

CREATE TABLE IF NOT EXISTS `rule_group_mapping` (
    `id`                         int(10)             NOT NULL AUTO_INCREMENT,
    `rule_id`                    varchar(50)         DEFAULT NULL COMMENT '规则ID',
    `group_id`                   varchar(50)         DEFAULT NULL COMMENT '规则组ID',
    PRIMARY KEY (`id`),
    KEY `IDX_RULE_ID` (`rule_id`),
    KEY `IDX_GROUP_ID` (`group_id`)
) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = utf8mb4;

CREATE TABLE IF NOT EXISTS `rule_inspection_report` (
    `id`                         int(10)             NOT NULL AUTO_INCREMENT,
    `project`                    varchar(256)        DEFAULT NULL COMMENT '检查项目',
    `item_sort_first_level`      varchar(50)         DEFAULT NULL COMMENT '检查项一级分类',
    `item_sort_second_level`     varchar(50)         DEFAULT NULL COMMENT '检查项二级分类',
    `improvement`                varchar(512)        DEFAULT NULL COMMENT '改进建议',
    PRIMARY KEY (`id`)
) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = utf8mb4;

CREATE TABLE IF NOT EXISTS `rule_inspection_report_mapping` (
    `id`                         int(10)             NOT NULL AUTO_INCREMENT,
    `rule_id`                    varchar(50)         DEFAULT NULL COMMENT '规则ID',
    `report_id`                  varchar(50)         DEFAULT NULL COMMENT '等保合规检查报告ID',
    PRIMARY KEY (`id`),
    KEY `IDX_RULE_ID` (`rule_id`),
    KEY `IDX_REPORT_ID` (`report_id`)
) ENGINE = InnoDB AUTO_INCREMENT = 1 DEFAULT CHARSET = utf8mb4;


INSERT INTO rule_tag (tag_key, tag_name, _index, flag) VALUES ('safety', '安全', 1, 1);
INSERT INTO rule_tag (tag_key, tag_name, _index, flag) VALUES ('cost', '费用', 2, 1);
INSERT INTO rule_tag (tag_key, tag_name, _index, flag) VALUES ('tagging', '标签', 3, 1);
INSERT INTO rule_tag (tag_key, tag_name, _index, flag) VALUES ('server', '实例', 4, 1);
INSERT INTO rule_tag (tag_key, tag_name, _index, flag) VALUES ('image', '镜像', 5, 1);

INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Aliyun 等保预检', '等保合规检查（全称为等级保护合规检查）为您提供了全面覆盖通信网络、区域边界、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-aliyun-plugin', 1);
SELECT @groupId1 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Aliyun CIS合规检查', 'CIS（Center for Internet Security）合规检查能力，为您动态且持续地监控您保有在云上的资源是否符合 CIS Control 网络安全架构要求。', '高风险', 'hummer-aliyun-plugin', 1);
SELECT @groupId2 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Aliyun OSS合规基线', 'OSS 合规检查为您提供全方位的对象存储资源检查功能。', '高风险', 'hummer-aliyun-plugin', 1);
SELECT @groupId3 := LAST_INSERT_ID();

INSERT INTO rule_inspection_report VALUES (1, '应保证网络设备的业务处理能力满足业务高峰期需要。', '安全通信网络', '网络架构', '您可以通过VPC控制台，定期查看当前资源配额使用情况。');
INSERT INTO rule_inspection_report VALUES (2, '应保证网络各个部分的带宽满足业务高峰期需要。', '安全通信网络', '网络架构', '您可以根据业务实际情况在创建实例是申请带宽，云监控支持通过监控弹性公网IP支持网络带宽监控。另可以配置 DDoS 原生防护能力，保障业务高可用性。');
INSERT INTO rule_inspection_report VALUES (3, '应划分不同的网络区域，并按照方便管理和控制的原则为各网络区域分配地址。', '安全通信网络', '网络架构', '您可以基于业务需求划分不同的安全域，配置IP地址范围、配置路由表和网关等。');
INSERT INTO rule_inspection_report VALUES (4, '应避免将重要网络区域部署在边界处，重要网络区域与其他网络区域之间应采取可靠的技术隔离手段。', '安全通信网络', '网络架构', '您需要配置访问控制策略，可配置云防火墙实现VPC内部东西流量隔离，提升VPC安全性。');
INSERT INTO rule_inspection_report VALUES (5, '应提供通信线路、关键网络设备的硬件冗余，保证系统的可用性。', '安全通信网络', '网络架构', '您需要配置负载均衡产品，保障在流量波动情况下不中断对外服务。');
INSERT INTO rule_inspection_report VALUES (6, '应采用密码技术保证通信过程中数据的完整性。', '安全通信网络', '通信传输', '您需要设置证书，保障互联网通信的安全性和数据完整性。');
INSERT INTO rule_inspection_report VALUES (7, '应采用密码技术保证通信过程中数据的保密性。', '安全通信网络', '通信传输', '您需要设置证书，保障互联网通信的安全性和数据完整性。');
INSERT INTO rule_inspection_report VALUES (8, '可基于可信根对通信设备的系统引导程序、系统程序、重要配置参数和通信应用程序等进行可信验证，并在应用程序的所有执行环节进行动态可信验证，在检测到其可信性受到破坏后进行报警，并将验证结果形成审计记录送至安全管理中心，并进行动态关联感知。', '安全通信网络', '可信验证', '因该指标只要求“可”，不是强制要求项。');
INSERT INTO rule_inspection_report VALUES (9, '应保证跨越边界的访问和数据流通过边界设备提供的受控接口进行通信。', '安全区域边界', '边界防护', '您可以通过IPSEC VPN远程访问，使业务数据可以在公网上通过IP加密信道进行传输，同时访问使用SSL VPN，保障通信链路中数据的保密性。');
INSERT INTO rule_inspection_report VALUES (10, '应能够对非授权设备私自联到内部网络的行为进行限制或检查。', '安全区域边界', '边界防护', '您需要部署第三方网络接入控制系统，限制运维终端等设备非法接入到内部网络，云防火墙支持云服务器从内对外访问控制策略配置。');
INSERT INTO rule_inspection_report VALUES (11, '应能够对内部用户非授权联到外部网络的行为进行限制或检查。', '安全区域边界', '边界防护', '部署云防火墙实现南北向和东西向访问的网络流量分析，全网流量可视化，对主动外联行为的分析和阻断，配置开通、变更白名单策略。\n部署云安全中心实现非授权联到外部恶意域名、IP地址的行为进行检查和拦截。\n如果是IDC环境，您需要根据云下资产对象，独立部署第三方网络接入控制系统。');
INSERT INTO rule_inspection_report VALUES (12, '应限制无线网络的使用，保证无线网络通过受控的边界设备接入内部网络。', '安全区域边界', '边界防护', '您可以根据云下无线网络环境，部署第三方网络接入控制系统，配置禁用无线网卡的策略，无线网络的使用按照客户需求和具体应用场景而定应限制无线网络的使用，保证无线网络通过受控的边界设备接入内部网络。');
INSERT INTO rule_inspection_report VALUES (13, '应在网络边界或区域之间根据访问控制策略设置访问控制规则，默认情况下除允许通信外受控接口拒绝所有通信。', '安全区域边界', '访问控制', '云服务客户配置ACL访问控制策略，访问控制粒度为端口级。\n部署云防火墙实现统一管理互联网到业务的南北向访问策略和业务与业务之间的东西向微隔离策略，达到端口级访问控制粒度。');
INSERT INTO rule_inspection_report VALUES (14, '应删除多余或无效的访问控制规则，优化访问控制列表，并保证访问控制规则数量最小化。', '安全区域边界', '访问控制', '您需要根据业务需求优化访问控制列表。\n部署云防火墙实现策略命中计数功能，确保没有无效的冗余策略，云防火墙访问控制策略可配置优先级，优化访问控制列表。');
INSERT INTO rule_inspection_report VALUES (15, '应对源地址、目的地址、源端口、目的端口和协议等进行检查，以允许/拒绝数据包进出。', '安全区域边界', '访问控制', '您需要根据业务需求配置恰当的访问控制策略表。\n部署云防火墙实现对进出访问控制策略进行严格设置，访问控制策略包括源类型、访问源、目的类型、目的、协议类型、目的端口、应用协议、动作、描述和优先级。');
INSERT INTO rule_inspection_report VALUES (16, '应能根据会话状态信息为进出数据流提供明确的允许/拒绝访问的能力。', '安全区域边界', '访问控制', '部署云安全中心企业版实现网络流量和主机中的入侵行为和文件样本进行实时检测和防御。\n部署云防火墙实现对互联网上的恶意流量入侵活动和常规攻击行为进行实时阻断和拦截。\n部署Web应用防火墙实现流量检测、过滤、清洗后再代理转发到应用服务器。\n部署DDoS高防实现抵御各类基于网络层、传输层及应用层的DDoS攻击，秒级启动流量清洗，过滤掉攻击流量支持全自动检测和攻击策略匹配，实时防护，清洗服务可用性99.95%，可定制99.99%。');
INSERT INTO rule_inspection_report VALUES (17, '应对进出网络的数据流实现基于应用协议和应用内容的访问控制。', '安全区域边界', '访问控制', '部署云防火墙实现跨VPC数据流的应用协议、内容的访问控制。\n部署Web应用防火墙实现应用级协议和内容访问控制。\n部署DDoS高防实现所有业务流量进行清洗，支持网络四层和七层防护。');
INSERT INTO rule_inspection_report VALUES (18, '应在关键网络节点处检测、防止或限制从外部发起的网络攻击行为。', '安全区域边界', '入侵防范', '部署云安全中心企业版实现网络流量和主机中的入侵行为和文件样本进行实时检测和防御。\n部署云防火墙实现对互联网上的恶意流量入侵活动和常规攻击行为进行实时阻断和拦截。\n部署Web应用防火墙实现流量检测、过滤、清洗后再代理转发到应用服务器。\n部署DDoS高防实现抵御各类基于网络层、传输层及应用层的DDoS攻击，秒级启动流量清洗，过滤掉攻击流量支持全自动检测和攻击策略匹配，实时防护，清洗服务可用性99.95%，可定制99.99%。');
INSERT INTO rule_inspection_report VALUES (19, '应在关键网络节点处检测、防止或限制从内部发起的网络攻击行为。', '安全区域边界', '入侵防范', '部署云安全中心企业版实现主机系统层和应用层的主动外联和恶意攻击行为，对进程、网络异常行为进行预警。\n部署云防火墙实现检测东西向流量，配置相应的安全策略，阻断防止从内部发起的网络攻击行为。');
INSERT INTO rule_inspection_report VALUES (20, '应采取技术措施对网络行为进行分析，实现对网络攻击特别是新型网络攻击行为的分析。', '安全区域边界', '入侵防范', '部署云安全中心企业版实现挖矿、勒索、蠕虫、DDoS木马等基于新型网络攻击的攻击预警。\n部署云防火墙对云上进出网络的恶意流量进行实时检测与阻断，支持防御挖矿蠕虫等新型网络攻击，并通过积累大量恶意攻击样本，形成精准防御规则；云防火墙入侵检测功能支持发现挖矿蠕虫感染事件。');
INSERT INTO rule_inspection_report VALUES (21, '当检测到攻击行为时，记录攻击源IP、攻击类型、攻击目的、攻击时间，在发生严重入侵事件时应提供报警。', '安全区域边界', '入侵防范', '部署云安全中心企业版实现检测到威胁时，记录事件账号/源地址、攻击类型、攻击时间、事件级别以及处置建议，同时支持自动化攻击溯源，展示攻击过程。\n部署云防火墙实现检测攻击行为，提供网络阻断功能，记录风险级别、事件名称、防御状态、源IP、目的IP、方向、判断来源、发生时间和动作。\n部署Web应用防火墙实现HTTP和HTTPS流量攻击，记录攻击事件类型、攻击URL、来源IP、目的Host、时间、Get请求内容和拦截动作。\n部署DDoS高防实现DDoS攻击时，记录攻击类型、攻击目标、攻击时间、攻击流量峰值和清洗防护结果。');
INSERT INTO rule_inspection_report VALUES (22, '应在关键网络节点处对恶意代码进行检测和清除，并维护恶意代码防护机制的升级和更新。', '安全区域边界', '恶意代码和垃圾邮件防范', '部署云安全中心实现蠕虫病毒、勒索病毒、木马、网站后门等恶意代码的检测和隔离清除，定期升级相关恶意代码规则库。\n部署云防火墙实现网络入侵防护和恶意代码防范。\n部署Web应用防火墙实现流量恶意代码检测提供恶意代码检测功能，恶意代码规则库定期更新。');
INSERT INTO rule_inspection_report VALUES (23, '应在关键网络节点处对垃圾邮件进行检测和防护，并维护垃圾邮件防护机制的升级和更新。', '安全区域边界', '恶意代码和垃圾邮件防范', '您需求加固自身邮件服务器具备防垃圾邮件功能或部署第三方邮件防护系统。');
INSERT INTO rule_inspection_report VALUES (24, '应在网络边界、重要网络节点进行安全审计，审计覆盖到每个用户，对重要的用户行为和重要安全事件进行审计。', '安全区域边界', '安全审计', '部署云安全中心企业版实现主机登录日志、进程启动、网络连接、端口快照、账户快照、暴力破解、网络会话、DNS解析、WEB会话、安全告警、漏洞和基线日志进行审计。\n部署云防火墙实现日志审计模块记录所有流量日志、事件日志和操作日志。\n部署Web应用防火墙对攻击日志支持日志实时查询分析。\n部署堡垒机实现对云端虚拟主机ECS资产进行运维权限管控及运维审计。\n部署数据库审计产品实现对云上数据库访问行为进行监控，分析危险操作及可疑行为。');
INSERT INTO rule_inspection_report VALUES (25, '审计记录应包括事件的日期和时间、用户、事件类型、事件是否成功及其他与审计相关的信息。', '安全区域边界', '安全审计', '部署云安全中心企业版实现检测到威胁时，记录事件账号/源地址、攻击类型、攻击时间、事件级别以及处置建议。\n部署云防火墙实现日志记录事件被检测到的时间、威胁类型、出/入方向、源IP和目的IP、应用类型、严重性等级以及动作状态等信息；\n部署Web应用防火墙实现记录攻击事件类型、攻击URL、来源IP、目的Host、时间、Get请求内容和拦截动作。\n部署DDoS高防实现检测到DDoS攻击时，记录攻击类型、攻击目标、攻击时间、攻击流量峰值和清洗防护结果。\n部署堡垒机实现日志记录，包括重要性、时间、日志类型、日志内容、用户、源IP地址和结果。');
INSERT INTO rule_inspection_report VALUES (26, '应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等。', '安全区域边界', '安全审计', '部署云安全中心、云防火墙、Web应用防火墙、DDoS高防、堡垒机和数据库审计等安全产品实现日志分析功能，依托日志服务产品，可存储6个月内的日志数据提供实时日志分析能力。');
INSERT INTO rule_inspection_report VALUES (27, '应能对远程访问的用户行为、访问互联网的用户行为等单独进行行为审计和数据分析。', '安全区域边界', '安全审计', '部署云安全中心、云防火墙、Web应用防火墙、DDoS高防、堡垒机和数据库审计等安全产品实现日志分析功能，依托日志服务产品，可存储6个月内的日志数据提供实时日志分析能力。');
INSERT INTO rule_inspection_report VALUES (28, '可基于可信根对边界设备的系统引导程序、系统程序、重要配置参数和边界防护应用程序等进行可信验证，并在应用程序的所有执行环节进行动态可信验证，在检测到其可信性受到破坏后进行报警，并将验证结果形成审计记录送至安全管理中心，并进行动态关联感知。', '安全区域边界', '可信验证', '因该指标只要求“可”，不是强制要求项。');
INSERT INTO rule_inspection_report VALUES (29, '应对登录的用户进行身份标识和鉴别，身份标识具有唯一性，身份鉴别信息具有复杂度要求并定期更换。', '安全计算环境', '身份鉴别', '部署云安全中心企业版实现对云服务客户登录的配置和密码复杂度进行定期安全检查，并提供安全建议并进行预警。\n部署堡垒机实现口令策略支持8个字符以上，必须包含大写字母、小写字母、数字及特殊符号，用户身份有唯一标识，口令90天定期跟换，新用户强制更改口令。');
INSERT INTO rule_inspection_report VALUES (30, '应具有登录失败处理功能，应配置并启用结束会话、限制非法登录次数和当登录连接超时自动退出等相关措施。', '安全计算环境', '身份鉴别', '部署堡垒机实现登录失败处理功能配置，建议配置云服务客户最大登录失败5次，临时锁定30分钟，登录连接超时时间为30分钟。\n部署云安全中心实现登录失败防御配置，支持云服务客户配置最大登录失败10次数，临时阻断连接1天、3天和7天。');
INSERT INTO rule_inspection_report VALUES (31, '当进行远程管理时，应采取必要措施，防止鉴别信息在网络传输过程中被窃听。', '安全计算环境', '身份鉴别', '部署堡垒机实现远程连接至云服务器时，采用安全的SSH方式进行远程登录。\n部署云安全中心实现对远程管理的配置进行检查，防止不安全的配置导致传输被窃听。');
INSERT INTO rule_inspection_report VALUES (32, '应采用口令、密码技术、生物技术等两种或两种以上组合的鉴别技术对用户进行身份鉴别，且其中一种鉴别技术至少应使用密码技术来实现。', '安全计算环境', '身份鉴别', '部署堡垒机实现作为唯一入口管理服务器，支持包括虚拟MFA、短信验证码在内的多因子认证。\n部署云安全中心实现对云平台配置提供基线核查，能够实时发现主账号双因素认证风险。');
INSERT INTO rule_inspection_report VALUES (33, '应对登录的用户分配账户和权限。', '安全计算环境', '访问控制', '您需求根据业务应用系统进行安全配置。需基于RAM对云服务进行合理授权。部署堡垒机实现作为唯一入口管理服务器。部署云安全中心实现对基线配置进行核查，识别潜在的账户、权限配置隐患。');
INSERT INTO rule_inspection_report VALUES (34, '应重命名或删除默认账户，修改默认账户的默认口令。', '安全计算环境', '访问控制', '您需要根据自身安全基线重命名或删除多余过期账户，或增强其口令。\n部署云安全中心实现安全基线的持续检查，告警。');
INSERT INTO rule_inspection_report VALUES (35, '应及时删除或停用多余的、过期的账户，避免共享账户的存在。', '安全计算环境', '访问控制', '部署堡垒机实现云服务客户对无用、多余账户会锁定或删除管理。\n部署云安全中心实现对平台账户进行安全配置检查。');
INSERT INTO rule_inspection_report VALUES (36, '应授予管理用户所需的最小权限，实现管理用户的权限分离。', '安全计算环境', '访问控制', '部署堡垒机实现基于用户角色分配权限，实现三权分立，角色分为超级管理员、审计员和运维员。\n部署云安全中心实现对账户权限配置的安全检查，云服务客户权限分离的检查。');
INSERT INTO rule_inspection_report VALUES (37, '应由授权主体配置访问控制策略，访问控制策略规定主体对客体的访问规则。', '安全计算环境', '访问控制', '您需要基于云产品配置指南和业务应用系统需求合理配置。');
INSERT INTO rule_inspection_report VALUES (38, '访问控制的粒度应达到主体为用户级或进程级，客体为文件、数据库表级。', '安全计算环境', '访问控制', '您需要基于云产品配置指南和业务应用系统需求合理配置。');
INSERT INTO rule_inspection_report VALUES (39, '应在关键网络节点处检测、防止或限制从内部发起的网络攻击行为。', '安全计算环境', '访问控制', '因现使用的操作系统安全级别无法达到B类强制保护级，操作系统侧自身暂无法实现强制访问控制。');
INSERT INTO rule_inspection_report VALUES (40, '应启用安全审计功能，审计覆盖到每个用户，对重要的用户行为和重要安全事件进行审计。', '安全计算环境', '安全审计', '部署堡垒机实现对所有云服务客户的虚拟主机操作进行审计，系统自身日志本地保存。\n部署数据库审计产品实现对数据库风险操作行为进行记录，提供细粒度审计数据库访问行为。\n部署云安全中心实现对账户登录进行记录，提供细粒度审计登录时间、登录账户、登录结果的记录，并通过报表进行实时监控预警。');
INSERT INTO rule_inspection_report VALUES (41, '审计记录应包括事件的日期、时间、类型、主体标识、客体标识和结果等。', '安全计算环境', '安全审计', '部署堡垒机实现日志记录，包括重要性、时间、日志类型、日志内容、用户、源IP地址和结果。\n部署数据库审计产品实现多维度线索分析，包括会话行为、SQL行为、风险行为和政策性报表。\n部署云安全中心实现日志记录，包括主机登录日志、进程启动、网络连接、账户快照、端口快照、DNS、Web访问、网站会话、云平台操作等日志结果。');
INSERT INTO rule_inspection_report VALUES (42, '应对审计记录进行保护，定期备份，避免受到未预期的删除、修改或覆盖等。', '安全计算环境', '安全审计', '部署堡垒机、数据库审计产品实现日志实时推送至日志服务，审计记录可按需调整存储空间，支持6个月以上保存期。\n部署云安全中心实现日志记录保存期为6个月，同时支持对操作审计日志配置进行基线核查。');
INSERT INTO rule_inspection_report VALUES (43, '应对审计进程进行保护，防止未经授权的中断。', '安全计算环境', '安全审计', '部署堡垒机、数据库审计产品实现日志实时推送至日志服务。\n部署云安全中心实现对操作审计日志配置进行基线核查。');
INSERT INTO rule_inspection_report VALUES (44, '应遵循最小安装的原则，仅安装需要的组件和应用程序。', '安全计算环境', '入侵防范', '云安全中心客户端在上线前，均经过内部的安全审核，并进行安全加固，遵循最小化安装原则。');
INSERT INTO rule_inspection_report VALUES (45, '应关闭不需要的系统服务、默认共享和高危端口。', '安全计算环境', '入侵防范', '部署云安全中心企业版开启云平台配置检查对主机、SLB、RDS、OSS等云产品进行高危配置、端口的基线检查。');
INSERT INTO rule_inspection_report VALUES (46, '应通过设定终端接入方式或网络地址范围对通过网络进行管理的管理终端进行限制。', '安全计算环境', '入侵防范', '部署云安全中心企业版开启云平台配置检查对主机、SLB、RDS、OSS等云产品进行高危配置、端口的基线检查。');
INSERT INTO rule_inspection_report VALUES (47, '应提供数据有效性检验功能，保证通过人机接口输入或通过通信接口输入的内容符合系统设定要求。', '安全计算环境', '入侵防范', '您需对业务系统对输入数据的有效性进行验证，过滤特殊字符。');
INSERT INTO rule_inspection_report VALUES (48, '应能发现可能存在的已知漏洞，并在经过充分测试评估后，及时修补漏洞。', '安全计算环境', '入侵防范', '部署云安全中心企业版实现漏洞修复，组件支持Linux漏洞、Windows漏洞、Web-CMS漏洞、应用漏洞和应急漏洞的一键修复功能，支持安全基线检测策略，支持平台安全配置等检查，能够实时检测已知漏洞。\n部署漏洞检测实现资产威胁检测，发现云服务客户业务系统关联资产，实现自动化漏洞渗透测试和敏感内容监测。\n进行渗透测试服务实现模拟黑客对云服务客户业务系统进行安全测试，发现安全缺陷和漏洞，并提出修复建议。');
INSERT INTO rule_inspection_report VALUES (49, '应能够检测到对重要节点进行入侵的行为，并在发生严重入侵事件时提供报警。', '安全计算环境', '入侵防范', '部署云安全中心企业版实现检测到对重要节点入侵行为并进行告警，主要包括异常登录检测、网站后门查杀（Webshell）、主机异常行为检测（进程异常行为和异常网络连接检测）、主机系统及应用的关键文件篡改检测和异常账号检测等。\n部署Web应用防火墙实现将Web流量引流到WAF上，由WAF将流量进行检测、过滤、清洗后再代理转发到应用服务器。');
INSERT INTO rule_inspection_report VALUES (50, '应采用免受恶意代码攻击的技术措施或主动免疫可信验证机制及时识别入侵和病毒行为，并将其有效阻断。', '安全计算环境', '恶意代码和垃圾邮件防范', '部署云安全中心企业版通过安全加固镜像部署代理，实现对恶意的代码实时拦截功能，在系统内核层面，识别恶意代码，并进行主动拦截。');
INSERT INTO rule_inspection_report VALUES (51, '可基于可信根对计算设备的系统引导程序、系统程序、重要配置参数和应用程序等进行可信验证，并在应用程序的所有执行环节进行动态可信验证，在检测到其可信性受到破坏后进行报警，并将验证结果形成审计记录送至安全管理中心，并进行动态关联感知。', '安全计算环境', '可信验证', '您需要在使用云产品支持常用产品开启加密链路功能。');
INSERT INTO rule_inspection_report VALUES (52, '应采用密码技术保证重要数据在传输过程中的完整性，包括但不限于鉴别数据、重要业务数据、重要审计数据、重要配置数据、重要视频数据和重要个人信息等。', '安全计算环境', '数据完整性', '您需要在使用云产品时，启用各云产品自带的完整性校验功能。');
INSERT INTO rule_inspection_report VALUES (53, '应采用密码技术保证重要数据在存储过程中的完整性，包括但不限于鉴别数据、重要业务数据、重要审计数据、重要配置数据、重要视频数据和重要个人信息等。', '安全计算环境', '数据完整性', '您需要在使用云产品时，启用各云产品自带的完整性校验功能。');
INSERT INTO rule_inspection_report VALUES (54, '应采用密码技术保证重要数据在传输过程中的保密性，包括但不限于鉴别数据、重要业务数据和重要个人信息等。', '安全计算环境', '数据保密性', '您需要在使用云产品时，如SLB、CDN、OSS、RDS等常用产品时开启加密链路功能。\n部署证书服务支持云上签发第三方CA证书颁发机构的SSL证书，实现Https。');
INSERT INTO rule_inspection_report VALUES (55, '应采用密码技术保证重要数据在存储过程中的保密性，包括但不限于鉴别数据、重要业务数据和重要个人信息等。', '安全计算环境', '数据保密性', '您需选择、配置恰当的存储加密方式。');
INSERT INTO rule_inspection_report VALUES (56, '应提供重要数据的本地数据备份与恢复功能。', '安全计算环境', '数据备份恢复', '您需对重要的数据进行本地备份。');
INSERT INTO rule_inspection_report VALUES (57, '应提供异地实时备份功能，利用通信网络将重要数据实时备份至备份场地。', '安全计算环境', '数据备份恢复', '您需根据自身重要数据和业务数据配置恰当备份策略，实现实时备份。');
INSERT INTO rule_inspection_report VALUES (58, '应提供重要数据处理系统的热冗余，保证系统的高可用性。', '安全计算环境', '数据备份恢复', '云产品基于飞天分布式操作系统高可用架构，存储产品支持高可用性，支持用于基于业务处理能力，按照需求动态调整资源，保证系统高可用。');
INSERT INTO rule_inspection_report VALUES (59, '应保证鉴别信息所在的存储空间被释放或重新分配前得到完全清除。', '安全计算环境', '剩余信息保护', '云平台对存储过云服务客户数据的内存和磁盘，一旦释放和回收，其上的残留信息将被自动进行零值覆盖，对于重用或报废的物理设备，对存储介质进行覆写、消磁或折弯等数据清除处理。');
INSERT INTO rule_inspection_report VALUES (60, '应保证存有敏感数据的存储空间被释放或重新分配前得到完全清除。', '安全计算环境', '剩余信息保护', '云平台支持不同云服务客户内存和持久化存储空间相对独立，当资源释放时，云服务客户空间会被释放和清除。');
INSERT INTO rule_inspection_report VALUES (61, '应仅采集和保存业务必需的用户个人信息。', '安全计算环境', '个人信息保护', '您需根据部署的应用系统功能建设相应的个人信息清除机制。\n部署敏感数据保护实现对个人信息进行发现、分类和保护。');
INSERT INTO rule_inspection_report VALUES (62, '应禁止未授权访问和非法使用用户个人信息。', '安全计算环境', '个人信息保护', '由您根据部署的应用系统功能建设相应的个人信息保护机制。');
INSERT INTO rule_inspection_report VALUES (63, '应对系统管理员进行身份鉴别，只允许其通过特定的命令或操作界面进行系统管理操作，并对这些操作进行审计。', '安全管理中心', '系统管理', '您需基于用户角色进行配置，实现用户三权分立。');
INSERT INTO rule_inspection_report VALUES (64, '应通过系统管理员对系统的资源和运行进行配置、控制和管理，包括用户身份、系统资源配置、系统加载和启动、系统运行的异常处理、数据和设备的备份与恢复等。', '安全管理中心', '系统管理', '您需基于云产品配置指南根据业务需求合理配置系统资源。\n部署云安全中心 实现对系统异常进行处理。');
INSERT INTO rule_inspection_report VALUES (65, '应对审计管理员进行身份鉴别，只允许其通过特定的命令或操作界面进行安全审计操作，并对这些操作进行审计。', '安全管理中心', '审计管理', '您需基于用户角色进行配置，实现用户三权分立。\n部署堡垒机 实现对审计管理操作进行审计。\n部署数据库审计产品实现对数据库操作进行审计。');
INSERT INTO rule_inspection_report VALUES (66, '应通过审计管理员对审计记录应进行分析，并根据分析结果进行处理，包括根据安全审计策略对审计记录进行存储、管理和查询等。', '安全管理中心', '审计管理', '您需基于云产品配置指南根据业务需求合理配置。\n部署堡垒机 实现对审计记录进行查询、分析和管理，审计记录支持转存到日志服务中。\n部署数据库审计产品 实现对审计记录进行查询、分析和管理，审计记录存储在日志服务中。');
INSERT INTO rule_inspection_report VALUES (67, '应对安全管理员进行身份鉴别，只允许其通过特定的命令或操作界面进行安全管理操作，并对这些操作进行审计。', '安全管理中心', '安全管理', '您需基于用户角色，实现用户三权分立。安全管理员基于安全控制台通过安全产品对云资源进行安全管理操作。');
INSERT INTO rule_inspection_report VALUES (68, '应通过安全管理员对系统中的安全策略进行配置，包括安全参数的设置，主体、客体进行统一安全标记，对主体进行授权，配置可信验证策略等。', '安全管理中心', '安全管理', '您需基于用户角色，实现用户三权分立。\n部署云安全中心实现基线核查、安全策略、访问控制策略统一配置。');
INSERT INTO rule_inspection_report VALUES (69, '应划分出特定的管理区域，对分布在网络中的安全设备或安全组件进行管控。', '安全管理中心', '集中管控', '您需制定安全策略，划分特定的管理区域。');
INSERT INTO rule_inspection_report VALUES (70, '应能够建立一条安全的信息传输路径，对网络中的安全设备或安全组件进行管理。', '安全管理中心', '集中管控', '您需基于云产品配置指南根据业务需求合理配置。云平台支持全链路通信进行SSL/TLS安全加密处理，通过Https进行管理。');
INSERT INTO rule_inspection_report VALUES (71, '应对网络链路、安全设备、网络设备和服务器等的运行状况进行集中监测。', '安全管理中心', '集中管控', '您需基于云产品配置指南根据业务需求合理配置。云监控支持针对负载均衡、弹性IP地址、DDoS高防、云服务器等运行状态创建监测规则，并进行集中监测和报警。');
INSERT INTO rule_inspection_report VALUES (72, '应对分散在各个设备上的审计数据进行收集汇总和集中分析，并保证审计记录的留存时间符合法律法规要求。', '安全管理中心', '集中管控', '您需基于云产品配置指南根据业务需求合理配置。云安全产品支持将自身采集安全审计记录在安全控制台上展示，并支持将审计记录统一保存到云服务客户指定的日志服务或存储空间，日志留存时间满足6个月。');
INSERT INTO rule_inspection_report VALUES (73, '应对安全策略、恶意代码、补丁升级等安全相关事项进行集中管理。', '安全管理中心', '集中管控', '您需基于云产品配置指南根据业务需求合理配置。\n部署云安全中心实现云平台配置核查、漏洞检测和修复、基线核查、云安全补丁修复，并对安全相关事件进行集中管理。');
INSERT INTO rule_inspection_report VALUES (74, '应能对网络中发生的各类安全事件进行识别、报警和分析。', '安全管理中心', '集中管控', '您需基于云产品配置指南根据业务需求合理配置。\n部署云安全中心企业版实现自动采集计算、数据库、负载均衡等等多种资产，收集多种日志数据，对重点安全威胁时管控，对各类安全事件进行识别、分析和告警，告警方式包括短信、邮件、钉钉等。\n部署云防火墙实现对互联网上的恶意流量入侵活动和常规攻击行为进行实时阻断和拦截。\n部署Web应用防火墙实现将Web流量引流到WAF上，由WAF将流量进行检测、过滤、清洗后再代理转发到应用服务器。\n部署DDoS高防实现所有业务流量进行清洗，支持网络四层和七层防护。');
INSERT INTO rule_inspection_report VALUES (75, '应在虚拟化网络边界部署访问控制机制，并设置访问控制规则。', '安全区域边界', '访问控制', '您需配置恰当访问控制策略。\n部署云防火墙实现统一管理互联网到业务的南北向访问策略和业务与业务之间的东西向微隔离策略，访问控制粒度可达端口级。');
INSERT INTO rule_inspection_report VALUES (76, '应在不同等级的网络区域边界部署访问控制机制，设置访问控制规则。', '安全区域边界', '访问控制', '您需配置恰当访问控制策略。\n部署云防火墙实现对VPC边界防火墙、互联网边界防火墙以及主机边界防火墙的访问控制，用于检测和控制两个VPC间的通信流量、限制主机对内、外双向的未授权访问和ECS实例间的未授权访问。');
INSERT INTO rule_inspection_report VALUES (77, '应对云服务商和云服务客户在远程管理时执行的特权命令进行审计，至少包括虚拟机删除、虚拟机重启。', '安全区域边界', '安全审计', '您需基于云产品配置指南根据业务需求合理配置。\n部署堡垒机实现操作审计、职权管控、安全认证功能，记录所有运维操作记录、Linux命令审计、Windows操作录像。\n部署云安全中心实现云服务客户所有资产安全事件的综合分析。');
INSERT INTO rule_inspection_report VALUES (78, '应保证云服务商对云服务客户系统和数据的操作可被云服务客户审计。', '安全区域边界', '安全审计', '您需基于云产品配置指南根据业务需求合理配置。云服务商对云服务客户系统的操作需提交工单，通过云服务客户授权后进行操作，相关操作行为通过云服务客户的管理平台进行审计。');
INSERT INTO rule_inspection_report VALUES (79, '当远程管理云计算平台中设备时，管理终端和云计算平台之间应建立双向身份验证机制。', '安全计算环境', '身份鉴别', '您需基于云产品配置指南根据业务需求合理配置。可通过云平台RAM授权和AccessKey，实现密钥访问云平台API，如果双方均为合法证书则建立双向加密通道。');
INSERT INTO rule_inspection_report VALUES (80, '应确保云服务客户数据、用户个人信息等存储于中国境内，如需出境应遵循国家相关规定。', '安全计算环境', '数据完整性', '您需遵守业务数据不出境的规定，若出境遵循国家相关规定。');
INSERT INTO rule_inspection_report VALUES (81, '云服务客户应在本地保存其业务数据的备份。', '安全计算环境', '数据备份恢复', '您需进行本地备份业务数据。');
INSERT INTO rule_inspection_report VALUES (82, '应根据云服务商和云服务客户的职责划分，收集各自控制部分的审计数据并实现各自的集中审计。', '安全建设管理', '集中管控', '您需基于云产品配置指南根据业务需求合理配置。\n部署堡垒机实现对所有云服务客户的操作进行审计，操作系统自身日志本地保存。\n部署数据库审计产品实现对数据库风险操作行为进行记录，提供细粒度审计数据库访问行为。云客户安全能力。');
INSERT INTO rule_inspection_report VALUES (83, '应根据云服务商和云服务客户的职责划分，实现各自控制部分，包括虚拟化网络、虚拟机、虚拟化安全设备等的运行状况的集中监测。', '安全建设管理', '集中管控', '您需基于云产品配置指南根据业务需求合理配置。云监控支持针对负载均衡、弹性IP地址、DDoS高防、云服务器等运行状态创建监测规则，并进行集中监测和报警。');
INSERT INTO rule_inspection_report VALUES (84, '应选择安全合规的云服务商，其所提供的云计算平台应为其所承载的业务应用系统提供相应等级的安全保护能力。', '安全建设管理', '云服务商选择', '您可以根据业务需求选择合规的云服务商。云平台提供的公共云平台安全保护等级为第三级，并通过公安部指定测评机构等保测评。');
INSERT INTO rule_inspection_report VALUES (85, '应在服务水平协议中规定云服务的各项服务内容和具体技术指标。', '安全建设管理', '云服务商选择', '您在选定云服务商后，需签订相关服务等级协议。云平台各安全产品均提供服务等级协议。');
INSERT INTO rule_inspection_report VALUES (86, '应在服务水平协议中规定云服务商的权限与责任，包括管理范围、职责划分、访问授权、隐私保护、行为准则、违约责任等。', '安全建设管理', '云服务商选择', '您在选定云服务商后，需签订相关服务等级协议。云平台各安全产品均提供服务等级协议。');
INSERT INTO rule_inspection_report VALUES (87, '应在服务水平协议中规定服务合约到期时，完整提供云服务客户数据，并承诺相关数据在云计算平台上清除。', '安全建设管理', '云服务商选择', '您在选定云服务商后，需签订相关服务等级协议。云平台各安全产品均提供服务等级协议。');
INSERT INTO rule_inspection_report VALUES (88, '应与选定的云服务商签署保密协议，要求其不得泄露云服务客户数据。', '安全建设管理', '云服务商选择', '您在选定云服务商后，需签订相关服务等级协议。云平台各安全产品均提供服务等级协议。');
INSERT INTO rule_inspection_report VALUES (89, '应确保供应商的选择符合国家有关规定。', '安全建设管理', '供应链管理', '您在选择第三方安全产品接入时，应明确供应商是否满足国家相关规定。公共云平台基础设施供应商选择均按照国家相关规定，对供应商资质、诚信以及产品情况进行审核筛选，云平台提供云服务均按照国家相关规定对外售卖。');
INSERT INTO rule_inspection_report VALUES (90, '需要多因素身份验证。无论是现场管理还是由第三方提供商管理，都需要对所有系统上的所有用户账号进行多因素身份验证。', 'IAM', '访问控制', '检测RAM用户是否开通MFA二次验证登录。若未开通，会导致该规则不合规。开启多因素认证后，配置审计在10分钟内感知到您的修改并自动启动审计。');
INSERT INTO rule_inspection_report VALUES (91, '维护网络设备的标准安全配置。维护所有被授权网络设备的安全配置。该安全配置需符合标准且记录在案。', '安全通信网络', '网络架构', 'ECS不能为经典网络，必须挂载到VPC。');
INSERT INTO rule_inspection_report VALUES (92, '确保仅审核通过的端口、协议和服务正在运行。确保只有符合条件的网络端口、协议和服务在系统上运行。该端口、协议和服务经过业务需求验证，对系统进行监听。拒绝通过未经授权的端口进行通信。拒绝通过未经授权的TCP、UDP端口或应用程序通信进行通信，以确保只有经过授权的协议才能跨越组织每个网络边界进行通信。', '网络', '网络架构', '将授权对象为0.0.0.0/0的安全组入方向规则的授权策略调整为拒绝或者修改授权对象。');
INSERT INTO rule_inspection_report VALUES (93, '确保安全组配置了最小粒度的规则。', '安全通信网络', '网络架构', '删除授权策略为允许，授权对象为0.0.0.0/0安全组入方向规则。');
INSERT INTO rule_inspection_report VALUES (94, '加密静态敏感信息。使用工具加密所有静态敏感信息。该工具采用未集成到操作系统中的辅助身份验证机制才能访问信息。', '安全计算环境', '安全审计', '如果您账号下所有处于关联状态的云盘若未加密，则会导致该规则不合规。');
INSERT INTO rule_inspection_report VALUES (95, '确保仅审核通过的端口、协议和服务正在运行。确保只有符合条件的网络端口、协议和服务在系统上运行。该端口、协议和服务经过业务需求验证，对系统进行监听。', '安全计算环境', '安全审计', '将授权对象为0.0.0.0/0的安全组入方向规则的授权策略调整为拒绝或者修改授权对象。');
INSERT INTO rule_inspection_report VALUES (96, '确保服务器端加密设置为“用服务密钥加密”。', '安全计算环境', '安全数据保护', '查看您账号下的资源是否启用了加密，若未加密，会导致该规则不合规。');
INSERT INTO rule_inspection_report VALUES (97, '确保RDS实例不对外开放。', '安全计算环境', '安全数据保护', '查看您账号下的RDS实例是否对外开放，若已开放，会导致该规则不合规。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜识别与信息和信息处理设施的资产，编制并维护这些资产的清单。', '资产清单', '识别组织资产，并定义适当的保护职责。', '1）识别相关的信息处理设施的资产，并进行分类，分类可包括：硬件资产、软件资产和数据资产等；（购买实例）2）建立信息资产清单，可以形成文件化记录或以配置库形式管理，并实时保持更新。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('清单中所维护的资产宜分配所有权。', '资产所有权', '识别组织资产，并定义适当的保护职责。', '1）识别相关的信息处理设施的资产，并进行分类，分类可包括：硬件资产、软件资产和数据资产等；（购买实例）2）建立信息资产清单，可以形成文件化记录或以配置库形式管理，并实时保持更新。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('信息宜按照法律要求、价值、关键性以及它对未授权泄露或修改的敏感性予以分级。', '信息的分级', '确保信息按照其对组织的重要性受到适当级别的保护。', '1）建立信息分级的管理要求，分级方案应包含分级规则和分级评审的准则，宜命名每个不同的级别以便于分级方案的使用；2）信息资产的责任主体宜对其分级负责。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜按照组织所采纳的信息分类机制建立和实施一组合适的信息标记规程。', '信息的标记', '确保信息按照其对组织的重要性受到适当级别的保护。', '按照信息分级的管理要求，对公司的信息进行了分级标记，分级的结果宜体现资产的价值，该价值取决于资产对组织的敏感性和重要性，分级结果应根据资产在其生命周期中的价值、敏感性和重要性的变化进行更新。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('用户宜仅能访问已获专门授权使用的网络和网络服务。', '网络和网络服务的访问', '限制对信息和信息处理设施的访问。', '按网络和网络服务的要求配置公司的网络安全策略。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜实施正式的用户注册及注销规程，使访问权限得以分配。', '用户注册及注销', '确保授权用户访问系统和服务，并防止未授权的访问。', '信息系统提供注册、注销、冻结用户账号的功能；系统可保证用户ID唯一性，使得用户与其行为链接起来。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜实施正式的用户访问开通过程，以分配或撤销所有系统和服务所有用户类型的访问权限。', '用户访问开通', '确保授权用户访问系统和服务，并防止未授权的访问。', '信息系统被授权用户的访问级别与访问策略匹配；授权规程完成之后，访问权限才被激活。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜限制和控制特殊访问权限的分配及使用。', '特殊访问权限管理', '确保授权用户访问系统和服务，并防止未授权的访问。', '管理者进行了特权用户授权，并记录特殊访问权限用户名单；定期评审特殊授权用户与其工作职责的匹配性。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜通过正式的管理过程控制秘密鉴别信息的分配。', '用户秘密鉴别信息管理', '确保授权用户访问系统和服务，并防止未授权的访问。', '秘密鉴别信息（如：密码、动态口令、云计算AK等）分配时应考虑其安全性，包括：验证用户身份；系统支持用户初始密码强制修改功能；系统支持以安全的方式将临时秘密鉴别信息提供给用户，避免通过外部方或未受保护的（明文）电子邮件提供。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('资产所有者宜定期复查用户的访问权限。', '用户访问权限的复查', '确保授权用户访问系统和服务，并防止未授权的访问。', '定期进行各信息系统的访问权复查，权限分配应适宜；定期（加严）核查特殊权限的分配。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('所有雇员、外部方人员对信息和信息处理设施的访问权限宜在任用、合同或协议终止时撤销，或在变化时调整。', '撤销或调整访问权限', '确保授权用户访问系统和服务，并防止未授权的访问。', '调整已变更岗位用户的访问权限，并立即删除或禁用已离开组织的用户的访问权限。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜依照访问控制策略限制对信息和应用系统功能的访问。', '信息访问限制', '防止对系统和应用的未授权访问。', '各信息和信息系统的管理员对用户访问特定信息的授权过程。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('在访问控制策略要求下，访问操作系统和应用宜通过安全登录规程加以控制。', '安全登录规程', '防止对系统和应用的未授权访问。', '用户鉴别的强度应和所访问信息的级别相适应，登录信息系统的应选择适当的身份鉴别技术（口令/密码、双因素认证、动态口令）以证实用户身份。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('口令管理系统宜是交互式的，并宜确保优质的口令。', '口令管理系统', '防止对系统和应用的未授权访问。', '设置的访问密码强度，应满足访问控制策略中对密码管理的要求。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('对于可能超越系统和应用程序控制措施的适用工具软件的使用宜加以限制并严格控制。', '特殊权限实用工具软件的使用', '防止对系统和应用的未授权访问。', '按照访问控制策略的要求对特殊权限实用工具软件的安装、使用进行管控。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜开发和实施使用密码控制措施来保护信息的策略。', '使用密码控制的策略', '恰当和有效的利用密码学保护信息的保密性、真实性或完整性。', '建立加密管理要求，在软件开发和日常管理过程中，使用了基本的加密策略，如数据传输加密、敏感信息脱敏、匿名化等。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜开发和实施贯穿整个密钥生命周期的关于密钥使用、保护和生存期的策略。', '密钥管理', '恰当和有效的利用密码学保护信息的保密性、真实性或完整性。', '建立加密管理要求，具有密钥生成、存储、归档、恢复、分发、卸任和损坏的安全过程；用来生成、存储和归档密钥的设备应进行物理保护。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('资源的使用宜加以监视、调整，并作出对于未来容量要求的预测，以确保拥有所需的系统性能。', '容量管理', '确保正确、安全的操作信息处理设施。', '根据相关业务系统关键性，来识别容量需求，使用监控系统来监视系统资源的使用情况，并对未来容量需求进行规划和趋势分析。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜实施恶意软件的检测、预防和恢复的控制措施，以及适当的提高用户安全意识。', '控制恶意软件', '确保对信息和信息处理设施进行恶意软件防护。', '服务器、终端电脑应安装、使用杀毒软件，并设置查杀策略，病毒库应定期更新。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜按照已设的备份策略，定期备份和测试信息、软件及系统镜像。', '信息备份', '为了防止数据丢失。', '制定重要数据的备份策略，数据备份执行情况应与备份策略一直；应定期进行备份恢复测试。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜产生记录用户活动、异常情况、故障和信息安全事态的事态日志，并保持定期评审。', '事态记录', '记录事态和生成证据。', '应记录认证范围涉及的关键信息系统的日志以及网络设备的日志，并定期评审。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('记录日志的设施和日志信息宜加以保护，以防止篡改和未授权的访问。', '日志信息的保护', '记录事态和生成证据。', '信息系统日志用户自定义保存（依据行业监管要求保存）网络安全日志信息应至少保存6个月；应实施控制措施以防止日志信息的未授权更改和日志设施的运行问题，包括：a) 已记录的消息类型的更改；b) 日志文件被编辑或被删除；c) 超过日志文件存储介质的容量，导致不能记录事态或过去记录事态被写覆盖。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('系统管理员和系统操作员的活动宜记入日志，保护日志并定期评审。', '管理员和操作员日志', '记录事态和生成证据。', '应记录、保护和评审系统管理员和系统操作员的操作日志，以保持特权用户的可核查性。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜及时得到现用信息系统技术脆弱性的信息，评价组织对这些脆弱性的暴露程度，并采取适当的措施来处理相关的风险。', '技术脆弱性的控制', '防止技术脆弱性被利用。', '应定义和建立与技术脆弱性管理相关的角色和职责；定期对信息系统实施漏洞检测，并对检测结果进行跟踪处置对操作系统和网络设备更新并安装补丁，应评估与安装该补丁相关的风险。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('涉及对运行系统验证的审计要求和活动，宜谨慎地加以规划并取得批准，以便使造成业务过程中断最小化。', '信息系统审计控制措施', '将运行系统审计活动的影响最小化。', '策划和实施信息系统审计时，信息系统审计过程和使用工具应是安全可靠的，并对审计活动和审计使用工具进行评审和批准。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜管理和控制网络，以保护系统中信息和应用程序的安全。', '网络控制', '确保网络中信息的安全性并保护支持性信息处理设施。', '实施控制措施以确保网络上信息的安全、保护相互连接的服务免遭未授权访问。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('安全机制、服务级别以及所有网络服务的管理要求宜予以确定并包括在所有网络服务协议中，无论这些服务是由内部提供的还是外包的。', '网络服务安全', '确保网络中信息的安全性并保护支持性信息处理设施。', '网络服务提供商（如：网络运营商、网络设备提供商）应在其服务协议中服务级别要求以及信息安全要求。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('宜在网络中隔离信息服务、用户及信息系统。', '网络隔离', '确保网络中信息的安全性并保护支持性信息处理设施。', '网络分成独立的网络域。域的选择可以基于信任级别（如公共访问域、桌面域、服务器域）、组织单元（如人力资源、财务、市场）或组合（如连接到多个组织单元的服务器域）。域之间的隔离可以使用不同的物理网络或者使用不同的逻辑网络（如虚拟专用网络）。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('信息安全事态宜被评估，并且确定是否划分成信息安全事件。', '评估和确定信息安全事态', '确保采用一致和有效的方法对信息安全事件进行管理，包括安全事件和弱点的传达。', '根据信息安全事件管理规范对信息安全事态评估和确认的记录。');
INSERT INTO `rule_inspection_report` (`project`, `item_sort_first_level`, `item_sort_second_level`, `improvement`) VALUES ('信息处理设备宜冗余部署，以满足高可用性需求。', '信息处理设施的可用性', '确保信息处理设施的有效性。', '组织应识别信息系统可用性的业务要求。当使用现有系统架构不能保证可用性时，应考虑冗余组件或架构。如可能，应测试冗余信息系统以确保从一个组件到另一个组件的故障切换按预期执行。');


INSERT INTO rule VALUES ('028b8362-08f2-404c-8e15-935426bb8545', 'Aliyun RDS 实例公网访问检测', 1, 'HighRisk', 'Aliyun 检测您账号下 RDS 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 检测您账号下 RDS 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-rds-internet-access\n      resource: aliyun.rds\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"启用公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('083d24e2-881f-488b-b120-8f2cd961707f', 'Aliyun SecurityGroup 安全组配置检测', 1, 'HighRisk', 'Aliyun 账号下 ECS 安全组配置不为“0.0.0.0/0”，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下 ECS 安全组配置不为“0.0.0.0/0”，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-sg-source-cidr-ip\n      resource: aliyun.security-group\n      filters:\n        - type: source-cidr-ip\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"目标IP地址段\",\"defaultValue\":\"\\\"0.0.0.0/0\\\"\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('0b2ece35-a17e-4584-ac2d-0b11483d04fb', 'Aliyun EIP 带宽峰值检测', 1, 'HighRisk', 'Aliyun 检测您账号下的弹性 IP 实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 检测您账号下的弹性 IP 实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-eip-bandwidth\n      resource: aliyun.eip\n      filters:\n        - type: bandwidth\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"按带宽计费的公网型实例的带宽峰值\",\"defaultValue\":\"10\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('1299a29b-e19d-4186-93fd-a18ed1b2584a', 'Aliyun SLB 负载均衡 HTTPS 监听检测', 1, 'HighRisk', 'Aliyun SLB 负载均衡开启 HTTPS 监听，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun SLB 负载均衡开启 HTTPS 监听，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-slb-listener\n      resource: aliyun.slb\n      filters:\n        - type: listener\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"负载均衡实例前端使用的协议\",\"defaultValue\":\"https\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('2533542d-5422-4bd5-8849-6a69ec05a874', 'Aliyun Disk 磁盘加密状态检测', 1, 'HighRisk', 'Aliyun 账号下所有的磁盘均已加密；若您配置阈值，则磁盘加密的Id需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下所有的磁盘均已加密；若您配置阈值，则磁盘加密的Id需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-encrypted-disk\n      resource: aliyun.disk\n      filters:\n        - type: encrypted\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"磁盘是否加密( true/false )\",\"defaultValue\":\"false\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('29763f5e-ef4c-431d-b44f-39cd1b5b5363', 'Aliyun Redis 实例网络类型检测', 1, 'HighRisk', 'Aliyun 检测您账号下的 Redis 实例是否运行在VPC网络环境下，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 检测您账号下的 Redis 实例是否运行在VPC网络环境下，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-rds-network-type\n      resource: aliyun.redis\n      filters:\n        - type: network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型:CLASSIC经典网络/VPC网络\",\"defaultValue\":\"VPC\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('2adbae64-6403-4dfb-92ab-637354da49f8', 'Aliyun PolarDB 实例公网访问检测', 1, 'HighRisk', 'Aliyun 账号下 PolarDB 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下 PolarDB 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-polardb-internet-access\n      resource: aliyun.polardb\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('339cf3fc-f9d9-457e-ac72-40d37c402bdf', 'Aliyun SLB 负载均衡实例公网IP检测', 1, 'HighRisk', 'Aliyun SLB 负载均衡实例未直接绑定公网 IP，符合视为“合规”，否则视为“不合规”。(该规则仅适用于 IPv4 协议)', 'policies:\n    # Aliyun SLB 负载均衡实例未直接绑定公网IP，符合视为“合规”，否则视为“不合规”。(该规则仅适用于 IPv4 协议)。\n    - name: aliyun-slb-address-type\n      resource: aliyun.slb\n      filters:\n        - type: address-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公网IP/内网IP( internet/intranet )\",\"defaultValue\":\"internet\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('3e5d47ac-86b6-40d1-a191-1b2ff2496118', 'Aliyun ECS 实例网络类型检测', 1, 'HighRisk', 'Aliyun 账号下所有 ECS 实例已关联到 VPC；若您配置阈值，则关联的 VpcId 需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下所有 ECS 实例已关联到 VPC；若您配置阈值，则关联的VpcId需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-ecs-instance-network-type\n      resource: aliyun.ecs\n      filters:\n        - type: instance-network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型:classic经典网络/vpc网络\",\"defaultValue\":\"vpc\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('429f8396-e04b-49d9-8b38-80647ac87e66', 'Aliyun OSS 公开读取访问权限检测', 1, 'HighRisk', 'Aliyun 查看您的 OSS 存储桶是否不允许公开读取访问权限。如果某个 OSS 存储桶策略或存储桶 ACL 允许公开读取访问权限，则该存储桶“不合规“', 'policies:\n    # Aliyun 查看您的 OSS 存储桶是否不允许公开读取访问权限。如果某个 OSS 存储桶策略或存储桶 ACL 允许公开读取访问权限，则该存储桶“不合规“。\n    - name: aliyun-oss-public-read\n      resource: aliyun.oss\n      filters:\n        - type: global-grants\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公开读取访问权限\",\"defaultValue\":\"public-read\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('44343a84-39e2-4fbc-b8c5-d3ac06186501', 'Aliyun MongoDB 实例网络类型检测', 1, 'HighRisk', 'Aliyun 检测您账号下的 MongoDB 实例是否运行在 VPC 网络环境下，符合为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 检测您账号下的 MongoDB 实例是否运行在 VPC 网络环境下，符合为“合规”，否则视为“不合规”。\n    - name: aliyun-mongodb-network-type\n      resource: aliyun.mongodb\n      filters:\n        - type: network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型:Classic经典网络/VPC网络\",\"defaultValue\":\"VPC\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('594e7673-c0db-40a4-9a0c-f70f0e58cc62', 'Aliyun SLB 带宽峰值检测', 1, 'HighRisk', 'Aliyun 检测您账号下的负载均衡实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 检测您账号下的负载均衡实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-slb-bandwidth\n      resource: aliyun.slb\n      filters:\n        - type: bandwidth\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"按带宽计费的公网型实例的带宽峰值\",\"defaultValue\":\"10\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('6fd132c0-b4df-4685-b132-5441d1aef2f8', 'Aliyun ECS 实例公网IP检测', 1, 'HighRisk', 'Aliyun ECS 实例未直接绑定公网 IP，符合视为“合规”，否则视为“不合规”。该规则仅适用于 IPv4 协议', 'policies:\n    # Aliyun ECS 实例未直接绑定公网 IP，符合视为“合规”，否则视为“不合规”。该规则仅适用于 IPv4 协议。\n    - name: aliyun-ecs-public-ipaddress\n      resource: aliyun.ecs\n      filters:\n        - type: public-ip-address', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('70c1e701-b87a-4e4d-8648-3db7ecc2c066', 'Aliyun RAM 用户 MFA 检测', 1, 'HighRisk', 'Aliyun 检测 RAM 用户是否开通 MFA 二次验证登录，开通视为“合规”，否则属于“不合规”', 'policies:\n    # Aliyun 检测 RAM 用户是否开通 MFA 二次验证登录，开通视为“合规”，否则属于“不合规”。\n    - name: aliyun-ram-mfa\n      resource: aliyun.ram\n      filters:\n        - type: mfa\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"RAM用户是否开通MFA二次验证登录(true/false)\",\"defaultValue\":\"false\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('7d323895-f07b-4845-8b3d-01c78180f270', 'Aliyun MongoDB 实例公网访问检测', 1, 'HighRisk', 'Aliyun 账号下 MongoDB 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下 MongoDB 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-mongodb-internet-access\n      resource: aliyun.mongodb\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('88a77028-0e2a-4201-a713-ded3a94864f9', 'Aliyun SLB 公网访问检测', 1, 'HighRisk', 'Aliyun 账号下 SLB 不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下 SLB 不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-slb-acls\n      resource: aliyun.slb\n      filters:\n        - type: acls\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('8c635fda-7f89-4d5c-b0f4-2116f1b65554', 'Aliyun OSS 防盗链检测', 1, 'HighRisk', 'Aliyun 检测 OSS Bucket 是否开启防盗链开关，已开通视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 检测 OSS Bucket 是否开启防盗链开关，已开通视为“合规”，否则视为“不合规”。\n    - name: aliyun-oss-bucket-referer\n      resource: aliyun.oss\n      filters:\n        - type: bucket-referer\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否开启防盗链开关\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('9d94781e-922d-48c3-90a1-393dc79f2442', 'Aliyun OSS 存储桶加密检测', 1, 'HighRisk', 'Aliyun 查看并确认您的 OSS 存储桶启用了默认加密，开启视为“合规”，未开启则该存储桶“不合规“', 'policies:\n    # Aliyun 查看并确认您的 OSS 存储桶启用了默认加密，开启视为“合规”，未开启则该存储桶“不合规“。\n    - name: aliyun-oss-encryption\n      resource: aliyun.oss\n      filters:\n        - type: encryption', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('ae65e90c-124c-4a81-8081-746d47f44e8f', 'Aliyun RDS 实例高可用状态检测', 1, 'HighRisk', 'Aliyun 账号下 RDS 实例具备高可用能力，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下 RDS 实例具备高可用能力，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-rds-high-availability\n      resource: aliyun.rds\n      filters:\n        - type: high-availability', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('ba1edc8f-0944-4ebb-a953-f655aa710e84', 'Aliyun CDN 域名 HTTPS 监听检测', 1, 'HighRisk', 'Aliyun 检测 CDN 域名是否开启 HTTPS 监听，若开启视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 检测 CDN 域名是否开启 HTTPS 监听，若开启视为“合规”，否则视为“不合规”。\n    - name: aliyun-cdn-ssl-protocol\n      resource: aliyun.cdn\n      filters:\n        - type: ssl-protocol\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"https开关。 \\\"on\\\"：已开启。\\\"off\\\"：未开启\",\"defaultValue\":\"\\\"off\\\"\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('beda16d0-93fd-4366-9ebf-f5ce1360cd60', 'Aliyun RDS 实例多可用区检测', 1, 'HighRisk', 'Aliyun 账号下 RDS 实例支持多可用区，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下 RDS 实例支持多可用区，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-rds-available-zones\n      resource: aliyun.rds\n      filters:\n        - type: available-zones\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否支持多可用区\",\"defaultValue\":\"false\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('c57f055e-fd84-4af3-ba97-892a8fdc1fed', 'Aliyun PolarDB 实例网络类型检测', 1, 'HighRisk', 'Aliyun 检测您账号下的 PolarDB 实例是否运行在VPC网络环境下，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 检测您账号下的 PolarDB 实例是否运行在VPC网络环境下，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-polardb-dbcluster-network-type\n      resource: aliyun.polardb\n      filters:\n        - type: dbcluster-network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型:Classic经典网络/VPC网络\",\"defaultValue\":\"VPC\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('c95fde94-53a5-4658-98a4-56a0c6d951d4', 'Aliyun RDS 实例的访问模式检测', 1, 'HighRisk', 'Aliyun 检测您账号下的 RDS 实例是否启用数据库代理状态链接形式，Safe 视为“合规”，Standard 属于“不合规”', 'policies:\n    # Aliyun 检测您账号下的 RDS 实例是否启用数据库代理状态链接形式，Safe 视为“合规”，Standard 属于“不合规”。\n    - name: aliyun-rds-connection-mode\n      resource: aliyun.rds\n      filters:\n       - type: connection-mode\n         value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的访问模式:Standard/Safe\",\"defaultValue\":\"Safe\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('d690be79-2e8c-4054-bbe6-496bd29e91fe', 'Aliyun RDS 实例白名单检测', 1, 'HighRisk', 'Aliyun 测您账号下 RDS 数据库实例是否启用安全白名单功能，已开通视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 测您账号下 RDS 数据库实例是否启用安全白名单功能，已开通视为“合规”，否则视为“不合规”。\n    - name: aliyun-rds-security-ip-mode\n      resource: aliyun.rds\n      filters:\n        - type: security-ip-mode\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"白名单模式:normal通用模式/safety高安全模式\",\"defaultValue\":\"safety\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('d826c85d-cb42-4824-ab13-6d7a8026d9ae', 'Aliyun OSS 公开写入访问权限检测', 1, 'HighRisk', 'Aliyun 查看 OSS 存储桶是否不允许公开写入访问权限。如果某个 OSS 存储桶策略或存储桶 ACL 允许公开写入访问权限，则该存储桶”不合规”', 'policies:\n    # Aliyun 查看 OSS 存储桶是否不允许公开写入访问权限。如果某个 OSS 存储桶策略或存储桶 ACL 允许公开写入访问权限，则该存储桶”不合规”。\n    - name: aliyun-oss-public-read-write\n      resource: aliyun.oss\n      filters:\n        - type: global-grants\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公开写入访问权限\",\"defaultValue\":\"public-read-write\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('df4fb45c-f9bc-4c8e-996d-036c9d2f1800', 'Aliyun SecurityGroup 高危安全组检测', 1, 'HighRisk', 'Aliyun 检测安全组是否开启风险端口，未开启视为“合规”，否则属于“不合规”', 'policies:\n  #Aliyun 检测安全组是否开启风险端口，未开启视为“合规”，否则属于“不合规”。\n  #(20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500)\n  - name: aliyun-security-group\n    resource: aliyun.security-group\n    description: |\n      Add Filter all security groups, filter ports\n      [20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500]\n      on 0.0.0.0/0 or\n      [20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\n      on ::/0 (IPv6)\n    filters:\n        - or:\n            - type: ingress\n              IpProtocol: \"-1\"\n              Ports: ${{ipv4_port}}\n              Cidr: \"0.0.0.0/0\"\n            - type: ingress\n              IpProtocol: \"-1\"\n              Ports: ${{ipv6_port}}\n              CidrV6: \"::/0\"', '[{\"key\":\"ipv4_port\",\"name\":\"ipv4端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true},{\"key\":\"ipv6_port\",\"name\":\"ipv6端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('e054787c-5826-4242-8450-b0daa926ea40', 'Aliyun RDS 实例网络类型检测', 1, 'HighRisk', 'Aliyun 账号下 RDS 实例已关联到 VPC；若您配置阈值，则关联的 VpcId 需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下 RDS 实例已关联到 VPC；若您配置阈值，则关联的 VpcId 需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-rds-instance-network-type\n      resource: aliyun.rds\n      filters:\n        - type: instance-network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型:Classic经典网络/VPC网络\",\"defaultValue\":\"VPC\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', 'Aliyun SLB 负载均衡实例关联到VPC检测', 1, 'HighRisk', 'Aliyun 账号下负载均衡实例已关联到 VPC；若您配置阈值，则关联的 VpcId 需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下负载均衡实例已关联到 VPC；若您配置阈值，则关联的 VpcId 需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-slb-network-type\n      resource: aliyun.slb\n      filters:\n        - type: network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"负载均衡实例的网络类型(不等于)\",\"defaultValue\":\"vpc\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('fdef013f-ce14-468a-9af4-1c0fabc7e6e1', 'Aliyun OSS 对象存储桶冗余存储检测', 1, 'HighRisk', 'Aliyun 检测您账号下的对象存储桶是否启用同城冗余存储（数据容灾类型），若开启视为“合规”，否则视为”不合规”', 'policies:\n    # Aliyun 检测您账号下的对象存储桶是否启用同城冗余存储（数据容灾类型），若开启视为“合规”，否则视为”不合规”。\n    - name: aliyun-oss-data-redundancy-type\n      resource: aliyun.oss\n      filters:\n        - type: data-redundancy-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"Bucket的数据容灾类型。有效值：LRS、ZRS\",\"defaultValue\":\"ZRS\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO rule VALUES ('ff153eea-2628-440b-b054-186d6f5a7708', 'Aliyun Redis 实例公网访问检测', 1, 'HighRisk', 'Aliyun 账号下 Redis 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Aliyun 账号下 Redis 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”。\n    - name: aliyun-redis-internet-access\n      resource: aliyun.redis\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');


INSERT INTO rule_tag_mapping VALUES (1, 'd690be79-2e8c-4054-bbe6-496bd29e91fe', 'safety');
INSERT INTO rule_tag_mapping VALUES (2, '6fd132c0-b4df-4685-b132-5441d1aef2f8', 'safety');
INSERT INTO rule_tag_mapping VALUES (3, 'c95fde94-53a5-4658-98a4-56a0c6d951d4', 'safety');
INSERT INTO rule_tag_mapping VALUES (4, 'fdef013f-ce14-468a-9af4-1c0fabc7e6e1', 'safety');
INSERT INTO rule_tag_mapping VALUES (5, '8c635fda-7f89-4d5c-b0f4-2116f1b65554', 'safety');
INSERT INTO rule_tag_mapping VALUES (6, '0b2ece35-a17e-4584-ac2d-0b11483d04fb', 'safety');
INSERT INTO rule_tag_mapping VALUES (7, '594e7673-c0db-40a4-9a0c-f70f0e58cc62', 'safety');
INSERT INTO rule_tag_mapping VALUES (8, '44343a84-39e2-4fbc-b8c5-d3ac06186501', 'safety');
INSERT INTO rule_tag_mapping VALUES (9, '29763f5e-ef4c-431d-b44f-39cd1b5b5363', 'safety');
INSERT INTO rule_tag_mapping VALUES (10, 'e054787c-5826-4242-8450-b0daa926ea40', 'safety');
INSERT INTO rule_tag_mapping VALUES (11, 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', 'safety');
INSERT INTO rule_tag_mapping VALUES (12, 'c57f055e-fd84-4af3-ba97-892a8fdc1fed', 'safety');
INSERT INTO rule_tag_mapping VALUES (13, 'ff153eea-2628-440b-b054-186d6f5a7708', 'safety');
INSERT INTO rule_tag_mapping VALUES (14, '88a77028-0e2a-4201-a713-ded3a94864f9', 'safety');
INSERT INTO rule_tag_mapping VALUES (15, '7d323895-f07b-4845-8b3d-01c78180f270', 'safety');
INSERT INTO rule_tag_mapping VALUES (16, '339cf3fc-f9d9-457e-ac72-40d37c402bdf', 'safety');
INSERT INTO rule_tag_mapping VALUES (17, 'd826c85d-cb42-4824-ab13-6d7a8026d9ae', 'safety');
INSERT INTO rule_tag_mapping VALUES (18, '429f8396-e04b-49d9-8b38-80647ac87e66', 'safety');
INSERT INTO rule_tag_mapping VALUES (19, 'ba1edc8f-0944-4ebb-a953-f655aa710e84', 'safety');
INSERT INTO rule_tag_mapping VALUES (20, '1299a29b-e19d-4186-93fd-a18ed1b2584a', 'safety');
INSERT INTO rule_tag_mapping VALUES (21, 'ae65e90c-124c-4a81-8081-746d47f44e8f', 'safety');
INSERT INTO rule_tag_mapping VALUES (22, '70c1e701-b87a-4e4d-8648-3db7ecc2c066', 'safety');
INSERT INTO rule_tag_mapping VALUES (23, '3e5d47ac-86b6-40d1-a191-1b2ff2496118', 'safety');
INSERT INTO rule_tag_mapping VALUES (24, '2533542d-5422-4bd5-8849-6a69ec05a874', 'safety');
INSERT INTO rule_tag_mapping VALUES (25, '083d24e2-881f-488b-b120-8f2cd961707f', 'safety');
INSERT INTO rule_tag_mapping VALUES (26, '9d94781e-922d-48c3-90a1-393dc79f2442', 'safety');
INSERT INTO rule_tag_mapping VALUES (27, '028b8362-08f2-404c-8e15-935426bb8545', 'safety');
INSERT INTO rule_tag_mapping VALUES (28, 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', 'safety');
INSERT INTO rule_tag_mapping VALUES (29, 'beda16d0-93fd-4366-9ebf-f5ce1360cd60', 'safety');
INSERT INTO rule_tag_mapping VALUES (30, '2adbae64-6403-4dfb-92ab-637354da49f8', 'safety');


INSERT INTO rule_inspection_report_mapping VALUES (1, '0b2ece35-a17e-4584-ac2d-0b11483d04fb', '2');
INSERT INTO rule_inspection_report_mapping VALUES (2, '594e7673-c0db-40a4-9a0c-f70f0e58cc62', '2');
INSERT INTO rule_inspection_report_mapping VALUES (3, '44343a84-39e2-4fbc-b8c5-d3ac06186501', '3');
INSERT INTO rule_inspection_report_mapping VALUES (4, '44343a84-39e2-4fbc-b8c5-d3ac06186501', '4');
INSERT INTO rule_inspection_report_mapping VALUES (5, '44343a84-39e2-4fbc-b8c5-d3ac06186501', '5');
INSERT INTO rule_inspection_report_mapping VALUES (6, '44343a84-39e2-4fbc-b8c5-d3ac06186501', '6');
INSERT INTO rule_inspection_report_mapping VALUES (7, '44343a84-39e2-4fbc-b8c5-d3ac06186501', '7');
INSERT INTO rule_inspection_report_mapping VALUES (8, '29763f5e-ef4c-431d-b44f-39cd1b5b5363', '3');
INSERT INTO rule_inspection_report_mapping VALUES (9, '29763f5e-ef4c-431d-b44f-39cd1b5b5363', '4');
INSERT INTO rule_inspection_report_mapping VALUES (10, '29763f5e-ef4c-431d-b44f-39cd1b5b5363', '5');
INSERT INTO rule_inspection_report_mapping VALUES (11, '29763f5e-ef4c-431d-b44f-39cd1b5b5363', '6');
INSERT INTO rule_inspection_report_mapping VALUES (12, '29763f5e-ef4c-431d-b44f-39cd1b5b5363', '7');
INSERT INTO rule_inspection_report_mapping VALUES (13, 'e054787c-5826-4242-8450-b0daa926ea40', '3');
INSERT INTO rule_inspection_report_mapping VALUES (14, 'e054787c-5826-4242-8450-b0daa926ea40', '4');
INSERT INTO rule_inspection_report_mapping VALUES (15, 'e054787c-5826-4242-8450-b0daa926ea40', '5');
INSERT INTO rule_inspection_report_mapping VALUES (16, 'e054787c-5826-4242-8450-b0daa926ea40', '6');
INSERT INTO rule_inspection_report_mapping VALUES (17, 'e054787c-5826-4242-8450-b0daa926ea40', '7');
INSERT INTO rule_inspection_report_mapping VALUES (18, 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', '3');
INSERT INTO rule_inspection_report_mapping VALUES (19, 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', '4');
INSERT INTO rule_inspection_report_mapping VALUES (20, 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', '5');
INSERT INTO rule_inspection_report_mapping VALUES (21, 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', '6');
INSERT INTO rule_inspection_report_mapping VALUES (22, 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', '7');
INSERT INTO rule_inspection_report_mapping VALUES (23, 'c57f055e-fd84-4af3-ba97-892a8fdc1fed', '3');
INSERT INTO rule_inspection_report_mapping VALUES (24, 'c57f055e-fd84-4af3-ba97-892a8fdc1fed', '4');
INSERT INTO rule_inspection_report_mapping VALUES (25, 'c57f055e-fd84-4af3-ba97-892a8fdc1fed', '5');
INSERT INTO rule_inspection_report_mapping VALUES (26, 'c57f055e-fd84-4af3-ba97-892a8fdc1fed', '6');
INSERT INTO rule_inspection_report_mapping VALUES (27, 'c57f055e-fd84-4af3-ba97-892a8fdc1fed', '7');
INSERT INTO rule_inspection_report_mapping VALUES (28, 'ff153eea-2628-440b-b054-186d6f5a7708', '10');
INSERT INTO rule_inspection_report_mapping VALUES (29, 'ff153eea-2628-440b-b054-186d6f5a7708', '13');
INSERT INTO rule_inspection_report_mapping VALUES (30, '88a77028-0e2a-4201-a713-ded3a94864f9', '10');
INSERT INTO rule_inspection_report_mapping VALUES (31, '88a77028-0e2a-4201-a713-ded3a94864f9', '13');
INSERT INTO rule_inspection_report_mapping VALUES (32, '7d323895-f07b-4845-8b3d-01c78180f270', '10');
INSERT INTO rule_inspection_report_mapping VALUES (33, '7d323895-f07b-4845-8b3d-01c78180f270', '13');
INSERT INTO rule_inspection_report_mapping VALUES (34, '339cf3fc-f9d9-457e-ac72-40d37c402bdf', '10');
INSERT INTO rule_inspection_report_mapping VALUES (35, '339cf3fc-f9d9-457e-ac72-40d37c402bdf', '13');
INSERT INTO rule_inspection_report_mapping VALUES (36, 'd826c85d-cb42-4824-ab13-6d7a8026d9ae', '10');
INSERT INTO rule_inspection_report_mapping VALUES (37, 'd826c85d-cb42-4824-ab13-6d7a8026d9ae', '13');
INSERT INTO rule_inspection_report_mapping VALUES (38, '429f8396-e04b-49d9-8b38-80647ac87e66', '10');
INSERT INTO rule_inspection_report_mapping VALUES (39, '429f8396-e04b-49d9-8b38-80647ac87e66', '13');
INSERT INTO rule_inspection_report_mapping VALUES (40, 'ba1edc8f-0944-4ebb-a953-f655aa710e84', '52');
INSERT INTO rule_inspection_report_mapping VALUES (41, '1299a29b-e19d-4186-93fd-a18ed1b2584a', '52');
INSERT INTO rule_inspection_report_mapping VALUES (42, 'ae65e90c-124c-4a81-8081-746d47f44e8f', '2');
INSERT INTO rule_inspection_report_mapping VALUES (43, 'ae65e90c-124c-4a81-8081-746d47f44e8f', '56');
INSERT INTO rule_inspection_report_mapping VALUES (44, 'ae65e90c-124c-4a81-8081-746d47f44e8f', '57');
INSERT INTO rule_inspection_report_mapping VALUES (45, 'ae65e90c-124c-4a81-8081-746d47f44e8f', '58');
INSERT INTO rule_inspection_report_mapping VALUES (46, '70c1e701-b87a-4e4d-8648-3db7ecc2c066', '32');
INSERT INTO rule_inspection_report_mapping VALUES (47, '70c1e701-b87a-4e4d-8648-3db7ecc2c066', '90');
INSERT INTO rule_inspection_report_mapping VALUES (48, '3e5d47ac-86b6-40d1-a191-1b2ff2496118', '3');
INSERT INTO rule_inspection_report_mapping VALUES (49, '3e5d47ac-86b6-40d1-a191-1b2ff2496118', '4');
INSERT INTO rule_inspection_report_mapping VALUES (50, '3e5d47ac-86b6-40d1-a191-1b2ff2496118', '5');
INSERT INTO rule_inspection_report_mapping VALUES (51, '3e5d47ac-86b6-40d1-a191-1b2ff2496118', '6');
INSERT INTO rule_inspection_report_mapping VALUES (52, '3e5d47ac-86b6-40d1-a191-1b2ff2496118', '7');
INSERT INTO rule_inspection_report_mapping VALUES (53, '3e5d47ac-86b6-40d1-a191-1b2ff2496118', '91');
INSERT INTO rule_inspection_report_mapping VALUES (54, '2533542d-5422-4bd5-8849-6a69ec05a874', '53');
INSERT INTO rule_inspection_report_mapping VALUES (55, '2533542d-5422-4bd5-8849-6a69ec05a874', '94');
INSERT INTO rule_inspection_report_mapping VALUES (56, '083d24e2-881f-488b-b120-8h2rd961707f', '10');
INSERT INTO rule_inspection_report_mapping VALUES (57, '083d24e2-881f-488b-b120-8f2cd961707f', '13');
INSERT INTO rule_inspection_report_mapping VALUES (58, '083d24e2-881f-488b-b120-8h2rd961707f', '92');
INSERT INTO rule_inspection_report_mapping VALUES (59, '083d24e2-881f-488b-b120-8h2rd961707f', '93');
INSERT INTO rule_inspection_report_mapping VALUES (60, '083d24e2-881f-488b-b120-8h2rd961707f', '95');
INSERT INTO rule_inspection_report_mapping VALUES (61, '9d94781e-922d-48c3-90a1-393dc79f2442', '53');
INSERT INTO rule_inspection_report_mapping VALUES (62, '9d94781e-922d-48c3-90a1-393dc79f2442', '55');
INSERT INTO rule_inspection_report_mapping VALUES (63, '9d94781e-922d-48c3-90a1-393dc79f2442', '96');
INSERT INTO rule_inspection_report_mapping VALUES (64, '028b8362-08f2-404c-8e15-935426bb8545', '97');
INSERT INTO rule_inspection_report_mapping VALUES (65, 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', '9');
INSERT INTO rule_inspection_report_mapping VALUES (66, 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', '46');
INSERT INTO rule_inspection_report_mapping VALUES (67, 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', '92');
INSERT INTO rule_inspection_report_mapping VALUES (68, 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', '93');
INSERT INTO rule_inspection_report_mapping VALUES (69, 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', '95');
INSERT INTO rule_inspection_report_mapping VALUES (70, '2adbae64-6403-4dfb-92ab-637354da49f8', '10');
INSERT INTO rule_inspection_report_mapping VALUES (71, '2adbae64-6403-4dfb-92ab-637354da49f8', '13');


INSERT INTO rule_group_mapping VALUES (1, 'd690be79-2e8c-4054-bbe6-496bd29e91fe', @groupId1);
INSERT INTO rule_group_mapping VALUES (2, '6fd132c0-b4df-4685-b132-5441d1aef2f8', @groupId1);
INSERT INTO rule_group_mapping VALUES (3, 'c95fde94-53a5-4658-98a4-56a0c6d951d4', @groupId1);
INSERT INTO rule_group_mapping VALUES (4, 'fdef013f-ce14-468a-9af4-1c0fabc7e6e1', @groupId1);
INSERT INTO rule_group_mapping VALUES (5, 'fdef013f-ce14-468a-9af4-1c0fabc7e6e1', @groupId3);
INSERT INTO rule_group_mapping VALUES (6, '8c635fda-7f89-4d5c-b0f4-2116f1b65554', @groupId1);
INSERT INTO rule_group_mapping VALUES (7, '8c635fda-7f89-4d5c-b0f4-2116f1b65554', @groupId3);
INSERT INTO rule_group_mapping VALUES (8, '0b2ece35-a17e-4584-ac2d-0b11483d04fb', @groupId1);
INSERT INTO rule_group_mapping VALUES (9, '594e7673-c0db-40a4-9a0c-f70f0e58cc62', @groupId1);
INSERT INTO rule_group_mapping VALUES (10, '44343a84-39e2-4fbc-b8c5-d3ac06186501', @groupId1);
INSERT INTO rule_group_mapping VALUES (11, '29763f5e-ef4c-431d-b44f-39cd1b5b5363', @groupId1);
INSERT INTO rule_group_mapping VALUES (12, 'e054787c-5826-4242-8450-b0daa926ea40', @groupId1);
INSERT INTO rule_group_mapping VALUES (13, 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', @groupId1);
INSERT INTO rule_group_mapping VALUES (14, 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', @groupId2);
INSERT INTO rule_group_mapping VALUES (15, 'c57f055e-fd84-4af3-ba97-892a8fdc1fed', @groupId1);
INSERT INTO rule_group_mapping VALUES (16, 'ff153eea-2628-440b-b054-186d6f5a7708', @groupId1);
INSERT INTO rule_group_mapping VALUES (17, '88a77028-0e2a-4201-a713-ded3a94864f9', @groupId1);
INSERT INTO rule_group_mapping VALUES (18, '88a77028-0e2a-4201-a713-ded3a94864f9', @groupId2);
INSERT INTO rule_group_mapping VALUES (19, '7d323895-f07b-4845-8b3d-01c78180f270', @groupId1);
INSERT INTO rule_group_mapping VALUES (20, '339cf3fc-f9d9-457e-ac72-40d37c402bdf', @groupId1);
INSERT INTO rule_group_mapping VALUES (21, '339cf3fc-f9d9-457e-ac72-40d37c402bdf', @groupId2);
INSERT INTO rule_group_mapping VALUES (22, 'd826c85d-cb42-4824-ab13-6d7a8026d9ae', @groupId1);
INSERT INTO rule_group_mapping VALUES (23, 'd826c85d-cb42-4824-ab13-6d7a8026d9ae', @groupId3);
INSERT INTO rule_group_mapping VALUES (24, '429f8396-e04b-49d9-8b38-80647ac87e66', @groupId1);
INSERT INTO rule_group_mapping VALUES (25, '429f8396-e04b-49d9-8b38-80647ac87e66', @groupId3);
INSERT INTO rule_group_mapping VALUES (26, 'ba1edc8f-0944-4ebb-a953-f655aa710e84', @groupId1);
INSERT INTO rule_group_mapping VALUES (27, '1299a29b-e19d-4186-93fd-a18ed1b2584a', @groupId1);
INSERT INTO rule_group_mapping VALUES (28, 'ae65e90c-124c-4a81-8081-746d47f44e8f', @groupId1);
INSERT INTO rule_group_mapping VALUES (29, 'ae65e90c-124c-4a81-8081-746d47f44e8f', @groupId2);
INSERT INTO rule_group_mapping VALUES (30, '70c1e701-b87a-4e4d-8648-3db7ecc2c066', @groupId1);
INSERT INTO rule_group_mapping VALUES (31, '70c1e701-b87a-4e4d-8648-3db7ecc2c066', @groupId2);
INSERT INTO rule_group_mapping VALUES (32, '3e5d47ac-86b6-40d1-a191-1b2ff2496118', @groupId1);
INSERT INTO rule_group_mapping VALUES (33, '2533542d-5422-4bd5-8849-6a69ec05a874', @groupId1);
INSERT INTO rule_group_mapping VALUES (34, '083d24e2-881f-488b-b120-8h2rd961707f', @groupId1);
INSERT INTO rule_group_mapping VALUES (35, '9d94781e-922d-48c3-90a1-393dc79f2442', @groupId1);
INSERT INTO rule_group_mapping VALUES (36, '9d94781e-922d-48c3-90a1-393dc79f2442', @groupId2);
INSERT INTO rule_group_mapping VALUES (37, '9d94781e-922d-48c3-90a1-393dc79f2442', @groupId3);
INSERT INTO rule_group_mapping VALUES (38, '028b8362-08f2-404c-8e15-935426bb8545', @groupId1);
INSERT INTO rule_group_mapping VALUES (39, 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', @groupId1);
INSERT INTO rule_group_mapping VALUES (40, 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', @groupId2);
INSERT INTO rule_group_mapping VALUES (41, 'beda16d0-93fd-4366-9ebf-f5ce1360cd60', @groupId1);
INSERT INTO rule_group_mapping VALUES (42, '2adbae64-6403-4dfb-92ab-637354da49f8', @groupId1);


INSERT INTO rule_type VALUES ('245bc538-2c33-430a-a61c-37000d058263', 'ff153eea-2628-440b-b054-186d6f5a7708', 'aliyun.redis');
INSERT INTO rule_type VALUES ('26b965d0-a16e-4d4a-b727-1816f07ce49a', 'c57f055e-fd84-4af3-ba97-892a8fdc1fed', 'aliyun.polardb');
INSERT INTO rule_type VALUES ('4155c0ce-6f20-43a2-9a1f-678ed0e2ee0f', '083d24e2-881f-488b-b120-8h2rd961707f', 'aliyun.security-group');
INSERT INTO rule_type VALUES ('4b3dd93c-6f3a-4bdb-afd7-6039d826b541', '3e5d47ac-86b6-40d1-a191-1b2ff2496118', 'aliyun.ecs');
INSERT INTO rule_type VALUES ('50e1f0a2-2c98-4af3-b458-847771cdf80c', 'e054787c-5826-4242-8450-b0daa926ea40', 'aliyun.rds');
INSERT INTO rule_type VALUES ('545f8a99-b613-4d6e-85da-1f48cc076cbf', 'beda16d0-93fd-4366-9ebf-f5ce1360cd60', 'aliyun.rds');
INSERT INTO rule_type VALUES ('63d01a83-df8c-4b3c-a244-12031698568f', '339cf3fc-f9d9-457e-ac72-40d37c402bdf', 'aliyun.slb');
INSERT INTO rule_type VALUES ('66f5bfd5-48f4-4454-9df0-3e6d856aa36f', '44343a84-39e2-4fbc-b8c5-d3ac06186501', 'aliyun.mongodb');
INSERT INTO rule_type VALUES ('75bd5124-f247-4cdc-a0d5-fdd9a573b1f3', '6fd132c0-b4df-4685-b132-5441d1aef2f8', 'aliyun.ecs');
INSERT INTO rule_type VALUES ('883d6aa5-a59d-4844-98fa-5a53d1acb6ef', 'd690be79-2e8c-4054-bbe6-496bd29e91fe', 'aliyun.rds');
INSERT INTO rule_type VALUES ('922e73cd-a782-4238-9381-277c0e54f9d7', '2adbae64-6403-4dfb-92ab-637354da49f8', 'aliyun.polardb');
INSERT INTO rule_type VALUES ('a1bbf517-80f6-4a6d-b043-3e2654b9efbb', '0b2ece35-a17e-4584-ac2d-0b11483d04fb', 'aliyun.eip');
INSERT INTO rule_type VALUES ('a71f9bc1-6c08-4618-bad8-5da9d4452968', '70c1e701-b87a-4e4d-8648-3db7ecc2c066', 'aliyun.ram');
INSERT INTO rule_type VALUES ('b79afedc-1880-4aac-8bbf-f4d05eaea1d3', 'df4fb45c-f9bc-4c8e-996d-036c9d2f1800', 'aliyun.security-group');
INSERT INTO rule_type VALUES ('bbd20d15-6e27-4a53-b67b-0890c0d0c452', '594e7673-c0db-40a4-9a0c-f70f0e58cc62', 'aliyun.slb');
INSERT INTO rule_type VALUES ('bd0f8305-661a-40f3-a4e0-ee457e6da76e', 'fdef013f-ce14-468a-9af4-1c0fabc7e6e1', 'aliyun.oss');


INSERT INTO rule_type VALUES ('bfc2ce96-e36f-4280-bdeb-9b88204aff0a', '2533542d-5422-4bd5-8849-6a69ec05a874', 'aliyun.disk');
INSERT INTO rule_type VALUES ('c36099af-2a2f-496f-8bf7-4435e3edd64e', '88a77028-0e2a-4201-a713-ded3a94864f9', 'aliyun.slb');
INSERT INTO rule_type VALUES ('c9a126eb-41e8-4e8c-b2dd-57b9c4df9a34', '29763f5e-ef4c-431d-b44f-39cd1b5b5363', 'aliyun.redis');
INSERT INTO rule_type VALUES ('cd140b9d-0d2b-4535-a13e-3887f80dc56a', 'ae65e90c-124c-4a81-8081-746d47f44e8f', 'aliyun.rds');
INSERT INTO rule_type VALUES ('e39bb334-d7ae-4fc5-9caa-e91ac5e594e0', '429f8396-e04b-49d9-8b38-80647ac87e66', 'aliyun.oss');
INSERT INTO rule_type VALUES ('e4f77952-ef02-4d6d-8771-502ef1343811', '9d94781e-922d-48c3-90a1-393dc79f2442', 'aliyun.oss');
INSERT INTO rule_type VALUES ('eb725846-fe34-4d48-9e13-5c727c268dfd', '028b8362-08f2-404c-8e15-935426bb8545', 'aliyun.rds');
INSERT INTO rule_type VALUES ('ebcac89f-9f95-4bbf-8843-3591232150d6', 'ba1edc8f-0944-4ebb-a953-f655aa710e84', 'aliyun.cdn');
INSERT INTO rule_type VALUES ('f08d6448-024f-4d03-bf4d-705c8c973704', 'd826c85d-cb42-4824-ab13-6d7a8026d9ae', 'aliyun.oss');
INSERT INTO rule_type VALUES ('f3686b01-3bf7-4e5b-b55d-14b607323bf0', '7d323895-f07b-4845-8b3d-01c78180f270', 'aliyun.mongodb');
INSERT INTO rule_type VALUES ('f5d5b91f-1530-42d2-b007-603184247f24', '8c635fda-7f89-4d5c-b0f4-2116f1b65554', 'aliyun.oss');
INSERT INTO rule_type VALUES ('f6f58432-7418-49c6-bb79-f764694e53ce', '1299a29b-e19d-4186-93fd-a18ed1b2584a', 'aliyun.slb');
INSERT INTO rule_type VALUES ('fd0d0f27-ec6e-40ba-b30a-11043b209bbc', 'c95fde94-53a5-4658-98a4-56a0c6d951d4', 'aliyun.rds');
INSERT INTO rule_type VALUES ('fd8eeea3-cabf-491f-9411-6d11407f45b3', 'e2d51fc6-2ec2-4d17-bf87-13a3df90ea5d', 'aliyun.slb');



INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Huawei 等保预检', '等保合规检查（全称为等级保护合规检查）为您提供了全面覆盖通信网络、区域边界、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-huawei-plugin', 1);
SELECT @groupId1 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Huawei CIS合规检查', 'CIS（Center for Internet Security）合规检查能力，为您动态且持续地监控您保有在云上的资源是否符合 CIS Control 网络安全架构要求。', '高风险', 'hummer-huawei-plugin', 1);
SELECT @groupId2 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Huawei OBS合规基线', 'OBS 合规检查为您提供全方位的对象存储资源检查功能。', '高风险', 'hummer-huawei-plugin', 1);
SELECT @groupId3 := LAST_INSERT_ID();

INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('0cf1e428-3c37-4aa6-b651-acb46c4838c0', 'Huawei Redis 实例公网访问检测', 1, 'HighRisk', 'Huawei 账号下 Redis 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # Huawei 账号下 Redis 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”。\n    - name: huawei-redis-internet-access\n      resource: huawei.redis\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('108c875b-bf3c-4034-b07d-15faa8715257', 'Huawei ECS 实例公网IP检测', 1, 'HighRisk', 'Huawei ECS 实例未直接绑定公网 IP，符合视为“合规”，否则视为“不合规”。(该规则仅适用于 IPv4 协议)', 'policies:\n    # Huawei ECS 实例未直接绑定公网 IP，符合视为“合规”，否则视为“不合规”。(该规则仅适用于 IPv4 协议)。\n    - name: huawei-ecs-public-ipaddress\n      resource: huawei.ecs\n      filters:\n        - type: public-ip-address', '[]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('2677aa0f-6796-4138-902b-f736e0c3d8da', 'Huawei OBS 公开读取访问权限检测', 1, 'HighRisk', 'Huawei 查看您的 OBS 存储桶是否不允许公开读取访问权限。如果某个 OBS 存储桶策略或存储桶 ACL 允许公开读取访问权限，则该存储桶“不合规“', 'policies:\n    # 查看您的OBS存储桶是否不允许公开读取访问权限。如果某个OBS存储桶策略或存储桶 ACL 允许公开读取访问权限，则该存储桶“不合规“\n    - name: huawei-obs-global-grants\n      resource: huawei.obs\n      filters:\n        - type: global-grants\n          value: read', '[]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('332ce586-70de-4053-a922-f76d6340a03c', 'Huawei RDS 实例计费类型检测', 1, 'HighRisk', 'Huawei 测您账号下 RDS 数据库实例计费类型信息，按需视为“合规”，否则视为“不合规”', 'policies:\n    #测您账号下RDS数据库实例计费类型信息，按需视为“合规”，否则视为“不合规”\n    - name: huawei-rds-charge-info\n      resource: huawei.rds\n      filters:\n        - type: charge-info\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"计费模式:prePaid包年包月/postPaid按需\",\"defaultValue\":\"postPaid\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('33a70278-c772-4ef0-93c9-4b9d3df1e242', 'Huawei RDS 实例磁盘空间检测', 1, 'HighRisk', 'Huawei 账号下 RDS 实例磁盘空间是否已满，未满视为“合规”，否则属于“不合规”', 'policies:\n    # 账号下RDS实例磁盘空间是否已满，未满视为“合规”，否则属于“不合规”。\n    - name: huawei-rds-storagefull\n      resource: huawei.rds\n      filters:\n        - type: storagefull', '[]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('36908c29-c15e-4c73-a964-5fb97bbb27fa', 'Huawei Disk 磁盘加密状态检测', 1, 'HighRisk', 'Huawei 账号下所有的磁盘均已加密；若您配置阈值，则磁盘加密的 Id 需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下所有的磁盘是否加密，加密视为“合规”，否则属于“不合规”。\n    - name: huawei-encrypted-disk\n      resource: huawei.disk\n      filters:\n        - type: encrypted\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"磁盘是否加密( true/false )\",\"defaultValue\":\"false\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('3b3a76cf-78e4-4c48-84da-baf2af6be696', 'Huawei EIP 带宽峰值检测', 1, 'HighRisk', 'Huawei 检测您账号下的弹性 IP 实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下的弹性IP实例是否达到最低带宽要求\n    - name: huawei-eip-bandwidth\n      resource: huawei.eip\n      filters:\n        - type: bandwidth\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"按带宽计费的公网型实例的带宽峰值\",\"defaultValue\":\"10\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('3c4f6db4-6f8d-4e42-9c7e-d209fe5489fb', 'Huawei ELB 负载均衡 HTTPS 监听检测', 1, 'HighRisk', 'Huawei ELB 负载均衡开启 HTTPS 监听，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 负载均衡开启HTTPS监听，视为“合规”。\n    - name: huawei-elb-listener\n      resource: huawei.elb\n      filters:\n        - type: listener\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"负载均衡实例前端使用的协议\",\"defaultValue\":\"HTTPS\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('3ce82502-1c03-4ab0-b8ed-83f631a20805', 'Huawei Redis 实例免密码访问检测', 1, 'HighRisk', 'Huawei 账号下 Redis 实例是否允许免密码访问，不允许视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下Redis实例是否允许免密码访问，不允许视为“合规”，否则视为“不合规”\n    - name: huawei-redis-internet-access\n      resource: huawei.redis\n      filters:\n        - type: no-password-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"免密码访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('5c681b76-fea3-4cb9-b6d4-a92d0d2d44fa', 'Huawei ELB 实例关联云服务器组检测', 1, 'HighRisk', 'Huawei 账号下负载均衡实例是否已关联到后端云服务器组；若关联，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下负载均衡实例是否已关联到后端云服务器组；若关联，符合视为“合规”，否则视为“不合规”。\n    - name: huawei-elb-unused\n      resource: huawei.elb\n      filters:\n        - type: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否已关联到后端云服务器组\",\"defaultValue\":\"unused\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('7e7b3463-c7da-4545-bbc7-f97c83f429e4', 'Huawei ELB 实例绑定公网 IP 检测', 1, 'HighRisk', 'Huawei 负载均衡实例未直接绑定公网 IP，视为“合规”，否则属于“不合规”。该规则仅适用于 IPv4 协议', 'policies:\n    # 负载均衡实例未直接绑定公网IP，视为“合规”。该规则仅适用于 IPv4 协议。\n    - name: huawei-elb-address-type\n      resource: huawei.elb\n      filters:\n        - type: address-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"internet 公网/intranet 内网\",\"defaultValue\":\"internet\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('8f3f7596-569b-4cde-97a2-1d565b8224e1', 'Huawei SecurityGroup 安全组配置检测', 1, 'HighRisk', 'Huawei 账号下 ECS 安全组配置不为“0.0.0.0/0”，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下ECS安全组配置不为“0.0.0.0/0”，视为“合规”。\n    - name: huawei-sg-source-cidr-ip\n      resource: huawei.security-group\n      filters:\n        - type: source-cidr-ip\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"目标IP地址段\",\"defaultValue\":\"\\\"0.0.0.0/0\\\"\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('968837c3-25f2-4848-8174-5413c859f1f1', 'Huawei OBS 公开写入访问权限检测', 1, 'HighRisk', 'Huawei 查看 OBS 存储桶是否不允许公开写入访问权限。如果某个 OBS 存储桶策略或存储桶 ACL 允许公开写入访问权限，则该存储桶“不合规“', 'policies:\n    # OBS存储桶是否不允许公开写入访问权限。如果某个OBS存储桶策略或存储桶 ACL 允许公开写入访问权限，则该存储桶“不合规“\n    - name: huawei-obs-public-read-write\n      resource: huawei.obs\n      filters:\n        - type: global-grants\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公开写入访问权限\",\"defaultValue\":\"write\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('99e762e7-766f-4e55-9133-773593497b44', 'Huawei SecurityGroup 高危安全组检测', 1, 'HighRisk', 'Huawei 检测安全组是否开启风险端口，未开启视为“合规”，否则属于“不合规”', 'policies:\n  #检测开放以下高危端口的安全组：\n  #(20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500)\n  - name: huawei-security-group\n    resource: huawei.security-group\n    description: |\n      Add Filter all security groups, filter ports\n      [20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500]\n      on 0.0.0.0/0 or\n      [20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\n      on ::/0 (IPv6)\n    filters:\n        - or:\n            - type: ingress\n              IpProtocol: \"-1\"\n              Ports: ${{ipv4_port}}\n              Cidr: \"0.0.0.0/0\"\n            - type: ingress\n              IpProtocol: \"-1\"\n              Ports: ${{ipv6_port}}\n              CidrV6: \"::/0\"', '[{\"key\":\"ipv4_port\",\"name\":\"ipv4端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true},{\"key\":\"ipv6_port\",\"name\":\"ipv6端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('b1260ecf-47fa-4613-8ed4-71417f29441b', 'Huawei RDS 实例公网访问检测', 1, 'HighRisk', 'Huawei 检测您账号下 RDS 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下RDS实例不允许任意来源公网访问，视为“合规”\n    - name: huawei-rds-internet-access\n      resource: huawei.rds\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"允许任意来源公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('bb878650-b62b-4980-a6aa-4d61c1a429a0', 'Huawei DDS 实例公网访问检测', 1, 'HighRisk', 'Huawei 账号下 DDS 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下DDS实例不允许任意来源公网访问，视为“合规”\n    - name: huawei-dds-internet-access\n      resource: huawei.dds\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('ce805504-de52-4ecc-a86a-4905d2a558f3', 'Huawei RDS 实例网络类型检测', 1, 'HighRisk', 'Huawei 账号下 RDS 实例已关联到 VPC；视为“合规”，否则属于“不合规”', 'policies:\n    # 账号下RDS实例已关联到VPC；视为“合规”。\n    - name: huawei-rds-instance-network-type\n      resource: huawei.rds\n      filters:\n        - type: instance-network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型\",\"defaultValue\":\"VPC\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('e58a3395-aee8-40bb-8f2f-d7156c0435cb', 'Huawei IAM 用户是否登录保护检测', 1, 'HighRisk', 'Huawei 检测 IAM 用户是否开启登录保护，开启视为“合规”，否则属于“不合规”', 'policies:\n    # 检测IAM用户是否开启登录保护，开启视为“合规”，否则属于“不合规”\n    - name: huawei-iam-login\n      resource: huawei.iam\n      filters:\n        - type: login\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"检测IAM用户是否开启登录保护\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('f744fdd9-166d-40a7-ad91-9e933ad514cc', 'Huawei RDS 实例高可用状态检测', 1, 'HighRisk', 'Huawei 账号下 RDS 实例具备高可用能力，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下RDS实例具备高可用能力，符合视为“合规”，否则视为“不合规”。\n    - name: huawei-rds-high-availability\n      resource: huawei.rds\n      filters:\n        - type: high-availability', '[]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('f7e8d1c4-16f7-4079-b110-b60db0cd91bf', 'Huawei ECS 实例网络类型检测', 1, 'HighRisk', 'Huawei 账号下所有 ECS 实例已关联到 VPC；若您配置阈值，则关联的 VpcId 需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下所有ECS实例已关联到VPC；若您配置阈值，则关联的VpcId需存在您列出的阈值中，视为“合规”\n    - name: huawei-ecs-instance-network-type\n      resource: huawei.ecs\n      filters:\n        - type: instance-network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型:classic经典网络/vpc网络\",\"defaultValue\":\"vpc\",\"required\":true}]', 'hummer-huawei-plugin', '华为云', 'fusion.png', concat(unix_timestamp(now()), '002'), 1, 'custodian');


INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (31, '36908c29-c15e-4c73-a964-5fb97bbb27fa', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (32, '968837c3-25f2-4848-8174-5413c859f1f1', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (33, '2677aa0f-6796-4138-902b-f736e0c3d8da', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (34, '7e7b3463-c7da-4545-bbc7-f97c83f429e4', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (35, '5c681b76-fea3-4cb9-b6d4-a92d0d2d44fa', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (36, '108c875b-bf3c-4034-b07d-15faa8715257', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (37, '3b3a76cf-78e4-4c48-84da-baf2af6be696', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (38, '3c4f6db4-6f8d-4e42-9c7e-d209fe5489fb', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (39, 'f7e8d1c4-16f7-4079-b110-b60db0cd91bf', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (40, '8f3f7596-569b-4cde-97a2-1d565b8224e1', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (41, '99e762e7-766f-4e55-9133-773593497b44', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (42, 'b1260ecf-47fa-4613-8ed4-71417f29441b', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (43, 'f744fdd9-166d-40a7-ad91-9e933ad514cc', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (44, '33a70278-c772-4ef0-93c9-4b9d3df1e242', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (45, 'ce805504-de52-4ecc-a86a-4905d2a558f3', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (46, 'e58a3395-aee8-40bb-8f2f-d7156c0435cb', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (47, '0cf1e428-3c37-4aa6-b651-acb46c4838c0', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (48, '3ce82502-1c03-4ab0-b8ed-83f631a20805', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (49, 'bb878650-b62b-4980-a6aa-4d61c1a429a0', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (50, '332ce586-70de-4053-a922-f76d6340a03c', 'cost');


INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (72, '36908c29-c15e-4c73-a964-5fb97bbb27fa', '53');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (73, '36908c29-c15e-4c73-a964-5fb97bbb27fa', '94');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (74, '968837c3-25f2-4848-8174-5413c859f1f1', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (75, '968837c3-25f2-4848-8174-5413c859f1f1', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (76, '2677aa0f-6796-4138-902b-f736e0c3d8da', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (77, '2677aa0f-6796-4138-902b-f736e0c3d8da', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (78, '7e7b3463-c7da-4545-bbc7-f97c83f429e4', '52');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (79, '5c681b76-fea3-4cb9-b6d4-a92d0d2d44fa', '52');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (80, '3b3a76cf-78e4-4c48-84da-baf2af6be696', '2');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (81, '3c4f6db4-6f8d-4e42-9c7e-d209fe5489fb', '52');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (82, 'f7e8d1c4-16f7-4079-b110-b60db0cd91bf', '3');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (83, 'f7e8d1c4-16f7-4079-b110-b60db0cd91bf', '5');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (84, '8f3f7596-569b-4cde-97a2-1d565b8224e1', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (85, '8f3f7596-569b-4cde-97a2-1d565b8224e1', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (86, '8f3f7596-569b-4cde-97a2-1d565b8224e1', '92');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (87, '8f3f7596-569b-4cde-97a2-1d565b8224e1', '93');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (88, '8f3f7596-569b-4cde-97a2-1d565b8224e1', '95');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (89, '99e762e7-766f-4e55-9133-773593497b44', '9');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (90, '99e762e7-766f-4e55-9133-773593497b44', '46');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (91, '99e762e7-766f-4e55-9133-773593497b44', '92');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (92, '99e762e7-766f-4e55-9133-773593497b44', '93');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (93, '99e762e7-766f-4e55-9133-773593497b44', '95');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (94, 'b1260ecf-47fa-4613-8ed4-71417f29441b', '97');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (95, 'f744fdd9-166d-40a7-ad91-9e933ad514cc', '2');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (96, 'f744fdd9-166d-40a7-ad91-9e933ad514cc', '56');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (97, 'f744fdd9-166d-40a7-ad91-9e933ad514cc', '57');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (98, 'f744fdd9-166d-40a7-ad91-9e933ad514cc', '58');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (99, 'ce805504-de52-4ecc-a86a-4905d2a558f3', '3');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (100, 'ce805504-de52-4ecc-a86a-4905d2a558f3', '4');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (101, 'ce805504-de52-4ecc-a86a-4905d2a558f3', '5');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (102, 'ce805504-de52-4ecc-a86a-4905d2a558f3', '6');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (103, 'ce805504-de52-4ecc-a86a-4905d2a558f3', '7');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (104, 'e58a3395-aee8-40bb-8f2f-d7156c0435cb', '32');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (105, 'e58a3395-aee8-40bb-8f2f-d7156c0435cb', '90');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (106, '0cf1e428-3c37-4aa6-b651-acb46c4838c0', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (107, '0cf1e428-3c37-4aa6-b651-acb46c4838c0', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (108, '3ce82502-1c03-4ab0-b8ed-83f631a20805', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (109, '3ce82502-1c03-4ab0-b8ed-83f631a20805', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (110, 'bb878650-b62b-4980-a6aa-4d61c1a429a0', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (111, 'bb878650-b62b-4980-a6aa-4d61c1a429a0', '13');


INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (43, '36908c29-c15e-4c73-a964-5fb97bbb27fa', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (44, '968837c3-25f2-4848-8174-5413c859f1f1', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (45, '968837c3-25f2-4848-8174-5413c859f1f1', @groupId3);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (46, '2677aa0f-6796-4138-902b-f736e0c3d8da', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (47, '2677aa0f-6796-4138-902b-f736e0c3d8da', @groupId3);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (48, '7e7b3463-c7da-4545-bbc7-f97c83f429e4', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (49, '5c681b76-fea3-4cb9-b6d4-a92d0d2d44fa', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (50, '108c875b-bf3c-4034-b07d-15faa8715257', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (51, '3b3a76cf-78e4-4c48-84da-baf2af6be696', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (52, '3c4f6db4-6f8d-4e42-9c7e-d209fe5489fb', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (53, 'f7e8d1c4-16f7-4079-b110-b60db0cd91bf', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (54, '8f3f7596-569b-4cde-97a2-1d565b8224e1', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (55, '99e762e7-766f-4e55-9133-773593497b44', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (56, '99e762e7-766f-4e55-9133-773593497b44', @groupId3);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (57, 'b1260ecf-47fa-4613-8ed4-71417f29441b', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (58, 'f744fdd9-166d-40a7-ad91-9e933ad514cc', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (59, 'f744fdd9-166d-40a7-ad91-9e933ad514cc', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (60, '33a70278-c772-4ef0-93c9-4b9d3df1e242', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (61, 'ce805504-de52-4ecc-a86a-4905d2a558f3', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (62, 'e58a3395-aee8-40bb-8f2f-d7156c0435cb', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (63, 'e58a3395-aee8-40bb-8f2f-d7156c0435cb', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (64, '0cf1e428-3c37-4aa6-b651-acb46c4838c0', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (65, '3ce82502-1c03-4ab0-b8ed-83f631a20805', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (66, 'bb878650-b62b-4980-a6aa-4d61c1a429a0', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (67, '332ce586-70de-4053-a922-f76d6340a03c', @groupId1);


INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('0663e58a-ce96-4687-9778-6df448501ba8', '3b3a76cf-78e4-4c48-84da-baf2af6be696', 'huawei.eip');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('0ab08df9-e628-4dc2-ad51-3789a16c6bc8', 'f744fdd9-166d-40a7-ad91-9e933ad514cc', 'huawei.rds');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('1f681a6a-21c6-4cef-8574-8ce741949866', '3ce82502-1c03-4ab0-b8ed-83f631a20805', 'huawei.redis');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('22f28cd2-d06d-48fa-ae36-0c95e1925be9', '332ce586-70de-4053-a922-f76d6340a03c', 'huawei.rds');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('3e50ec86-1a2a-486e-920b-39572eb8d193', '2677aa0f-6796-4138-902b-f736e0c3d8da', 'huawei.obs');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('421ae776-4b20-4f80-89f6-4133f1a6a62e', '36908c29-c15e-4c73-a964-5fb97bbb27fa', 'huawei.disk');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('6955ae5d-75a3-4ed8-9636-295938a0b55b', 'b1260ecf-47fa-4613-8ed4-71417f29441b', 'huawei.rds');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('6a77f9da-a452-4052-adbd-cd005b2f8c58', '108c875b-bf3c-4034-b07d-15faa8715257', 'huawei.ecs');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('6b4f003c-37cd-4fa1-8fa9-290c0e2fc010', '99e762e7-766f-4e55-9133-773593497b44', 'huawei.security-group');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('8fa54aca-2c5b-428e-b47f-71520efb2a2f', 'bb878650-b62b-4980-a6aa-4d61c1a429a0', 'huawei.dds');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('a3de7add-00d9-4763-a14f-02883ffce51a', '8f3f7596-569b-4cde-97a2-1d565b8224e1', 'huawei.security-group');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('ad017b3f-292f-471b-ad65-c8523d68b984', '33a70278-c772-4ef0-93c9-4b9d3df1e242', 'huawei.rds');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('b654400f-d2a9-4a33-bc9f-8808e28cd6a9', 'ce805504-de52-4ecc-a86a-4905d2a558f3', 'huawei.rds');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('bc3376eb-00f7-4bfc-8567-05a82432e5f4', 'e58a3395-aee8-40bb-8f2f-d7156c0435cb', 'huawei.iam');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('c34068f3-c3ef-4998-ac3c-281ac41efe93', '0cf1e428-3c37-4aa6-b651-acb46c4838c0', 'huawei.redis');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('c4b55631-409f-4b62-b8cc-a61e5fc8e9c9', '5c681b76-fea3-4cb9-b6d4-a92d0d2d44fa', 'huawei.elb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('c98019ad-6ba4-47cf-ab85-0d0dcad25561', 'f7e8d1c4-16f7-4079-b110-b60db0cd91bf', 'huawei.ecs');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('ccde7b2c-719e-48c0-8fd3-79a8ce9827d0', '7e7b3463-c7da-4545-bbc7-f97c83f429e4', 'huawei.elb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('ce4967f4-70f9-4de5-b66d-7b7ade3bf198', '3c4f6db4-6f8d-4e42-9c7e-d209fe5489fb', 'huawei.elb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('d4f87cf6-fe25-4251-ade9-00b07cfc6021', '968837c3-25f2-4848-8174-5413c859f1f1', 'huawei.obs');


INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Tencent 等保预检', '等保合规检查（全称为等级保护合规检查）为您提供了全面覆盖通信网络、区域边界、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-qcloud-plugin', 1);
SELECT @groupId1 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Tencent CIS合规检查', 'CIS（Center for Internet Security）合规检查能力，为您动态且持续地监控您保有在云上的资源是否符合 CIS Control 网络安全架构要求。', '高风险', 'hummer-qcloud-plugin', 1);
SELECT @groupId2 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Tencent COS合规基线', 'COS 合规检查为您提供全方位的对象存储资源检查功能。', '高风险', 'hummer-qcloud-plugin', 1);
SELECT @groupId3 := LAST_INSERT_ID();

INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('1240a2b8-f7ef-47c3-8048-2dd95d6d5b54', 'Tencent EIP 带宽峰值检测', 1, 'HighRisk', 'Tencent 检测您账号下的弹性 IP 实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下的弹性IP实例是否达到最低带宽要求\n    - name: tencent-eip-bandwidth\n      resource: tencent.eip\n      filters:\n        - type: bandwidth\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"按带宽计费的公网型实例的带宽峰值\",\"defaultValue\":\"10\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('159e19e9-e956-4c52-92fc-c9746372e448', 'Tencent CVM 实例关机计费模式检测', 1, 'HighRisk', 'Tencent CVM 实例的关机计费模式是否为关机停止收费，符合视为“合规”，否则视为“不合规”', 'policies:\n    # CVM实例的关机计费模式是否为关机停止收费，符合视为“合规”，否则视为“不合规”\n    - name: tencent-cvm-stop-charging-mode\n      resource: tencent.cvm\n      filters:\n        - type: stop-charging-mode\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"计费模式\",\"defaultValue\":\"STOP_CHARGING\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('17dbe1a1-e9e7-4513-aa07-597ae932ff73', 'Tencent CVM 实例公网 IP 检测', 1, 'HighRisk', 'Tencent CVM 实例未直接绑定公网 IP，符合视为“合规”，否则视为“不合规”。该规则仅适用于 IPv4 协议', 'policies:\n    # CVM实例未直接绑定公网IP，视为“合规”。该规则仅适用于 IPv4 协议\n    - name: tencent-cvm-public-ip-address\n      resource: tencent.cvm\n      filters:\n        - type: public-ip-address', '[]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('21fc2518-3b2b-475a-8398-4b1d9f68cfdb', 'Tencent Redis 实例网络类型检测', 1, 'HighRisk', 'Tencent 检测您账号下的 Redis 实例是否运行在VPC网络环境下，符合视为“合规”，否则属于“不合规”', 'policies:\n    # 检测您账号下的Redis实例是否运行在VPC网络环境下，符合视为“合规”\n    - name: tencent-redis-network-type\n      resource: tencent.redis\n      filters:\n        - type: network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型\",\"defaultValue\":\"vpc\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('2631d8a3-e5d8-4ef3-88c9-a8176fae110b', 'Tencent SecurityGroup 安全组配置检测', 1, 'HighRisk', 'Tencent 账号下 CVM 安全组配置不为“0.0.0.0/0”，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下ECS安全组配置不为“0.0.0.0/0”，视为“合规”。\n    - name: tencent-sg-source-cidr-ip\n      resource: tencent.security-group\n      filters:\n        - type: source-cidr-ip\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"目标IP地址段\",\"defaultValue\":\"\\\"0.0.0.0/0\\\"\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('2c4de559-7182-44e7-9657-b97412f0f0a7', 'Tencent CDB 实例网络类型检测', 1, 'HighRisk', 'Tencent 账号下 CDB 实例已关联到 VPC；若您配置阈值，则关联的VpcId需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下CDB实例已关联到VPC；若您配置阈值，则关联的VpcId需存在您列出的阈值中，视为“合规”。\n    - name: tencent-cdb-instance-network-type\n      resource: tencent.cdb\n      filters:\n        - type: network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型\",\"defaultValue\":\"vpc\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('3e66d418-3e47-475b-a863-03a9653940ed', 'Tencent COS 存储桶加密检测', 1, 'HighRisk', 'Tencent 查看并确认您的 COS 存储桶启用了默认加密，未开启则该存储桶“不合规“', 'policies:\n    # 查看并确认您的COS存储桶启用了默认加密，未开启则该存储桶“不合规“\n    - name: tencent-cos-encryption\n      resource: tencent.cos\n      filters:\n        - type: encryption\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否加密\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('4cffcef8-be1e-44e0-8057-892e2cf588d5', 'Tencent CDB 实例高可用状态检测', 1, 'HighRisk', 'Tencent 账号下 CDB 实例具备高可用能力，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下CDB实例具备高可用能力，符合视为“合规”，否则视为“不合规”。\n    - name: tencent-cdb-device-type\n      resource: tencent.cdb\n      filters:\n        - type: device-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例类型\",\"defaultValue\":\"BASIC\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('525d0b91-ca93-4d3d-8679-195aef136e0b', 'Tencent CLB 公网访问检测', 1, 'HighRisk', 'Tencent 账号下 CLB 不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下CLB不允许任意来源公网访问，视为“合规”\n    - name: tencent-clb-acls\n      resource: tencent.clb\n      filters:\n        - type: acls\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"网络类型\",\"defaultValue\":\"INTERNAL\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('59a95d30-30d7-45bf-ac47-80afed002ade', 'Tencent CLB 负载均衡实例关联到 VPC 检测', 1, 'HighRisk', 'Tencent 账号下负载均衡实例已关联到 VPC；若您配置阈值，则关联的 VpcId 需存在您列出的阈值中，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下负载均衡实例已关联到VPC；若您配置阈值，则关联的VpcId需存在您列出的阈值中，视为“合规”。\n    - name: tencent-clb-network-type\n      resource: tencent.clb\n      filters:\n        - type: network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"负载均衡实例的网络类型\",\"defaultValue\":\"vpc\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('68363ad8-cce8-4458-b8f1-9bd1d1af54a7', 'Tencent CDB 实例多可用区检测', 1, 'HighRisk', 'Tencent 账号下 CDB 实例支持多可用区，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下CDB实例支持多可用区，视为“合规”。\n    - name: tencent-cdb-availablezones\n      resource: tencent.cdb\n      filters:\n        - type: availablezones\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"支持多可用区\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('77eab07c-1e3c-4713-acf1-ed1bede0531d', 'Tencent COS 公开读取访问权限检测', 1, 'HighRisk', 'Tencent 查看您的 COS 存储桶是否不允许公开读取访问权限。如果某个COS存储桶策略或存储桶 ACL 允许公开读取访问权限，则该存储桶“不合规“', 'policies:\n    # 查看您的COS存储桶是否不允许公开读取访问权限。\n    - name: tencent-cos-global-grants\n      resource: tencent.cos\n      filters:\n        - type: global-grants\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公开读取访问权限\",\"defaultValue\":\"READ\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('a0dca246-563a-49c3-8a43-3c537ba1fb36', 'Tencent CLB 带宽峰值检测', 1, 'HighRisk', 'Tencent 检测您账号下的 CLB 负载均衡实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下的负载均衡实例是否达到最低带宽要求。\n    - name: tencent-clb-bandwidth\n      resource: tencent.clb\n      filters:\n        - type: bandwidth\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"按带宽计费的公网型实例的带宽峰值\",\"defaultValue\":\"10\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('bfbf6be1-69f8-448e-9c23-c5267530d573', 'Tencent Disk 磁盘加密检测', 1, 'HighRisk', 'Tencent 账号下所有的磁盘均已加密，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下所有的磁盘均已加密，符合视为“合规”，否则视为“不合规”\n    - name: tencent-disk-encrypt\n      resource: tencent.disk\n      filters:\n        - type: encrypt\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"磁盘是否加密( true/false )\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('c1b41cbc-1263-4d67-a7c6-cf064999c6f8', 'Tencent MongoDB 实例网络类型检测', 1, 'HighRisk', 'Tencent 检测您账号下的 MongoDB 实例是否运行在 VPC 网络环境下，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下的MongoDB实例是否运行在VPC网络环境下\n    - name: tencent-mongodb-network-type\n      resource: tencent.mongodb\n      filters:\n        - type: network-type\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"实例的网络类型\",\"defaultValue\":\"vpc\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('c95be861-6e0e-4404-9b21-5ccfcd94ee3f', 'Tencent MongoDB 实例公网访问检测', 1, 'HighRisk', 'Tencent 检测您账号下 MongoDB 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下MongoDB实例不允许任意来源公网访问，视为“合规”\n    - name: tencent-mongodb-internet-access\n      resource: tencent.mongodb\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"启用公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('ca991f61-49a4-49b2-9d14-16ca338d8149', 'Tencent COS 防盗链检测', 1, 'HighRisk', 'Tencent 检测 COS Bucket 是否开启防盗链开关，已开通视为“合规”，否则属于“不合规”', 'policies:\n    # 检测COS Bucket是否开启防盗链开关，已开通视为“合规”。\n    - name: tencent-cos-bucket-referer\n      resource: tencent.cos\n      filters:\n        - type: bucket-referer\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否开启防盗链开关\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('cb9320af-4ee6-4c11-8840-8ec4b9cc8276', 'Tencent CDB 实例公网访问检测', 1, 'HighRisk', 'Tencent 检测您账号下 CDB 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下CDB实例不允许任意来源公网访问，视为“合规”\n    - name: tencent-cdb-internet-access\n      resource: tencent.cdb\n      filters:\n        - type: internet-access\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"启用公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('f8badb51-4a56-48cc-993f-6eb6698ea0ea', 'Tencent COS 公开写入访问权限检测', 1, 'HighRisk', 'Tencent 查看您的 COS 存储桶是否不允许公开写入访问权限。如果某个 COS 存储桶策略或存储桶 ACL 允许公开写入访问权限，则该存储桶“不合规“', 'policies:\n    # 查看您的COS存储桶是否不允许公开写入访问权限。\n    - name: tencent-cos-global-grants\n      resource: tencent.cos\n      filters:\n        - type: global-grants\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"公开读取访问权限\",\"defaultValue\":\"WRITE\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');
INSERT INTO rule(id, name, status, severity, description, script, parameter, plugin_id, plugin_name, plugin_icon, last_modified, flag, scan_type) VALUES ('f9d3db46-d340-4487-ae9b-82b827108912', 'Tencent SecurityGroup 高危安全组检测', 1, 'HighRisk', 'Tencent 检测安全组是否开启风险端口，未开启视为“合规”，否则属于“不合规”', 'policies:\n  #检测开放以下高危端口的安全组：\n  #(20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500)\n  - name: tencent-security-group\n    resource: tencent.security-group\n    description: |\n      Add Filter all security groups, filter ports\n      [20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500]\n      on 0.0.0.0/0 or\n      [20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\n      on ::/0 (IPv6)\n    filters:\n        - or:\n            - type: ingress\n              IpProtocol: \"-1\"\n              Ports: ${{ipv4_port}}\n              Cidr: \"0.0.0.0/0\"\n              Action: ${{action}}\n            - type: ingress\n              IpProtocol: \"-1\"\n              Ports: ${{ipv6_port}}\n              CidrV6: \"::/0\"', '[{\"key\":\"ipv4_port\",\"name\":\"ipv4端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true},{\"key\":\"ipv6_port\",\"name\":\"ipv6端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true}]', 'hummer-qcloud-plugin', '腾讯云', 'qcloud.png', concat(unix_timestamp(now()), '003'), 1, 'custodian');


INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (51, '17dbe1a1-e9e7-4513-aa07-597ae932ff73', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (52, '159e19e9-e956-4c52-92fc-c9746372e448', 'cost');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (53, 'bfbf6be1-69f8-448e-9c23-c5267530d573', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (54, 'f9d3db46-d340-4487-ae9b-82b827108912', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (55, '2631d8a3-e5d8-4ef3-88c9-a8176fae110b', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (56, '1240a2b8-f7ef-47c3-8048-2dd95d6d5b54', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (57, '525d0b91-ca93-4d3d-8679-195aef136e0b', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (58, '21fc2518-3b2b-475a-8398-4b1d9f68cfdb', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (59, 'a0dca246-563a-49c3-8a43-3c537ba1fb36', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (60, '59a95d30-30d7-45bf-ac47-80afed002ade', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (61, 'cb9320af-4ee6-4c11-8840-8ec4b9cc8276', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (62, '4cffcef8-be1e-44e0-8057-892e2cf588d5', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (63, '68363ad8-cce8-4458-b8f1-9bd1d1af54a7', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (64, '2c4de559-7182-44e7-9657-b97412f0f0a7', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (65, '77eab07c-1e3c-4713-acf1-ed1bede0531d', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (66, 'f8badb51-4a56-48cc-993f-6eb6698ea0ea', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (67, 'ca991f61-49a4-49b2-9d14-16ca338d8149', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (68, '3e66d418-3e47-475b-a863-03a9653940ed', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (69, 'c1b41cbc-1263-4d67-a7c6-cf064999c6f8', 'safety');
INSERT INTO rule_tag_mapping(id, rule_id, tag_key) VALUES (70, 'c95be861-6e0e-4404-9b21-5ccfcd94ee3f', 'safety');


INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (112, 'bfbf6be1-69f8-448e-9c23-c5267530d573', '53');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (113, 'f9d3db46-d340-4487-ae9b-82b827108912', '9');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (114, 'f9d3db46-d340-4487-ae9b-82b827108912', '46');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (115, 'f9d3db46-d340-4487-ae9b-82b827108912', '92');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (116, 'f9d3db46-d340-4487-ae9b-82b827108912', '93');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (117, 'f9d3db46-d340-4487-ae9b-82b827108912', '95');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (118, '2631d8a3-e5d8-4ef3-88c9-a8176fae110b', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (119, '2631d8a3-e5d8-4ef3-88c9-a8176fae110b', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (120, '2631d8a3-e5d8-4ef3-88c9-a8176fae110b', '92');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (121, '2631d8a3-e5d8-4ef3-88c9-a8176fae110b', '93');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (122, '2631d8a3-e5d8-4ef3-88c9-a8176fae110b', '95');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (123, '1240a2b8-f7ef-47c3-8048-2dd95d6d5b54', '2');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (124, '525d0b91-ca93-4d3d-8679-195aef136e0b', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (125, '525d0b91-ca93-4d3d-8679-195aef136e0b', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (126, 'a0dca246-563a-49c3-8a43-3c537ba1fb36', '2');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (127, '59a95d30-30d7-45bf-ac47-80afed002ade', '3');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (128, '21fc2518-3b2b-475a-8398-4b1d9f68cfdb', '6');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (129, '21fc2518-3b2b-475a-8398-4b1d9f68cfdb', '7');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (130, '59a95d30-30d7-45bf-ac47-80afed002ade', '4');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (131, '59a95d30-30d7-45bf-ac47-80afed002ade', '5');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (132, '59a95d30-30d7-45bf-ac47-80afed002ade', '6');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (133, '59a95d30-30d7-45bf-ac47-80afed002ade', '7');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (134, 'cb9320af-4ee6-4c11-8840-8ec4b9cc8276', '97');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (135, 'c95be861-6e0e-4404-9b21-5ccfcd94ee3f', '97');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (136, '21fc2518-3b2b-475a-8398-4b1d9f68cfdb', '3');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (137, '21fc2518-3b2b-475a-8398-4b1d9f68cfdb', '4');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (138, '21fc2518-3b2b-475a-8398-4b1d9f68cfdb', '5');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (139, '4cffcef8-be1e-44e0-8057-892e2cf588d5', '2');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (140, '4cffcef8-be1e-44e0-8057-892e2cf588d5', '56');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (141, '4cffcef8-be1e-44e0-8057-892e2cf588d5', '57');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (142, '4cffcef8-be1e-44e0-8057-892e2cf588d5', '58');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (143, '3e66d418-3e47-475b-a863-03a9653940ed', '96');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (144, 'c1b41cbc-1263-4d67-a7c6-cf064999c6f8', '3');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (145, 'c1b41cbc-1263-4d67-a7c6-cf064999c6f8', '4');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (146, 'c1b41cbc-1263-4d67-a7c6-cf064999c6f8', '5');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (147, 'c1b41cbc-1263-4d67-a7c6-cf064999c6f8', '6');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (148, '2c4de559-7182-44e7-9657-b97412f0f0a7', '3');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (149, '2c4de559-7182-44e7-9657-b97412f0f0a7', '4');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (150, '2c4de559-7182-44e7-9657-b97412f0f0a7', '5');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (151, '2c4de559-7182-44e7-9657-b97412f0f0a7', '6');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (152, '2c4de559-7182-44e7-9657-b97412f0f0a7', '7');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (153, '77eab07c-1e3c-4713-acf1-ed1bede0531d', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (154, '77eab07c-1e3c-4713-acf1-ed1bede0531d', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (155, 'f8badb51-4a56-48cc-993f-6eb6698ea0ea', '10');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (156, 'f8badb51-4a56-48cc-993f-6eb6698ea0ea', '13');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (157, '3e66d418-3e47-475b-a863-03a9653940ed', '53');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (158, '3e66d418-3e47-475b-a863-03a9653940ed', '55');
INSERT INTO rule_inspection_report_mapping(id, rule_id, report_id) VALUES (159, 'c1b41cbc-1263-4d67-a7c6-cf064999c6f8', '7');


INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (68, '17dbe1a1-e9e7-4513-aa07-597ae932ff73', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (69, '159e19e9-e956-4c52-92fc-c9746372e448', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (70, 'bfbf6be1-69f8-448e-9c23-c5267530d573', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (71, 'f9d3db46-d340-4487-ae9b-82b827108912', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (72, 'f9d3db46-d340-4487-ae9b-82b827108912', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (73, '2631d8a3-e5d8-4ef3-88c9-a8176fae110b', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (74, '1240a2b8-f7ef-47c3-8048-2dd95d6d5b54', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (75, '525d0b91-ca93-4d3d-8679-195aef136e0b', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (76, '525d0b91-ca93-4d3d-8679-195aef136e0b', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (77, 'c95be861-6e0e-4404-9b21-5ccfcd94ee3f', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (78, '21fc2518-3b2b-475a-8398-4b1d9f68cfdb', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (79, 'a0dca246-563a-49c3-8a43-3c537ba1fb36', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (80, '59a95d30-30d7-45bf-ac47-80afed002ade', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (81, '59a95d30-30d7-45bf-ac47-80afed002ade', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (82, 'cb9320af-4ee6-4c11-8840-8ec4b9cc8276', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (83, '3e66d418-3e47-475b-a863-03a9653940ed', @groupId3);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (84, 'c1b41cbc-1263-4d67-a7c6-cf064999c6f8', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (85, '4cffcef8-be1e-44e0-8057-892e2cf588d5', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (86, '4cffcef8-be1e-44e0-8057-892e2cf588d5', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (87, '3e66d418-3e47-475b-a863-03a9653940ed', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (88, '3e66d418-3e47-475b-a863-03a9653940ed', @groupId2);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (89, '68363ad8-cce8-4458-b8f1-9bd1d1af54a7', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (90, 'ca991f61-49a4-49b2-9d14-16ca338d8149', @groupId3);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (91, '2c4de559-7182-44e7-9657-b97412f0f0a7', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (92, '77eab07c-1e3c-4713-acf1-ed1bede0531d', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (93, '77eab07c-1e3c-4713-acf1-ed1bede0531d', @groupId3);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (94, 'f8badb51-4a56-48cc-993f-6eb6698ea0ea', @groupId1);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (95, 'f8badb51-4a56-48cc-993f-6eb6698ea0ea', @groupId3);
INSERT INTO rule_group_mapping(id, rule_id, group_id) VALUES (96, 'ca991f61-49a4-49b2-9d14-16ca338d8149', @groupId1);


INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('09c1be72-fdb4-40fe-9b5c-a3b4ea2d1c90', '159e19e9-e956-4c52-92fc-c9746372e448', 'tencent.cvm');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('118eab49-4ea8-4816-bea6-d97341f965ed', '4cffcef8-be1e-44e0-8057-892e2cf588d5', 'tencent.cdb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('18185324-959d-468a-be7e-2806bab40975', '525d0b91-ca93-4d3d-8679-195aef136e0b', 'tencent.clb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('1dc43bd3-1883-4434-9674-6a656ce59209', '17dbe1a1-e9e7-4513-aa07-597ae932ff73', 'tencent.cvm');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('24ea14f8-ff20-4c5c-bfb3-a084b8458ada', '21fc2518-3b2b-475a-8398-4b1d9f68cfdb', 'tencent.redis');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('3bcc71e3-4b4c-486d-ab2a-a6679266bd01', '2631d8a3-e5d8-4ef3-88c9-a8176fae110b', 'tencent.security-group');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('43aae92e-4101-4c86-8d0e-3ce4ec07bdb1', 'a0dca246-563a-49c3-8a43-3c537ba1fb36', 'tencent.clb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('4bc5b3c2-2675-4853-94e7-dec368dcdeac', '2c4de559-7182-44e7-9657-b97412f0f0a7', 'tencent.cdb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('4d7c26f9-d863-4c02-a02c-930997232fc8', '3e66d418-3e47-475b-a863-03a9653940ed', 'tencent.cos');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('7b29aea1-79bf-4f77-abd7-690ef1e30f38', '1240a2b8-f7ef-47c3-8048-2dd95d6d5b54', 'tencent.eip');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('7edd2575-f05d-4a85-be0d-8deb3e44f6f6', 'cb9320af-4ee6-4c11-8840-8ec4b9cc8276', 'tencent.cdb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('87b9b812-9c6b-41da-b404-5be6d965acd8', 'ca991f61-49a4-49b2-9d14-16ca338d8149', 'tencent.cos');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('91ff97f6-57d8-4e83-8563-39a35f76e237', '68363ad8-cce8-4458-b8f1-9bd1d1af54a7', 'tencent.cdb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('9dcf67f6-d058-492a-a52e-760a820bb021', 'f8badb51-4a56-48cc-993f-6eb6698ea0ea', 'tencent.cos');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('9f284a15-7817-45c1-b498-d2942e65dc11', 'f9d3db46-d340-4487-ae9b-82b827108912', 'tencent.security-group');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('a8e82bba-9dea-4643-ad38-416e9be93b01', 'c1b41cbc-1263-4d67-a7c6-cf064999c6f8', 'tencent.mongodb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('bab1733c-7113-4789-b0ed-3ca5ea7ae1a3', '59a95d30-30d7-45bf-ac47-80afed002ade', 'tencent.clb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('d223721e-c12b-4e8e-b02d-45ff2d385036', '77eab07c-1e3c-4713-acf1-ed1bede0531d', 'tencent.cos');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('defb6ac8-bcf2-4415-b5f5-b71b89332f70', 'c95be861-6e0e-4404-9b21-5ccfcd94ee3f', 'tencent.mongodb');
INSERT INTO rule_type(id, rule_id, resource_type) VALUES ('fc7e8e51-c441-41b7-90c2-ea2eecf0aae2', 'bfbf6be1-69f8-448e-9c23-c5267530d573', 'tencent.disk');




INSERT INTO plugin ( id, name, icon, update_time) VALUES ('hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '001'));

INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('AWS 等保预检', '等保合规检查（全称为等级保护合规检查）为您提供了全面覆盖通信网络、区域边界、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-aws-plugin', 1);
SELECT @groupId1 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('AWS CIS合规检查', 'CIS（Center for Internet Security）合规检查能力，为您动态且持续地监控您保有在云上的资源是否符合 CIS Control 网络安全架构要求。', '高风险', 'hummer-aws-plugin', 1);
SELECT @groupId2 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('AWS S3合规基线', 'S3 合规检查为您提供全方位的对象存储资源检查功能。', '高风险', 'hummer-aws-plugin', 1);
SELECT @groupId3 := LAST_INSERT_ID();

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('07eb95ef-6d78-4b9a-8555-a42b6a16de99', 'AWS ELB SSL 黑名单检测', 1, 'HighRisk', 'AWS 测您账号下 ELB SSL 黑名单检测，在白名单视为“合规”，黑名单视为“不合规”', 'policies:\n    # 测您账号下ELB SSL 黑名单检测，在白名单视为“合规”，黑名单视为“不合规”\n    - name: aws-elb-ssl-whitelist\n      resource: aws.elb\n      filters:\n        - type: ssl-policy\n          blacklist:\n            - Protocol-TLSv1\n            - Protocol-TLSv1.1\n            - Protocol-TLSv1.2', '[]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('0be7f5d4-766c-4b2b-910d-bec0f3aac977', 'AWS ELB 实例使用检测', 1, 'HighRisk', 'AWS 检测您账号下弹性负载均衡器是否使用，使用视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下弹性负载均衡器是否使用，使用视为“合规”，否则视为“不合规”\n    - name: aws-elb-unused\n      resource: aws.elb\n      filters:\n        - \"tag:maid_status\": absent\n        - Instances: []', '[]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('0dda84c1-794b-4977-bb66-6f12695c6c51', 'AWS RDS 实例公网访问检测', 1, 'HighRisk', 'AWS 检测您账号下 RDS 实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下RDS实例不允许任意来源公网访问，符合视为“合规”，否则视为“不合规”。\n    - name: aws-rds-publicly-accessible\n      resource: aws.rds\n      filters:\n        - PubliclyAccessible: ${{value}}', '[{\"key\":\"value\",\"name\":\"启用公网访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('35b5c651-5bd6-44b8-85ee-ae6adfa42dc3', 'AWS EIP 连接检测', 1, 'HighRisk', 'AWS 检测您账号下的弹性 IP 实例是否已连接，符合视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的弹性IP实例是否已连接，符合视为“合规”，否则视为“不合规”\n  - name: aws-unused-network-addr\n    resource: aws.network-addr\n    filters:\n      - NetworkInterfaceId: absent\n      - AssociationId: absent', '[]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', 'AWS SecurityGroup 高危安全组检测', 1, 'HighRisk', 'AWS 检测安全组是否开启风险端口，未开启视为“合规”，否则属于“不合规”', 'policies:\n  #检测开放以下高危端口的安全组：\n  #(20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500)\n  - name: aws-security-group\n    resource: aws.security-group\n    description: |\n      Add Filter all security groups, filter ports\n      [20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500]\n      on 0.0.0.0/0 or\n      [20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\n      on ::/0 (IPv6)\n    filters:\n        - or:\n            - type: ingress\n              Ports: ${{ipv4_port}}\n              Cidr: \"0.0.0.0/0\"\n            - type: ingress\n              Ports: ${{ipv6_port}}\n              CidrV6: \"::/0\"', '[{\"key\":\"ipv4_port\",\"name\":\"ipv4端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true},{\"key\":\"ipv6_port\",\"name\":\"ipv6端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('5c47228c-7fe1-484b-a5b6-7c1968074f69', 'AWS EC2 运行时间检测', 1, 'LowRisk', 'AWS 检测您账号下的 EC2 是否运行时间达到 n 天，没有达到视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的EC2是否运行时间达到n天，没有达到视为“合规”，否则视为“不合规”\n  - name: aws-ec2-old-instances\n    resource: aws.ec2\n    filters:\n      - "State.Name": running\n      - type: instance-age\n        days: ${{day}}', '[{\"key\":\"day\",\"name\":\"运行天数\",\"defaultValue\":\"90\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('a6c513a8-8e18-4341-94b7-b6588fdcd1f4', 'AWS RDS 实例加密检测', 1, 'HighRisk', 'AWS 检测您账号下 RDS 实例是否加密，加密视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下RDS实例是否加密，加密视为“合规”，否则视为“不合规”\n    - name: aws-rds-unencrypted\n      resource: aws.rds\n      filters:\n        - StorageEncrypted: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否加密\",\"defaultValue\":\"false\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('a90a1ba1-b392-4bf2-af31-20ecbefe5811', 'AWS EBS 加密检测', 1, 'HighRisk', 'AWS 检测您账号下的 EBS 是否加密，加密视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的EBS是否加密，加密视为“合规”，否则视为“不合规”\n  - name: aws-unencrypted-ebs\n    resource: aws.ebs\n    filters:\n      - Encrypted: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否加密\",\"defaultValue\":\"false\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('b1491f69-f3b8-40ae-9659-4242dbc30a0b', 'AWS RDS 实例是否使用检测', 1, 'HighRisk', 'AWS 检测您账号下 RDS 实例是否使用，使用视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下RDS实例是否使用，使用视为“合规”，否则视为“不合规”\n    - name: aws-rds-unused-databases\n      resource: aws.rds\n      filters:\n        - \"tag:c7n_rds_unused\": absent\n        - type: value\n          value_type: age\n          key: InstanceCreateTime\n          value: ${{day}}\n          op: greater-than', '[{\"key\":\"day\",\"name\":\"天（大于）\",\"defaultValue\":\"21\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('b57cbdba-b4d7-4da7-84db-25b9f2d5324b', 'AWS EC2 标签规范检测', 1, 'HighRisk', 'AWS 检测您账号下的 EC2 实例是否符合标签规范（非 ASG），符合视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的EC2实例是否符合标签规范（非ASG），符合视为“合规”，否则视为“不合规”\n  - name: aws-ec2-tag\n    resource: aws.ec2\n    comment: |\n      Find all (non-ASG) instances that are not conformant\n      to tagging policies.\n    filters:\n      - \"tag:aws:autoscaling:groupName\": absent\n      - \"tag:c7n_status\": absent\n      - or:\n          - \"tag:Owner\": ${{Owner}}\n          - \"tag:CostCenter\": ${{CostCenter}}\n          - \"tag:Project\": ${{Project}}', '[{\"key\":\"Owner\",\"name\":\"tag:Owner\",\"defaultValue\":\"absent\",\"required\":true},{\"key\":\"CostCenter\",\"name\":\"tag:CostCenter\",\"defaultValue\":\"absent\",\"required\":true},{\"key\":\"Project\",\"name\":\"tag:Project\",\"defaultValue\":\"absent\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('bd1a0479-ef54-4208-a520-50caf6acfe87', 'AWS EC2 实例关机状态检测', 1, 'HighRisk', 'AWS 检测您账号下的 EC2 实例是关机，开机视为“合规”，关机视为“不合规”', 'policies:\n  # 检测您账号下的EC2实例是关机，开机视为“合规”，关机视为“不合规”\n  - name: aws-ec2-mark-stopped-instance\n    resource: aws.ec2\n    filters:\n      - \"tag:c7n_stopped_instance\": absent\n      - \"State.Name\": ${{state}}', '[{\"key\":\"state\",\"name\":\"实例状态\",\"defaultValue\":\"stopped\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('befc89d7-1811-404a-9226-f8ecc22820e0', 'AWS EBS 连接检测', 1, 'HighRisk', 'AWS 检测您账号下的 EBS 是否连接，连接视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的EBS是否连接，连接视为“合规”，否则视为“不合规”\n  - name: aws-unattached-ebs\n    resource: aws.ebs\n    filters:\n      - Attachments: []\n      - \"tag:maid_status\": absent', '[]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('c30779c4-44b8-4c7b-b2ec-29ff3a96033b', 'AWS S3 全局访问检测', 1, 'HighRisk', 'AWS 检测您账号下的 S3 是否允许在其 ACL 中进行全局访问存储桶，不允许视为“合规”，否则视为“不合规”', 'policies:\n\n    - name: s3-global-access\n      resource: aws.s3\n      filters:\n        - type: global-grants', '[]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('d0f3f4b0-000a-4407-85ee-ed4a2f9dac44', 'AWS S3 公开读写访问权限检测', 1, 'HighRisk', 'AWS 查看您的 S3 存储桶是否不允许公开读写访问权限。如允许则该存储桶“不合规“', 'policies:\n    # 查看您的S3存储桶是否不允许公开读写访问权限。如允许则该存储桶“不合规“\n    - name: s3-public-acls\n      resource: aws.s3\n      filters:\n        - type: check-public-block\n          BlockPublicAcls: false\n          BlockPublicPolicy: false', '[]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('fa5e89e3-417d-4296-9d17-ca51ed914be5', 'AWS EC2 CPU 使用率检测', 1, 'LowRisk', 'AWS 检测您账号下的 EC2 是否 CPU 使用率在 x 天内低于 y，高于y视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的EC2是否CPU使用率在x天内低于y，高于y视为“合规”，否则视为“不合规”\n  - name: aws-ec2-underutilized\n    resource: aws.ec2\n    filters:\n      - type: metrics\n        name: CPUUtilization\n        days: ${{day}}\n        period: 86400  # 检测周期(86400s为一天)\n        statistics: Average\n        value: ${{used}}\n        op: less-than', '[{\"key\":\"day\",\"name\":\"n天(cpu平均值小于x)\",\"defaultValue\":\"7\",\"required\":true},{\"key\":\"used\",\"name\":\"cpu平均值小于x(n天)\",\"defaultValue\":\"30\",\"required\":true}]', 'hummer-aws-plugin', 'Amazon Web Services', 'aws.png', concat(unix_timestamp(now()), '004'), 1, 'custodian');


INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('fa5e89e3-417d-4296-9d17-ca51ed914be5', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('5c47228c-7fe1-484b-a5b6-7c1968074f69', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('befc89d7-1811-404a-9226-f8ecc22820e0', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('bd1a0479-ef54-4208-a520-50caf6acfe87', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('0be7f5d4-766c-4b2b-910d-bec0f3aac977', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('07eb95ef-6d78-4b9a-8555-a42b6a16de99', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('b1491f69-f3b8-40ae-9659-4242dbc30a0b', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('35b5c651-5bd6-44b8-85ee-ae6adfa42dc3', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('d0f3f4b0-000a-4407-85ee-ed4a2f9dac44', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('c30779c4-44b8-4c7b-b2ec-29ff3a96033b', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('a90a1ba1-b392-4bf2-af31-20ecbefe5811', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('b57cbdba-b4d7-4da7-84db-25b9f2d5324b', 'tagging');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('a6c513a8-8e18-4341-94b7-b6588fdcd1f4', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('0dda84c1-794b-4977-bb66-6f12695c6c51', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', 'safety');


INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('35b5c651-5bd6-44b8-85ee-ae6adfa42dc3', '2');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d0f3f4b0-000a-4407-85ee-ed4a2f9dac44', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d0f3f4b0-000a-4407-85ee-ed4a2f9dac44', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('c30779c4-44b8-4c7b-b2ec-29ff3a96033b', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('c30779c4-44b8-4c7b-b2ec-29ff3a96033b', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('a90a1ba1-b392-4bf2-af31-20ecbefe5811', '96');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('a6c513a8-8e18-4341-94b7-b6588fdcd1f4', '96');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('0dda84c1-794b-4977-bb66-6f12695c6c51', '97');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', '9');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', '46');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', '95');


INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('befc89d7-1811-404a-9226-f8ecc22820e0', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('07eb95ef-6d78-4b9a-8555-a42b6a16de99', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d0f3f4b0-000a-4407-85ee-ed4a2f9dac44', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('c30779c4-44b8-4c7b-b2ec-29ff3a96033b', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('a90a1ba1-b392-4bf2-af31-20ecbefe5811', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('a6c513a8-8e18-4341-94b7-b6588fdcd1f4', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('0dda84c1-794b-4977-bb66-6f12695c6c51', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('35b5c651-5bd6-44b8-85ee-ae6adfa42dc3', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('fa5e89e3-417d-4296-9d17-ca51ed914be5', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('5c47228c-7fe1-484b-a5b6-7c1968074f69', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('befc89d7-1811-404a-9226-f8ecc22820e0', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('bd1a0479-ef54-4208-a520-50caf6acfe87', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('0be7f5d4-766c-4b2b-910d-bec0f3aac977', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('07eb95ef-6d78-4b9a-8555-a42b6a16de99', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('b1491f69-f3b8-40ae-9659-4242dbc30a0b', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('a90a1ba1-b392-4bf2-af31-20ecbefe5811', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('b57cbdba-b4d7-4da7-84db-25b9f2d5324b', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('43a1556b-5417-4efb-88fc-33e8eeb68f71', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d0f3f4b0-000a-4407-85ee-ed4a2f9dac44', @groupId3);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('c30779c4-44b8-4c7b-b2ec-29ff3a96033b', @groupId3);

SELECT id INTO @groupIdAli FROM rule_group WHERE name = 'Aliyun 等保预检';
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('083d24e2-881f-488b-b120-8f2cd961707f', @groupIdAli);
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('083d24e2-881f-488b-b120-8f2cd961707f', '083d24e2-881f-488b-b120-8f2cd961707f', 'aliyun.security-group');

INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('02971259-93f0-4cbe-921b-e9c589ca3543', '0dda84c1-794b-4977-bb66-6f12695c6c51', 'aws.rds');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('04de48af-246a-43eb-8e14-841fbe1f15a9', 'fa5e89e3-417d-4296-9d17-ca51ed914be5', 'aws.ec2');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('1141ed89-25e0-48bd-aaf6-97cc5acb1dbd', 'bd1a0479-ef54-4208-a520-50caf6acfe87', 'aws.ec2');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('38a515ae-1b16-4bd2-a2d6-4702019cbd00', '35b5c651-5bd6-44b8-85ee-ae6adfa42dc3', 'aws.network-addr');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('441f8d7b-bf9a-4382-90fb-d5112e92fd0f', 'd0f3f4b0-000a-4407-85ee-ed4a2f9dac44', 'aws.s3');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('585aee63-8f15-4223-b8bb-9e3aa0536ccd', 'befc89d7-1811-404a-9226-f8ecc22820e0', 'aws.ebs');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('73d2ce15-9807-40c9-9041-ee676a659957', 'b57cbdba-b4d7-4da7-84db-25b9f2d5324b', 'aws.ec2');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('83d17018-bec2-4ac5-adb1-3e2f49a8a6dc', 'b1491f69-f3b8-40ae-9659-4242dbc30a0b', 'aws.rds');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('92939df9-ff43-498f-ad2d-11203266d7bd', 'a90a1ba1-b392-4bf2-af31-20ecbefe5811', 'aws.ebs');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('adda0759-00ee-4448-836d-96d4d495fa16', '07eb95ef-6d78-4b9a-8555-a42b6a16de99', 'aws.elb');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('ce6f382c-9836-4afa-9bcf-e9b64931b5e0', '5c47228c-7fe1-484b-a5b6-7c1968074f69', 'aws.ec2');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('d5a21004-1674-4bec-9e16-7d877249b453', 'c30779c4-44b8-4c7b-b2ec-29ff3a96033b', 'aws.s3');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('d70cdd13-9c90-47ca-977f-de95af872d01', '43a1556b-5417-4efb-88fc-33e8eeb68f71', 'aws.security-group');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('dc3f8693-c389-490a-847e-fedffefa445f', '0be7f5d4-766c-4b2b-910d-bec0f3aac977', 'aws.elb');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('eae5f805-9e45-44a6-a1dd-f3255da685ca', 'a6c513a8-8e18-4341-94b7-b6588fdcd1f4', 'aws.rds');




INSERT INTO plugin ( id, name, icon, update_time) VALUES ('hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '001'));

INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Azure 等保预检', '等保合规检查（全称为等级保护合规检查）为您提供了全面覆盖通信网络、区域边界、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-azure-plugin', 1);
SELECT @groupId1 := LAST_INSERT_ID();
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Azure CIS合规检查', 'CIS（Center for Internet Security）合规检查能力，为您动态且持续地监控您保有在云上的资源是否符合 CIS Control 网络安全架构要求。', '高风险', 'hummer-azure-plugin', 1);
SELECT @groupId2 := LAST_INSERT_ID();

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('29ee6650-3e4f-44e3-aadd-0ae15618afa9', 'Azure 公网 IP 地址 DDoS 攻击检测', 1, 'MediumRisk', 'Azure 检测您账号下的公网 IP 地址是否受到 DDoS 攻击，没有受到 DDoS 攻击视为“合规”，否则视为“不合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的公网IP地址是否受到DDoS攻击，没有受到DDoS攻击视为“合规”，否则视为“不合规”\n  - name: azure-publicip-dropping-packets\n    resource: azure.publicip\n    filters:\n      - type: metric\n        metric: IfUnderDDoSAttack\n        op: gt\n        aggregation: maximum\n        threshold: 0\n        timeframe: ${{timeframe}}', '[{\"key\":\"timeframe\",\"name\":\"小时(h)\",\"defaultValue\":\"72\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('3e324555-83e2-4ac9-8ac2-1dae350d52ff', 'Azure 网络安全组检测', 1, 'MediumRisk', 'Azure 检测您账号下的网络安全组是否打开了某些端口、关闭了某些端口，符合视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的网络安全组是否打开了某些端口、关闭了某些端口，符合视为“合规”，否则视为“不合规”\n  - name: azure-close-egress-except-TCP\n    resource: azure.networksecuritygroup\n    filters:\n     - type: ingress\n       ports: ${{allow_port}}\n       access: \'Allow\'\n     - type: ingress\n       ports: ${{deny_port}}\n       access: \'Deny\'', '[{\"key\":\"allow_port\",\"name\":\"打开了的端口\",\"defaultValue\":\"\'80\'\",\"required\":true},{\"key\":\"deny_port\",\"name\":\"关闭了的端口\",\"defaultValue\":\"\'443-3306\'\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('4852857f-b454-4375-b405-0033fed73f09', 'Azure VM 虚拟机公网 IP 检测', 1, 'HighRisk', 'Azure 检测您账号下的VM是否开放公网 IP，不开放视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的VM是否开放公网IP，不开放视为“合规”，否则视为“不合规”\n  - name: azure-vms-with-public-ip\n    resource: azure.vm\n    filters:\n     - type: network-interface\n       key: \'properties.ipConfigurations[].properties.publicIPAddress.id\'\n       value: ${{value}}', '[{\"key\":\"value\",\"name\":\"开放公网IP\",\"defaultValue\":\"not-null\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('5870d5df-7674-4f40-ae06-0408c935acd6', 'Azure SQL 数据库保留策略检测', 1, 'MediumRisk', 'Azure 检测您的账户下 SQL 数据库短期保留至少n天，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您的账户下SQL数据库短期保留至少n天，符合视为“合规”，否则视为“不合规”\n    - name: azure-short-term-backup-retention-policy\n      resource: azure.sqldatabase\n      filters:\n        - type: short-term-backup-retention\n          op: lt\n          retention-period-days: ${{value}}', '[{\"key\":\"value\",\"name\":\"SQL数据库短期保留至少n天\",\"defaultValue\":\"7\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('618a61bb-eecc-4109-b387-4a313f10c1a9', 'Azure LoadBalancer 负载均衡器检测', 1, 'HighRisk', 'Azure 检测您账号下的负载均衡器是否开放了公网 IP，未开放视为“合规”，否则视为“不合规”', 'policies:\n   # 检测您账号下的负载均衡器是否开放了公网IP，未开放视为“合规”，否则视为“不合规”\n   - name: azure-loadbalancer-with-ipv6-frontend\n     resource: azure.loadbalancer\n     filters:\n        - type: frontend-public-ip\n          key: properties.publicIPAddressVersion\n          op: in\n          value_type: normalize\n          value: \"ipv6\"', '[]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6873838e-3a47-4255-b49e-af5fbf5cb454', 'Azure App Services CORS 配置检测', 1, 'MediumRisk', 'Azure 检测您的账户下 App Services 是否所有跨源资源共享（CORS）配置设置为允许所有来源的应用程序服务（Web应用程序和功能），符合视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您的账户下App Services是否所有跨源资源共享（CORS）配置设置为允许所有来源的应用程序服务（Web应用程序和功能），符合视为“合规”，否则视为“不合规”\n  - name: azure-app-service-cors-policy\n    resource: azure.webapp\n    filters:\n      - type: configuration\n        key: cors.allowedOrigins\n        value: ${{value}}\n        op: contains', '[{\"key\":\"value\",\"name\":\"允许所有来源\",\"defaultValue\":\"\'*\'\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6967e834-ace6-48d2-9f95-f541b614810d', 'Azure VM 虚拟机使用率检测', 1, 'LowRisk', 'Azure 检测您账号下的虚拟机是否 x 小时内 CPU 使用率<= y％，使用率> y％符合视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的虚拟机是否x小时内CPU使用率<= y％，使用率> y％符合视为“合规”，否则视为“不合规”\n  - name: azure-unused-vms\n    resource: azure.vm\n    filters:\n      - type: metric\n        metric: Percentage CPU\n        op: le\n        aggregation: average\n        threshold: ${{threshold}}\n        timeframe: ${{timeframe}}', '[{\"key\":\"threshold\",\"name\":\"使用率(%)\",\"defaultValue\":\"1\",\"required\":true},{\"key\":\"timeframe\",\"name\":\"小时(h)\",\"defaultValue\":\"72\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6a71a114-ba92-4e0b-bd9d-2f6c8ecee88d', 'Azure 资源组检测', 1, 'LowRisk', 'Azure 检测您的账户下资源组是否是空的，非空视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您的账户下资源组是否是空的，非空视为“合规”，否则视为“不合规”\n    - name: azure-rg-empty\n      resource: azure.resourcegroup\n      filters:\n        - type: empty-group', '[]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('77ac25d5-0a66-4890-aa7e-5b276fce299a', 'Azure 存储公网访问检测', 1, 'HighRisk', 'Azure 检测您的账户下存储是否具有指定ip规则的存储帐户的访问(公共访问)，符合视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您的账户下存储是否具有指定ip规则的存储帐户的访问，符合视为“合规”，否则视为“不合规”\n  - name: azure-storage-block-public-access\n    resource: azure.storage\n    filters:\n    - type: value\n      key: properties.networkAcls.ipRules\n      value_type: size\n      op: ne\n      value: 0', '[]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('802fbf6c-92ac-4153-bea3-42b7720d8124', 'Azure VM 虚拟机状态检测', 1, 'LowRisk', 'Azure 检测您账号下的 VM 是否停止运行，运行视为“合规”，否则视为“不合规”', 'policies:\n  #  检测您账号下的VM是否停止运行，运行视为“合规”，否则视为“不合规”\n  - name: azure-stopped-vm\n    resource: azure.vm\n    filters:\n     - type: instance-view\n       key: statuses[].code\n       op: not-in\n       value_type: swap\n       value: ${{value}}', '[{\"key\":\"value\",\"name\":\"运行状态\",\"defaultValue\":\"\\\"PowerState/running\\\"\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('94d168d0-8e62-4173-96fd-326eb267273e', 'Azure Disk 关联虚拟机检测', 1, 'LowRisk', 'Azure 检测您账号下的 Disk 是否关联虚拟机，关联视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的Disk是否关联虚拟机，关联视为“合规”，否则视为“不合规”\n  - name: azure-orphaned-disk\n    resource: azure.disk\n    filters:\n      - type: value\n        key: managedBy\n        value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否关联虚拟机\",\"defaultValue\":\"null\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('c3259122-ac07-4256-83da-b6361c9d3abb', 'Azure SQL Server 使用率检测', 1, 'LowRisk', 'Azure 检测您账号下的 SQL Server 是否 x 小时内平均 DTU 消耗少于 y％，多于 y％ 符合视为“合规”，否则视为“不合规”', 'policies:\n  # 检测您账号下的SQL Server是否x小时内平均DTU消耗少于y％，多于y％符合视为“合规”，否则视为“不合规”\n  - name: azure-dtu-consumption\n    resource: azure.sqlserver\n    filters:\n      - type: metric\n        metric: dtu_consumption_percent\n        aggregation: average\n        op: lt\n        threshold: ${{threshold}}\n        timeframe: ${{timeframe}}\n        filter:  \"DatabaseResourceId eq \'*\'\"', '[{\"key\":\"threshold\",\"name\":\"使用率(%)\",\"defaultValue\":\"10\",\"required\":true},{\"key\":\"timeframe\",\"name\":\"小时(h)\",\"defaultValue\":\"24\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('dd11251a-7fd4-499c-857b-c7dcf4c98958', 'Azure Cosmos DB 检测', 1, 'HighRisk', 'Azure 检测所有 Cosmos DB 帐户没有配置防火墙，或者配置了允许超出预期范围访问的帐户，符合视为“合规”，否则视为“不合规”', 'policies:\n # 检测所有Cosmos DB帐户没有配置防火墙，或者配置了允许超出预期范围访问的帐户，符合视为“合规”，否则视为“不合规”\n - name: azure-cosmos-firewall-enable\n   resource: azure.cosmosdb\n   filters:\n     - or:\n       - type: value\n         key: properties.ipRangeFilter\n         value: empty  # The firewall is disabled\n\n       - not:\n         - type: firewall-rules\n           only:       # Should *only* allow access within the specified maximums here\n             - ${{value1}}\n             - ${{value2}}\n             - ${{value3}}', '[{\"key\":\"value1\",\"name\":\"过滤规则1\",\"defaultValue\":\"19.0.0.0/16\",\"required\":true},{\"key\":\"value2\",\"name\":\"过滤规则2\",\"defaultValue\":\"20.0.1.2\",\"required\":true},{\"key\":\"value3\",\"name\":\"过滤规则3\",\"defaultValue\":\"ServiceTags.AzureCloud\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f6c72297-33db-49dd-a106-06cf2ff47069', 'Azure 网络接口连接检测', 1, 'LowRisk', 'Azure 检测您账号下的网络接口是否连接到 VM，连接视为“合规”，否则视为“不合规”', 'policies:\n  # Azure 检测您账号下的网络接口是否连接到VM，连接视为“合规”，否则视为“不合规”\n  - name: orphaned-nic\n    resource: azure.networkinterface\n    filters:\n      - type: value\n        key: properties.virtualMachine\n        value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否连接到VM\",\"defaultValue\":\"null\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f7c03491-fc0a-4ae7-87ed-6423748b2372', 'Azure 存储账户检测', 1, 'HighRisk', 'Azure 检测所有防火墙都配置为仅允许从数据中心（或 IP 空间的任何块）中的 IP 地址进行访问，符合视为“合规”，否则视为“不合规”', 'policies:\n  # 检测所有防火墙都配置为仅允许从数据中心（或IP空间的任何块）中的IP地址进行访问，符合视为“合规”，否则视为“不合规”\n  - name: azure-storage-only-allow-datacenter-ips\n    resource: azure.storage\n    filters:\n      - or:\n        - type: value\n          key: properties.networkAcls.defaultAction\n          value: \'Allow\'\n\n        - not:\n          - type: firewall-rules\n            only:\n              - ${{value1}}\n              - ${{value2}}\n              - ${{value3}}', '[{\"key\":\"value1\",\"name\":\"过滤规则1\",\"defaultValue\":\"\'8.8.8.8\'\",\"required\":true},{\"key\":\"value2\",\"name\":\"过滤规则2\",\"defaultValue\":\"\'10.0.0.0/16\'\",\"required\":true},{\"key\":\"value3\",\"name\":\"过滤规则3\",\"defaultValue\":\"\'20.0.0.0 - 20.10.0.0\'\",\"required\":true}]', 'hummer-azure-plugin', 'Microsoft Azure', 'azure.png', concat(unix_timestamp(now()), '005'), 1, 'custodian');


INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('c3259122-ac07-4256-83da-b6361c9d3abb', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6967e834-ace6-48d2-9f95-f541b614810d', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('29ee6650-3e4f-44e3-aadd-0ae15618afa9', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f6c72297-33db-49dd-a106-06cf2ff47069', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('802fbf6c-92ac-4153-bea3-42b7720d8124', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f7c03491-fc0a-4ae7-87ed-6423748b2372', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('5870d5df-7674-4f40-ae06-0408c935acd6', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6a71a114-ba92-4e0b-bd9d-2f6c8ecee88d', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6873838e-3a47-4255-b49e-af5fbf5cb454', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('77ac25d5-0a66-4890-aa7e-5b276fce299a', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('dd11251a-7fd4-499c-857b-c7dcf4c98958', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('618a61bb-eecc-4109-b387-4a313f10c1a9', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('3e324555-83e2-4ac9-8ac2-1dae350d52ff', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('94d168d0-8e62-4173-96fd-326eb267273e', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('4852857f-b454-4375-b405-0033fed73f09', 'safety');


INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('29ee6650-3e4f-44e3-aadd-0ae15618afa9', '18');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('29ee6650-3e4f-44e3-aadd-0ae15618afa9', '21');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('802fbf6c-92ac-4153-bea3-42b7720d8124', '71');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f7c03491-fc0a-4ae7-87ed-6423748b2372', '11');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('5870d5df-7674-4f40-ae06-0408c935acd6', '72');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('6873838e-3a47-4255-b49e-af5fbf5cb454', '17');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('77ac25d5-0a66-4890-aa7e-5b276fce299a', '11');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('dd11251a-7fd4-499c-857b-c7dcf4c98958', '11');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('618a61bb-eecc-4109-b387-4a313f10c1a9', '11');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4852857f-b454-4375-b405-0033fed73f09', '11');


INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('c3259122-ac07-4256-83da-b6361c9d3abb', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6967e834-ace6-48d2-9f95-f541b614810d', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('29ee6650-3e4f-44e3-aadd-0ae15618afa9', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f6c72297-33db-49dd-a106-06cf2ff47069', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('802fbf6c-92ac-4153-bea3-42b7720d8124', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f7c03491-fc0a-4ae7-87ed-6423748b2372', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f7c03491-fc0a-4ae7-87ed-6423748b2372', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('5870d5df-7674-4f40-ae06-0408c935acd6', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('5870d5df-7674-4f40-ae06-0408c935acd6', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6a71a114-ba92-4e0b-bd9d-2f6c8ecee88d', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6a71a114-ba92-4e0b-bd9d-2f6c8ecee88d', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6873838e-3a47-4255-b49e-af5fbf5cb454', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6873838e-3a47-4255-b49e-af5fbf5cb454', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('77ac25d5-0a66-4890-aa7e-5b276fce299a', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('77ac25d5-0a66-4890-aa7e-5b276fce299a', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('dd11251a-7fd4-499c-857b-c7dcf4c98958', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('dd11251a-7fd4-499c-857b-c7dcf4c98958', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('618a61bb-eecc-4109-b387-4a313f10c1a9', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('618a61bb-eecc-4109-b387-4a313f10c1a9', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('3e324555-83e2-4ac9-8ac2-1dae350d52ff', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('94d168d0-8e62-4173-96fd-326eb267273e', @groupId2);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('4852857f-b454-4375-b405-0033fed73f09', @groupId1);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('4852857f-b454-4375-b405-0033fed73f09', @groupId2);


INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('0ff7213c-e03e-4e57-a956-3705h2r590b7', 'dd11251a-7fd4-499c-857b-c7dcf4c98958', 'azure.cosmosdb');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('120e4527-62d6-4230-bf39-a2bfb4477e76', '6873838e-3a47-4255-b49e-af5fbf5cb454', 'azure.webapp');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('1a9d11c2-954b-42ad-86ac-6774e12b7a4c', '618a61bb-eecc-4109-b387-4a313f10c1a9', 'azure.loadbalancer');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('252006fe-6c8e-4437-916f-59f0e2854322', '5870d5df-7674-4f40-ae06-0408c935acd6', 'azure.sqldatabase');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('3e4cbcbc-c42a-4aa5-a14c-f3c9de67cd25', '6967e834-ace6-48d2-9f95-f541b614810d', 'azure.vm');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('51f59bf0-14ff-453a-bd29-888a64828c97', '29ee6650-3e4f-44e3-aadd-0ae15618afa9', 'azure.publicip');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('5794ca74-c608-4ef9-867c-4d4655636a54', 'c3259122-ac07-4256-83da-b6361c9d3abb', 'azure.sqlserver');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('59ae9387-960c-41d3-9c47-37593a9c6ece', '3e324555-83e2-4ac9-8ac2-1dae350d52ff', 'azure.networksecuritygroup');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('677dc944-7765-4dc7-8d67-8ca7c1bf3b18', '4852857f-b454-4375-b405-0033fed73f09', 'azure.vm');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('84c31442-236a-4686-ae24-95bh2r2da213', '77ac25d5-0a66-4890-aa7e-5b276fce299a', 'azure.storage');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('899070fd-2e1a-4ef3-978c-6e3ddb359b00', '802fbf6c-92ac-4153-bea3-42b7720d8124', 'azure.vm');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('90a6fc28-6e83-459e-8973-07019bf5b002', '6a71a114-ba92-4e0b-bd9d-2f6c8ecee88d', 'azure.resourcegroup');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('96183764-d245-48b1-83b8-6b124eba69e6', '94d168d0-8e62-4173-96fd-326eb267273e', 'azure.disk');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('b2cd7117-3a40-4035-8106-bb4cfa9eeb30', 'f7c03491-fc0a-4ae7-87ed-6423748b2372', 'azure.storage');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('dff7a4d6-4400-46b1-b884-6d6766ff4ecf', 'f6c72297-33db-49dd-a106-06cf2ff47069', 'azure.networkinterface');



INSERT INTO plugin ( id, name, icon, update_time) VALUES ('hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'));

INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('OpenStack 安全检查', '安全检查，为您提供通信网络、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-openstack-plugin', 1);

SELECT @groupId := LAST_INSERT_ID();

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('1aab5692-85a5-4151-b67c-8c2c93353916', 'OpenStack 用户项目检测', 1, 'LowRisk', 'OpenStack 检测用户是否绑定主项目，已绑定视为“合规”，否则属于“不合规”', 'policies:\n    # 检测用户是否绑定主项目，已绑定视为“合规”，否则属于“不合规”\n    - name: openstack-filter-user-project\n      resource: openstack.user\n      filters:\n        - type: project\n          default_project_id: ${{default_project_id}}', '[{\"key\":\"default_project_id\",\"name\":\"项目ID\",\"defaultValue\":\"\'\'\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('311daee9-3c15-4b19-8fb7-97823c57eb23', 'OpenStack 模板类型检测', 1, 'MediumRisk', 'OpenStack 检测模板实例类型是否为公有，并且内存/CPU/磁盘大于指定最低值，符合条件视为“合规”，否则属于“不合规”', 'policies:\n    # 检测模板实例类型是否为公有，并且内存/CPU/磁盘大于指定最低值，符合条件视为“合规”，否则属于“不合规”\n    - name: openstack-flavor\n      resource: openstack.flavor\n      filters:\n        - type: system\n          is_public: ${{is_public}}\n          ram: ${{ram}}\n          vcpus: ${{vcpus}}\n          disk: ${{disk}}', '[{\"key\":\"is_public\",\"name\":\"是否为公有\",\"defaultValue\":\"true\",\"required\":true},{\"key\":\"ram\",\"name\":\"内存大小\",\"defaultValue\":\"512\",\"required\":true},{\"key\":\"vcpus\",\"name\":\"CPU\",\"defaultValue\":\"1\",\"required\":true},{\"key\":\"disk\",\"name\":\"磁盘大小\",\"defaultValue\":\"1\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('5673475f-c43d-432c-a6a6-f29479493b4d', 'OpenStack 卷加密检测', 1, 'HighRisk', 'OpenStack 检测卷是否加密，加密视为“合规”，否则属于“不合规”', 'policies:\n    # 检测卷是否加密，加密视为“合规”，否则属于“不合规”\n    - name: openstack-volume\n      resource: openstack.volume\n      filters:\n        - type: status\n          is_encrypted: ${{is_encrypted}}', '[{\"key\":\"is_encrypted\",\"name\":\"是否加密\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('5c4d5e15-ce0a-4322-8406-47e8bcb10bf4', 'OpenStack 实例时间检测', 1, 'LowRisk', 'OpenStack 检测实例运行时间是否大于 n 天，小于 n 天视为“合规”，否则属于“不合规”', 'policies:\n    # 检测实例运行时间是否大于n天，小于n天视为“合规”，否则属于“不合规”\n    - name: openstack-server-age\n      resource: openstack.server\n      filters:\n        - type: age\n          op: ${{op}}\n          days: ${{days}}', '[{\"key\":\"days\",\"name\":\"天\",\"defaultValue\":\"90\",\"required\":true},{\"key\":\"op\",\"name\":\"大于(小于lt)\",\"defaultValue\":\"gt\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('5f6c1aed-8c46-48e6-b48d-2cf06568831f', 'OpenStack 用户角色检测', 1, 'LowRisk', 'OpenStack 检测项目中的用户是否为管理员角色，非管理员角色视为“合规”，否则属于“不合规”', 'policies:\n    # 检测项目中的用户是否为管理员角色，非管理员角色视为“合规”，否则属于“不合规”\n    - name: openstack-filter-user-role\n      resource: openstack.user\n      filters:\n        - type: role\n          role_name: admin\n          project_name: ${{project_name}}\n          system_scope: ${{system_scope}}', '[{\"key\":\"project_name\",\"name\":\"项目名称\",\"defaultValue\":\"admin\",\"required\":true},{\"key\":\"system_scope\",\"name\":\"是否\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6359bdcd-0d1d-4e43-817c-cc338f07a065', 'OpenStack 实例镜像检测', 1, 'LowRisk', 'OpenStack 检测镜像是否属于私有并运行状态的实例，符合条件视为“合规”，否则属于“不合规”', 'policies:\n    # 检测镜像是否属于私有并运行状态的实例，符合条件视为“合规”，否则属于“不合规”\n    - name: openstack-server-image\n      resource: openstack.server\n      filters:\n        - not:\n          - type: image\n            #image_name: centos\n            visibility: ${{visibility}}\n            status: ${{status}}', '[{\"key\":\"visibility\",\"name\":\"可见性\",\"defaultValue\":\"private\",\"required\":true},{\"key\":\"status\",\"name\":\"运行状态\",\"defaultValue\":\"active\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('63dedb65-0237-4402-8a5c-1d2137840fdd', 'OpenStack 路由状态检测', 1, 'LowRisk', 'OpenStack 检测路由状态与高可用状态，符合条件视为“合规”，否则属于“不合规”', 'policies:\n    # 检测路由状态与高可用状态，符合条件视为“合规”，否则属于“不合规”\n    - name: openstack-router\n      resource: openstack.router\n      filters:\n        - not:\n          - type: system\n            status: ${{status}}\n            ha: ${{ha}}', '[{\"key\":\"status\",\"name\":\"网络状态\",\"defaultValue\":\"ACTIVE\",\"required\":true},{\"key\":\"ha\",\"name\":\"是否为高可用\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6bbd42bc-a251-498a-8b19-8de8c55e32aa', 'OpenStack 卷状态检测', 1, 'LowRisk', 'OpenStack 检测卷是否关联实例，关联视为“合规”，否则属于“不合规”', 'policies:\n    # 检测卷是否关联实例，关联视为“合规”，否则属于“不合规”\n    - name: openstack-volume\n      resource: openstack.volume\n      filters:\n        - type: status\n          volume_status: ${{volume_status}}\n          system_scope: ${{system_scope}}', '[{\"key\":\"volume_status\",\"name\":\"卷状态\",\"defaultValue\":\"\'in-use\'\",\"required\":true},{\"key\":\"system_scope\",\"name\":\"是否关联实例\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('701ae534-4c13-45a2-8a72-e78afdea4d2b', 'OpenStack SecurityGroups 高危安全组检测', 1, 'HighRisk', 'Openstack 检测安全组是否开启风险端口，未开启视为“合规”，否则属于“不合规”', 'policies:\n  # 检测开放以下高危端口的安全组：\n  #(20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500)\n  - name: openstack-security-groups\n    resource: openstack.security-groups\n    description: |\n      Add Filter all security groups, filter ports\n      [20,21,22,25,80,773,765,1733,1737,3306,3389,7333,5732,5500]\n      on 0.0.0.0/0 or\n      [20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\n      on ::/0 (IPv6)\n    filters:\n        - or:\n            - type: ingress\n              IpProtocol: \"-1\"\n              Ports: ${{ipv4_port}}\n              Cidr: \"0.0.0.0/0\"\n            - type: ingress\n              IpProtocol: \"-1\"\n              Ports: ${{ipv6_port}}\n              CidrV6: \"::/0\"', '[{\"key\":\"ipv4_port\",\"name\":\"ipv4端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true},{\"key\":\"ipv6_port\",\"name\":\"ipv6端口\",\"defaultValue\":\"[20,21,22,25,80,773,765, 1733,1737,3306,3389,7333,5732,5500]\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('ab3306d0-e734-4977-a462-42de0e1cf263', 'OpenStack 实例标签检测', 1, 'LowRisk', 'OpenStack 检测实例标签是否属于默认值，属于视为“合规”，否则属于“不合规”', 'policies:\n    # 检测实例标签是否属于默认值，属于视为“合规”，否则属于“不合规”\n    - name: openstack-server-tags\n      resource: openstack.server\n      filters:\n        - type: tags\n          tags:\n          - key: ${{key1}}\n            value: ${{value1}}\n          - key: ${{key2}}\n            value: ${{value2}}\n          op: any', '[{\"key\":\"key1\",\"name\":\"key1\",\"defaultValue\":\"absent\",\"required\":true},{\"key\":\"value1\",\"name\":\"value1\",\"defaultValue\":\"absent\",\"required\":true},{\"key\":\"key2\",\"name\":\"key2\",\"defaultValue\":\"absent\",\"required\":true},{\"key\":\"value2\",\"name\":\"value2\",\"defaultValue\":\"absent\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('b8e09c5a-fecc-4400-b831-d7f75f9cee01', 'OpenStack 网络状态检测', 1, 'LowRisk', 'OpenStack 检测网络状态与共享状态，符合条件视为“合规”，否则属于“不合规”', 'policies:\n    # 检测网络状态与共享状态，符合条件视为“合规”，否则属于“不合规”\n    - name: openstack-network\n      resource: openstack.network\n      filters:\n        - not:\n          - type: system\n            status: ${{status}}\n            shared: ${{shared}}\n            port_security_enabled: ${{port_security_enabled}}', '[{\"key\":\"status\",\"name\":\"网络状态\",\"defaultValue\":\"ACTIVE\",\"required\":true},{\"key\":\"shared\",\"name\":\"共享状态\",\"defaultValue\":\"false\",\"required\":true},{\"key\":\"port_security_enabled\",\"name\":\"端口安全是否开启\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('bf9a87c9-f709-4f84-8a86-5afde3eb40c3', 'OpenStack 项目成员检测', 1, 'LowRisk', 'OpenStack 检测项目是否分配成员，已分配视为“合规”，否则属于“不合规”', 'policies:\n    # 检测项目是否分配成员，已分配视为“合规”，否则属于“不合规”\n    - name: openstack-project-user\n      resource: openstack.project\n      filters:\n        - type: user\n          system_scope: ${{system_scope}}', '[{\"key\":\"system_scope\",\"name\":\"是否包含项目成员\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('c9162947-90f2-41c9-8df8-2d2244bb6f1d', 'OpenStack SecurityGroups 安全组配置检测', 1, 'HighRisk', 'Openstack 账号下安全组配置不为“0.0.0.0/0”，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 账号下安全组配置不为“0.0.0.0/0”，符合视为“合规”，否则视为“不合规”\n    - name: openstack-sg-source-cidr-ip\n      resource: openstack.security-groups\n      filters:\n        - type: source-cidr-ip\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"目标IP地址段\",\"defaultValue\":\"\\\"0.0.0.0/0\\\"\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('ccf64ae6-7f99-40fe-b45f-d86a4b63bdcc', 'OpenStack 实例类型检测', 1, 'LowRisk', 'OpenStack 检测实例的模板类型是否为公有，并且内存/CPU/磁盘大于指定最低值，符合条件视为“合规”，否则属于“不合规”', 'policies:\n    # 检测实例的模板类型是否为公有，并且内存/CPU/磁盘大于指定最低值，符合条件视为“合规”，否则属于“不合规”\n    - name: openstack-server-flavor\n      resource: openstack.server\n      filters:\n        - type: flavor\n          is_public: ${{is_public}}\n          ram: ${{ram}}\n          vcpus: ${{vcpus}}\n          disk: ${{disk}}', '[{\"key\":\"is_public\",\"name\":\"是否为公有\",\"defaultValue\":\"true\",\"required\":true},{\"key\":\"ram\",\"name\":\"内存大小\",\"defaultValue\":\"512\",\"required\":true},{\"key\":\"vcpus\",\"name\":\"CPU\",\"defaultValue\":\"1\",\"required\":true},{\"key\":\"disk\",\"name\":\"磁盘大小\",\"defaultValue\":\"1\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f7b906de-63e0-479b-b766-2e50df8fbe19', 'OpenStack 镜像状态检测', 1, 'LowRisk', 'OpenStack 检测镜像是否属于私有并运行状态，符合条件视为“合规”，否则属于“不合规”', 'policies:\n    # 检测镜像是否属于私有并运行状态，符合条件视为“合规”，否则属于“不合规”\n    - name: openstack-image\n      resource: openstack.image\n      filters:\n        - not:\n          - type: status\n            #image_name: centos\n            visibility: ${{visibility}}\n            status: ${{status}}', '[{\"key\":\"visibility\",\"name\":\"可见性\",\"defaultValue\":\"private\",\"required\":true},{\"key\":\"status\",\"name\":\"运行状态\",\"defaultValue\":\"active\",\"required\":true}]', 'hummer-openstack-plugin', 'OpenStack', 'openstack.png', concat(unix_timestamp(now()), '006'), 1, 'custodian');


INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('5f6c1aed-8c46-48e6-b48d-2cf06568831f', 'tagging');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('1aab5692-85a5-4151-b67c-8c2c93353916', 'tagging');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('bf9a87c9-f709-4f84-8a86-5afde3eb40c3', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6bbd42bc-a251-498a-8b19-8de8c55e32aa', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('5673475f-c43d-432c-a6a6-f29479493b4d', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f7b906de-63e0-479b-b766-2e50df8fbe19', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6359bdcd-0d1d-4e43-817c-cc338f07a065', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('5c4d5e15-ce0a-4322-8406-47e8bcb10bf4', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('ab3306d0-e734-4977-a462-42de0e1cf263', 'tagging');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('ccf64ae6-7f99-40fe-b45f-d86a4b63bdcc', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('311daee9-3c15-4b19-8fb7-97823c57eb23', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('b8e09c5a-fecc-4400-b831-d7f75f9cee01', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('c9162947-90f2-41c9-8df8-2d2244bb6f1d', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('701ae534-4c13-45a2-8a72-e78afdea4d2b', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('63dedb65-0237-4402-8a5c-1d2137840fdd', 'safety');


INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('5673475f-c43d-432c-a6a6-f29479493b4d', '94');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('c9162947-90f2-41c9-8df8-2d2244bb6f1d', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('c9162947-90f2-41c9-8df8-2d2244bb6f1d', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('c9162947-90f2-41c9-8df8-2d2244bb6f1d', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('c9162947-90f2-41c9-8df8-2d2244bb6f1d', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('c9162947-90f2-41c9-8df8-2d2244bb6f1d', '95');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('701ae534-4c13-45a2-8a72-e78afdea4d2b', '9');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('701ae534-4c13-45a2-8a72-e78afdea4d2b', '46');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('701ae534-4c13-45a2-8a72-e78afdea4d2b', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('701ae534-4c13-45a2-8a72-e78afdea4d2b', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('701ae534-4c13-45a2-8a72-e78afdea4d2b', '95');


INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('5f6c1aed-8c46-48e6-b48d-2cf06568831f', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('1aab5692-85a5-4151-b67c-8c2c93353916', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('bf9a87c9-f709-4f84-8a86-5afde3eb40c3', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6bbd42bc-a251-498a-8b19-8de8c55e32aa', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('5673475f-c43d-432c-a6a6-f29479493b4d', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f7b906de-63e0-479b-b766-2e50df8fbe19', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6359bdcd-0d1d-4e43-817c-cc338f07a065', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('5c4d5e15-ce0a-4322-8406-47e8bcb10bf4', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('ab3306d0-e734-4977-a462-42de0e1cf263', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('ccf64ae6-7f99-40fe-b45f-d86a4b63bdcc', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('311daee9-3c15-4b19-8fb7-97823c57eb23', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('b8e09c5a-fecc-4400-b831-d7f75f9cee01', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('c9162947-90f2-41c9-8df8-2d2244bb6f1d', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('701ae534-4c13-45a2-8a72-e78afdea4d2b', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('63dedb65-0237-4402-8a5c-1d2137840fdd', @groupId);


INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('03b9e633-db33-4720-8dd0-ee9e4f9f4ac6', '5c4d5e15-ce0a-4322-8406-47e8bcb10bf4', 'openstack.server');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2a90ae85-9a29-4bd7-baf3-da7618f0cfa6', 'ccf64ae6-7f99-40fe-b45f-d86a4b63bdcc', 'openstack.server');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2b4b1d69-7f33-4a3d-8bfd-e68f3a943422', '1aab5692-85a5-4151-b67c-8c2c93353916', 'openstack.user');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('310c62ea-c2b5-414d-b6e2-651afa3a6d01', 'bf9a87c9-f709-4f84-8a86-5afde3eb40c3', 'openstack.project');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('45612e31-efa5-4bcc-acef-678b558b506e', '6bbd42bc-a251-498a-8b19-8de8c55e32aa', 'openstack.volume');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('4a7ec53d-79d1-4728-9fdc-c5f2ad2df9e2', '5f6c1aed-8c46-48e6-b48d-2cf06568831f', 'openstack.user');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('597dba4b-2c69-4654-958f-2ad1d572558a', '63dedb65-0237-4402-8a5c-1d2137840fdd', 'openstack.router');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('8c2dae70-410d-42c3-ae6f-fb1ca586cf11', '6359bdcd-0d1d-4e43-817c-cc338f07a065', 'openstack.server');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('8ef9ed9d-dd64-4d16-8172-6371d97278f6', 'c9162947-90f2-41c9-8df8-2d2244bb6f1d', 'openstack.security-group');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('9c65aec9-9efa-43cc-97bd-4b6736eb5a71', 'b8e09c5a-fecc-4400-b831-d7f75f9cee01', 'openstack.network');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('aa674db4-d8d5-4f1a-9234-121c8ada3816', '5673475f-c43d-432c-a6a6-f29479493b4d', 'openstack.volume');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('bfc9d4c3-1c3d-48a5-8a7d-f65de17a8bef', 'ab3306d0-e734-4977-a462-42de0e1cf263', 'openstack.server');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('c5f6c360-254a-4ed5-bf58-6022ce23c43a', '701ae534-4c13-45a2-8a72-e78afdea4d2b', 'openstack.security-groups');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('cfed9be4-0af1-44c6-a8af-e0efaa7ffe9d', '311daee9-3c15-4b19-8fb7-97823c57eb23', 'openstack.flavor');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('e0915696-8ba8-4385-ae9a-804d76960eec', 'f7b906de-63e0-479b-b766-2e50df8fbe19', 'openstack.image');




INSERT INTO plugin ( id, name, icon, update_time) VALUES ('hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'));

INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('VMware 安全检查', '安全检查，为您提供通信网络、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-vsphere-plugin', 1);

SELECT @groupId := LAST_INSERT_ID();

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6503123d-6442-49f4-8118-883c354ac868', 'VMware vSphere Host 电源状态检测', 1, 'LowRisk', 'VMware vSphere 检测账号下 Host 电源状态是否属于开机状态，属于视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 Host 电源状态是否属于开机状态，属于视为“合规”，否则属于“不合规”\n  - name: vsphere-host-power-state\n    resource: vsphere.host\n    filters:\n      - not:\n        - type: system\n          power_state: ${{power_state}}', '[{\"key\":\"power_state\",\"name\":\"电源状态\",\"defaultValue\":\"POWERED_ON\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('7b494857-7010-446f-9deb-aab10262160e', 'VMware vSphere Datacenter 关联资源检测', 1, 'HighRisk', 'VMware vSphere 检测账号下Datacenter是否关联host、network、vm，关联视为“合规”，否则属于“不合规”', 'policies:\n  - name: vsphere-datacenter-system\n    resource: vsphere.datacenter\n    filters:\n      - not:\n        - type: system\n          host_folder: ${{host_folder}}\n          network_folder: ${{network_folder}}\n          vm_folder: ${{vm_folder}}', '[{\"key\":\"host_folder\",\"name\":\"关联host\",\"defaultValue\":\"\'\'\",\"required\":true},{\"key\":\"network_folder\",\"name\":\"关联network\",\"defaultValue\":\"\'\'\",\"required\":true},{\"key\":\"vm_folder\",\"name\":\"关联vm\",\"defaultValue\":\"\'\'\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('82d95569-e9be-4a26-a18e-f1590bac97fb', 'VMware vSphere Host 连接状态检测', 1, 'LowRisk', 'VMware vSphere 检测账号下 Host 连接状态，连接视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 Host 连接状态，连接视为“合规”，否则属于“不合规”\n  - name: vsphere-host-power-state\n    resource: vsphere.host\n    filters:\n      - not:\n        - type: system\n          connection_state: ${{connection_state}}', '[{\"key\":\"connection_state\",\"name\":\"连接状态\",\"defaultValue\":\"CONNECTED\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('8dccd008-f79b-4460-9b55-539f488e009a', 'VMware vSphere ResourcePool CPU 内存检测', 1, 'LowRisk', 'VMware vSphere 检测账号下 ResourcePool CPU内存是否分配，分配视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 ResourcePool CPU内存是否分配，分配视为“合规”，否则属于“不合规”\n  - name: vsphere-resourcepool-system\n    resource: vsphere.resourcepool\n    filters:\n      - not:\n        - type: system\n          cpu_allocation: ${{cpu_allocation}}\n          memory_allocation: ${{memory_allocation}}', '[{\"key\":\"cpu_allocation\",\"name\":\"CPU分配\",\"defaultValue\":\"0\",\"required\":true},{\"key\":\"memory_allocation\",\"name\":\"内存分配\",\"defaultValue\":\"0\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('b62df3f7-581b-4591-9373-581dd3dcdd88', 'VMware vSphere Network 分布式类型检测', 1, 'LowRisk', 'VMware vSphere 检测账号下 Network 是否属于分布式类型，属于视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 Network 是否属于分布式类型，属于视为“合规”，否则属于“不合规”\n  - name: vsphere-network-type\n    resource: vsphere.network\n    filters:\n      - not:\n        - type: system\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否属于分布式类型\",\"defaultValue\":\"DISTRIBUTED_PORTGROUP\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('b798aa33-bd01-47ac-8cec-64f4f5d02866', 'VMware vSphere VM 状态检测', 1, 'MediumRisk', 'VMware vSphere 检测账号下 VM 是否符合条件，符合视为“合规”，否则属于“不合规”', 'policies:\n  #检测账号下 VM 是否符合条件，符合视为“合规”，否则属于“不合规”\n  - name: vsphere-vm-system\n    resource: vsphere.vm\n    filters:\n      - not:\n        - type: system\n          power_state: ${{power_state}}\n          cpu_count: ${{cpu_count}}\n          memory_size_mib: ${{memory_size_mib}}', '[{\"key\":\"power_state\",\"name\":\"电源状态\",\"defaultValue\":\"POWERED_ON\",\"required\":true},{\"key\":\"cpu_count\",\"name\":\"CPU最低值(核)\",\"defaultValue\":\"1\",\"required\":true},{\"key\":\"memory_size_mib\",\"name\":\"内存最低值(M)\",\"defaultValue\":\"1024\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', 'VMware vSphere Cluster 高可用状态检测', 1, 'HighRisk', 'VMware vSphere 检测账号下Cluster具备高可用能力，符合视为“合规”，否则视为“不合规”', 'policies:\n  #检测账号下Cluster具备高可用能力，符合视为“合规”，否则视为“不合规”\n  - name: vsphere-cluster-ha-enabled\n    resource: vsphere.cluster\n    filters:\n      - not:\n        - type: ha-enabled\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否具备高可用\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('e9d801ab-3790-415e-9565-bd7208cb1b54', 'VMware vSphere Datastore 多主机访问检测', 1, 'MediumRisk', 'VMware vSphere 检测账号下 Datastore 是否支持多主机访问，支持视为“合规”，否则属于“不合规”', 'policies:\n  - name: vsphere-datastore-host\n    resource: vsphere.datastore\n    filters:\n      - not:\n        - type: system\n          multiple_host_access: ${{multiple_host_access}}', '[{\"key\":\"multiple_host_access\",\"name\":\"是否支持多主机访问\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', 'VMware vSphere Datastore 可用空间检测', 1, 'LowRisk', 'VMware vSphere 检测账号下 Datastore 可用空间是否满足条件，满足视为“合规”，否则属于“不合规”', 'policies:\n  - name: vsphere-datastore-thin-provisioning\n    resource: vsphere.datastore\n    filters:\n      - not:\n        - type: system\n          free_space: ${{free_space}}', '[{\"key\":\"free_space\",\"name\":\"可用空间是否大于(G)\",\"defaultValue\":\"500\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('faa53ae5-f534-4a3c-85e2-22398dadd468', 'VMware vSphere Datastore 精简配置检测', 1, 'LowRisk', 'VMware vSphere 检测账号下 Datastore 是否支持精简配置，支持视为“合规”，否则属于“不合规”', 'policies:\n  - name: vsphere-datastore-thin-provisioning\n    resource: vsphere.datastore\n    filters:\n      - not:\n        - type: system\n          thin_provisioning_supported: ${{thin_provisioning_supported}}', '[{\"key\":\"thin_provisioning_supported\",\"name\":\"是否支持精简配置\",\"defaultValue\":\"true\",\"required\":true}]', 'hummer-vsphere-plugin', 'VMware vSphere', 'vmware.png', concat(unix_timestamp(now()), '007'), 1, 'custodian');


INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('7b494857-7010-446f-9deb-aab10262160e', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('e9d801ab-3790-415e-9565-bd7208cb1b54', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('faa53ae5-f534-4a3c-85e2-22398dadd468', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('82d95569-e9be-4a26-a18e-f1590bac97fb', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6503123d-6442-49f4-8118-883c354ac868', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('b62df3f7-581b-4591-9373-581dd3dcdd88', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('8dccd008-f79b-4460-9b55-539f488e009a', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('b798aa33-bd01-47ac-8cec-64f4f5d02866', 'safety');


INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', '2');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', '58');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('7b494857-7010-446f-9deb-aab10262160e', '64');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('e9d801ab-3790-415e-9565-bd7208cb1b54', '64');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('faa53ae5-f534-4a3c-85e2-22398dadd468', '64');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', '59');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', '60');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('82d95569-e9be-4a26-a18e-f1590bac97fb', '17');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('6503123d-6442-49f4-8118-883c354ac868', '17');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('b62df3f7-581b-4591-9373-581dd3dcdd88', '3');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('8dccd008-f79b-4460-9b55-539f488e009a', '64');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('b798aa33-bd01-47ac-8cec-64f4f5d02866', '64');


INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d004829c-b359-4993-84fd-0441c1ea9c6b', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('7b494857-7010-446f-9deb-aab10262160e', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('e9d801ab-3790-415e-9565-bd7208cb1b54', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('faa53ae5-f534-4a3c-85e2-22398dadd468', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('eab382c4-49db-420c-b4e1-987b47bf6661', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('82d95569-e9be-4a26-a18e-f1590bac97fb', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6503123d-6442-49f4-8118-883c354ac868', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('b62df3f7-581b-4591-9373-581dd3dcdd88', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('8dccd008-f79b-4460-9b55-539f488e009a', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('b798aa33-bd01-47ac-8cec-64f4f5d02866', @groupId);


INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('06e232b8-c8df-4bb5-9ce2-997bcbdc5e7a', '6503123d-6442-49f4-8118-883c354ac868', 'vsphere.host');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2044548f-cde9-4e2b-9105-52f1687c6407', 'faa53ae5-f534-4a3c-85e2-22398dadd468', 'vsphere.datastore');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2578e430-be92-4975-b038-25fa92f35166', '8dccd008-f79b-4460-9b55-539f488e009a', 'vsphere.resourcepool');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('29085daa-a551-4dda-9f71-1409484b2c99', 'e9d801ab-3790-415e-9565-bd7208cb1b54', 'vsphere.datastore');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('7f240477-21f6-432e-a43d-64ca71e1b5f2', 'b798aa33-bd01-47ac-8cec-64f4f5d02866', 'vsphere.vm');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('92791f37-ebc9-47a1-b025-add90d171704', 'b62df3f7-581b-4591-9373-581dd3dcdd88', 'vsphere.network');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('b817e070-49c1-47cc-9b5a-f19904ff2e91', '7b494857-7010-446f-9deb-aab10262160e', 'vsphere.datacenter');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('bb2dd4df-3fe9-4c26-841b-59fa6b744b83', 'eab382c4-49db-420c-b4e1-987b47bf6661', 'vsphere.datastore');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('ecb5e5a9-d286-41cb-bec9-d022f3773457', '82d95569-e9be-4a26-a18e-f1590bac97fb', 'vsphere.host');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('f526d8d1-b39e-4b95-9da9-f103376a04fd', 'd004829c-b359-4993-84fd-0441c1ea9c6b', 'vsphere.cluster');




INSERT INTO plugin ( id, name, icon, update_time) VALUES ('hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'));

INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('GCP 安全检查', '安全检查，为您提供通信网络、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-gcp-plugin', 1);

SELECT @groupId := LAST_INSERT_ID();

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('1f3ef6ec-17ab-409d-9051-ea5c543312d1', 'Google Cloud 部署管理器检测', 1, 'LowRisk', 'Google Cloud 检测账号下已达到到期日期的部署，未到期视为“合规”，否则属于“不合规”', 'policies:\n  # 检测账号下已达到到期日期的部署，未到期视为“合规”，否则属于“不合规”\n  - name: expired-deployments\n    description: Finds expired deployments\n    resource: gcp.dm-deployment\n    filters:\n    - type: value\n      key: insertTime\n      value_type: expiration\n      op: gte\n      value: ${{day}}', '[{\"key\":\"day\",\"name\":\"到期时间\",\"defaultValue\":\"7\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('34c7e619-6815-4c20-af8e-8d11b16a770c', 'Google Cloud SQL实例检测', 1, 'HighRisk', 'Google Cloud 检测账号下Cloud SQL 实例的备份是否运行并列出超过 5 天的不成功备份，符合的视为“合规”，否则属于“不合规”', 'policies:\n# 检测账号下Cloud SQL 实例的备份是否运行并列出超过 5 天的不成功备份，符合的视为“合规”，否则属于“不合规”\n- name: sql-backup-run\n  description: |\n    check basic work of Cloud SQL filter on backup runs: lists unsucessful backups older than 5 days\n  resource: gcp.sql-backup-run\n  filters:\n    - type: value\n      key: status\n      op: not-equal\n      value: ${{status}}\n    - type: value\n      key: endTime\n      op: greater-than\n      value_type: age\n      value: ${{day}}', '[{\"key\":\"status\",\"name\":\"状态\",\"defaultValue\":\"SUCCESSFUL\",\"required\":true},{\"key\":\"day\",\"name\":\"天数\",\"defaultValue\":\"5\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('3a1a0fc7-98f3-4f8e-a434-76460ef2009b', 'Google Cloud DNS 策略日志记录检测', 1, 'LowRisk', 'Google Cloud 检测账号下DNS 策略中的日志记录状态，未禁用视为“合规”，否则属于“不合规”', 'policies:\n    # 检测账号下DNS 策略中的日志记录状态，未禁用视为“合规”，否则属于“不合规”\n    - name: gcp-dns-policies-if-logging-disabled\n      resource: gcp.dns-policy\n      filters:\n        - type: value\n          key: enableLogging\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"是否禁用\",\"defaultValue\":\"false\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6923bc7a-fb4f-4c1c-ae70-dc6aac407e11', 'Google Cloud 负载均衡器检测', 1, 'MediumRisk', 'Google Cloud 检测账号下负载均衡器是否有 TLS 1.2 版的 SSL 策略，符合的视为“合规”，否则属于“不合规”', 'policies:\n  # 检测账号下负载均衡器是否有 TLS 1.2 版的 SSL 策略，符合的视为“合规”，否则属于“不合规”\n  - name: gcp-load-balancing-ssl-policies\n    resource: gcp.loadbalancer-ssl-policy\n    filters:\n      - type: value\n        key: minTlsVersion\n        op: ne\n        value: ${{tsl}}', '[{\"key\":\"tsl\",\"name\":\"SSL 策略 TLS 版本\",\"defaultValue\":\"TLS_1_2\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6939910d-a7f1-4347-9238-abce1111f45d', 'Google Cloud 域使用状态检测', 1, 'MediumRisk', 'Google Cloud 检测账号下列入黑名单的域是否仍在使用中，未使用视为“合规”，否则属于“不合规”', 'vars:\n  blacklisted-domains-in-use: &blacklisted-domains\n    - ${{domains1}}\n    - ${{domains2}}\n    - ${{domains3}}\npolicies:\n  # 检测账号下列入黑名单的域是否仍在使用中，未使用视为“合规”，否则属于“不合规”\n  - name: gcp-app-engine-domain-if-blacklisted-in-use\n    resource: gcp.app-engine-domain\n    filters:\n      - type: value\n        key: id\n        op: in\n        value: *blacklisted-domains', '[{\"key\":\"domains1\",\"name\":\"域名1\",\"defaultValue\":\"appengine-de.mo\",\"required\":true},{\"key\":\"domains2\",\"name\":\"域名2\",\"defaultValue\":\"gcp-li.ga\",\"required\":true},{\"key\":\"domains3\",\"name\":\"域名3\",\"defaultValue\":\"whatever.com\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('7557ce1b-aacf-4cd7-bb19-6e411621daf3', 'Google Cloud 防火墙规则检测', 1, 'LowRisk', 'Google Cloud 检测账号下防火墙规则是否符合规则，符合视为“合规”，否则属于“不合规”', 'vars:\n    min-network-prefix-size: &min-network-prefix-size ${{value2}}\npolicies:\n    # 检测账号下防火墙规则是否符合规则，符合视为“合规”，否则属于“不合规”\n    - name: appengine-firewall-rules\n      description: |\n        Check if firewall rule network prefix size is long enough\n      resource: gcp.app-engine-firewall-ingress-rule\n      filters:\n        - not:\n          - type: value\n            key: sourceRange\n            op: regex\n            # 过滤掉*特殊字符和没有网络前缀长度的IP地址\n            value: ${{value1}}\n          - type: value\n            key: sourceRange\n            value_type: cidr_size\n            op: ge\n            value: *min-network-prefix-size', '[{\"key\":\"value1\",\"name\":\"防火墙过滤规则(正则表达式)\",\"defaultValue\":\"\\\"^([0-9]{1,3}\\\\\\\\.){3}[0-9]{1,3}(\\\\\\\\/([0-9]|[1-2][0-9]|3[0-2]))?$\\\"\",\"required\":true},{\"key\":\"value2\",\"name\":\"长度\",\"defaultValue\":\"24\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('9312ca46-1ce9-4e42-86b2-7f9b5c0db090', 'Google Cloud 防火墙入口规则配置检测', 1, 'LowRisk', 'Google Cloud 检测账号下防火墙规则是否只有一个规则允许所有连接，符合视为“合规”，否则属于“不合规”', 'policies:\n  # 检测账号下防火墙规则是否只有一个规则允许所有连接，符合视为“合规”，否则属于“不合规”\n  - name: gcp-app-engine-firewall-ingress-rule-if-default-unrestricted-access\n    resource: gcp.app-engine-firewall-ingress-rule\n    filters:\n      - and:\n        - type: value\n          value_type: resource_count\n          op: eq\n          value: ${{value}}\n        - type: value\n          key: sourceRange\n          value: \'*\'\n        - type: value\n          key: action\n          value: ALLOW', '[{\"key\":\"value\",\"name\":\"策略数量\",\"defaultValue\":\"1\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('95e46474-5611-4d82-a9c5-5da3398ad3a4', 'Google Cloud 实例模板检测', 1, 'LowRisk', 'Google Cloud 检测账号下不符合要求的实例模板，符合的视为“合规”，否则属于“不合规”', 'vars:\n  # See https://cloud.google.com/compute/docs/machine-types\n  disallowed-machine-types: &disallowed-machine-types\n    - ${{value1}}\n    - ${{value2}}\n    - ${{value3}}\n    - ${{value4}}\n    - ${{value5}}\n\npolicies:\n  - name: gcp-instance-template-disallowed-machine-types\n    resource: gcp.instance-template\n    filters:\n      - type: value\n        key: properties.machineType\n        op: in\n        value: *disallowed-machine-types', '[{\"key\":\"value1\",\"name\":\"模板类型\",\"defaultValue\":\"\\\"f1-micro\\\"\",\"required\":true},{\"key\":\"value2\",\"name\":\"模板类型\",\"defaultValue\":\"\\\"g1-small\\\"\",\"required\":true},{\"key\":\"value3\",\"name\":\"模板类型\",\"defaultValue\":\"\\\"n1-highcpu-32\\\"\",\"required\":true},{\"key\":\"value4\",\"name\":\"模板类型\",\"defaultValue\":\"\\\"n1-highcpu-64\\\"\",\"required\":true},{\"key\":\"value5\",\"name\":\"模板类型\",\"defaultValue\":\"\\\"n1-highcpu-96\\\"\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('d147a425-ddd5-4826-b685-e3b3842ae253', 'Google Cloud SSL 证书过期检测', 1, 'LowRisk', 'Google Cloud 检测账号下 SSL 证书是否即将到期，未到期视为“合规”，否则属于“不合规”', 'policies:\n    # 检测账号下 SSL 证书是否即将到期，未到期视为“合规”，否则属于“不合规”\n    - name: appengine-certificate-age\n      description: |\n        Check existing certificate\n      resource: gcp.app-engine-certificate\n      filters:\n      - type: value\n        key: expireTime\n        op: ${{op}}\n        value_type: expiration\n        value: ${{day}}', '[{\"key\":\"op\",\"name\":\"比较（大于/小于/等于）\",\"defaultValue\":\"less-than\",\"required\":true},{\"key\":\"day\",\"name\":\"天数\",\"defaultValue\":\"60\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('d2288b78-bab7-4195-9c16-79ae29b9f292', 'Google Cloud DNS 区域的资源检测', 1, 'LowRisk', 'Google Cloud 检测账号下DNS 区域的资源中是否禁用了 DNSSEC，未禁用视为“合规”，否则属于“不合规”', 'policies:\n    # 检测账号下DNS 区域的资源中是否禁用了 DNSSEC，未禁用视为“合规”，否则属于“不合规”\n    - name: gcp-dns-managed-zones-if-no-dnssec\n      resource: gcp.dns-managed-zone\n      filters:\n        - type: value\n          key: dnssecConfig.state\n          # off without quotes is treated as bool False\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"DNS的DNSSEC状态\",\"defaultValue\":\"\\\"off\\\"\",\"required\":true}]', 'hummer-gcp-plugin', 'Google Cloud', 'gcp.png', concat(unix_timestamp(now()), '008'), 1, 'custodian');

INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('d147a425-ddd5-4826-b685-e3b3842ae253', 'cost');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6939910d-a7f1-4347-9238-abce1111f45d', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('7557ce1b-aacf-4cd7-bb19-6e411621daf3', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('9312ca46-1ce9-4e42-86b2-7f9b5c0db090', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('1f3ef6ec-17ab-409d-9051-ea5c543312d1', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('d2288b78-bab7-4195-9c16-79ae29b9f292', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('3a1a0fc7-98f3-4f8e-a434-76460ef2009b', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('95e46474-5611-4d82-a9c5-5da3398ad3a4', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6923bc7a-fb4f-4c1c-ae70-dc6aac407e11', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('34c7e619-6815-4c20-af8e-8d11b16a770c', 'safety');


INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d147a425-ddd5-4826-b685-e3b3842ae253', '87');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('6939910d-a7f1-4347-9238-abce1111f45d', '62');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('1f3ef6ec-17ab-409d-9051-ea5c543312d1', '87');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d2288b78-bab7-4195-9c16-79ae29b9f292', '91');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('3a1a0fc7-98f3-4f8e-a434-76460ef2009b', '91');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('95e46474-5611-4d82-a9c5-5da3398ad3a4', '91');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('6923bc7a-fb4f-4c1c-ae70-dc6aac407e11', '91');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('34c7e619-6815-4c20-af8e-8d11b16a770c', '91');


INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d147a425-ddd5-4826-b685-e3b3842ae253', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6939910d-a7f1-4347-9238-abce1111f45d', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('7557ce1b-aacf-4cd7-bb19-6e411621daf3', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('9312ca46-1ce9-4e42-86b2-7f9b5c0db090', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('1f3ef6ec-17ab-409d-9051-ea5c543312d1', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d2288b78-bab7-4195-9c16-79ae29b9f292', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('3a1a0fc7-98f3-4f8e-a434-76460ef2009b', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('95e46474-5611-4d82-a9c5-5da3398ad3a4', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6923bc7a-fb4f-4c1c-ae70-dc6aac407e11', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('34c7e619-6815-4c20-af8e-8d11b16a770c', @groupId);


INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('0388fcf8-e189-4f1b-9a34-927c02ea4c52', '3a1a0fc7-98f3-4f8e-a434-76460ef2009b', 'gcp.dns-policy');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('139696cc-b0f1-48d5-8f45-2d90aef61bdf', '6923bc7a-fb4f-4c1c-ae70-dc6aac407e11', 'gcp.loadbalancer-ssl-policy');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('19f7a070-b8fb-49fe-a4ea-df6a93af61fa', '9312ca46-1ce9-4e42-86b2-7f9b5c0db090', 'gcp.app-engine-firewall-ingress-rule');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('3fc5a259-888c-4a38-9bf9-120798bd1647', '1f3ef6ec-17ab-409d-9051-ea5c543312d1', 'gcp.dm-deployment');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('5a0bdd82-76be-4b8f-aac8-832e462762a9', '7557ce1b-aacf-4cd7-bb19-6e411621daf3', 'gcp.app-engine-firewall-ingress-rule');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('686da099-4b14-43e4-946d-5170e319369f', '95e46474-5611-4d82-a9c5-5da3398ad3a4', 'gcp.instance-template');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('72bba5c7-95ac-45b0-8482-afd104d27d27', '34c7e619-6815-4c20-af8e-8d11b16a770c', 'gcp.sql-backup-run');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('a6913598-a77c-483d-b94d-d652de8d4418', '6939910d-a7f1-4347-9238-abce1111f45d', 'gcp.app-engine-domain');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('b9aa8f0d-726f-4e06-a83a-e0c8202c121c', 'd2288b78-bab7-4195-9c16-79ae29b9f292', 'gcp.dns-managed-zone');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('cdcf14dd-8a76-4694-8271-25463a5ca0d3', 'd147a425-ddd5-4826-b685-e3b3842ae253', 'gcp.app-engine-certificate');


INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('2274a926-ea5e-4cdc-915e-09fa6d803bff', 'Aliyun SLB VPC 检测', 1, 'HighRisk', 'Aliyun 账号下 SLB 负载均衡实例指定属于哪些VPC, 属于则合规，不属于则\"不合规\"', 'policies:\n  # 检测您账号下SLB负载均衡实例指定属于哪些VPC, 属于则合规，不属于则\"不合规\"。\n  - name: aliyun-slb-vpc-type\n    resource: aliyun.slb\n    filters:\n      - type: vpc-type\n        vpcIds: [${{value1}}, ${{value2}}]', '[{\"key\":\"value1\",\"name\":\"vpcId1\",\"defaultValue\":\"\\\"vpc-1\\\"\",\"required\":true},{\"key\":\"value2\",\"name\":\"vpcId2\",\"defaultValue\":\"\\\"vpc-2\\\"\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f3675431-730d-446f-b062-7301c5c40f23', 'Aliyun RDS VPC 检测', 1, 'HighRisk', 'Aliyun 账号下的 RDS 实例指定属于哪些 VPC, 属于则合规，不属于则\"不合规\"', 'policies:\n  # 检测您账号下的Rds实例指定属于哪些VPC, 属于则合规，不属于则\"不合规\"。\n  - name: aliyun-rds-vpc-type\n    resource: aliyun.rds\n    filters:\n      - type: vpc-type\n        vpcIds: [${{value1}}, ${{value2}}]', '[{\"key\":\"value1\",\"name\":\"vpcId1\",\"defaultValue\":\"\\\"vpc-1\\\"\",\"required\":true},{\"key\":\"value2\",\"name\":\"vpcId2\",\"defaultValue\":\"\\\"vpc-2\\\"\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('4f8fa101-171a-4491-9485-e5aa091a88a4', 'Aliyun Polardb VPC 检测', 1, 'HighRisk', 'Aliyun 账号下的 Polardb 实例指定属于哪些 VPC, 属于则合规，不属于则\"不合规\"', 'policies:\n  # 检测您账号下的Polardb实例指定属于哪些VPC, 属于则合规，不属于则\"不合规\"。\n  - name: aliyun-polardb-vpc-type\n    resource: aliyun.polardb\n    filters:\n      - type: vpc-type\n        vpcIds: [${{value1}}, ${{value2}}]', '[{\"key\":\"value1\",\"name\":\"vpcId1\",\"defaultValue\":\"\\\"vpc-1\\\"\",\"required\":true},{\"key\":\"value2\",\"name\":\"vpcId2\",\"defaultValue\":\"\\\"vpc-2\\\"\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f4ebb59b-c93a-4f34-9e66-660b03943d7d', 'Aliyun ECS VPC 检测', 1, 'HighRisk', 'Aliyun 账号下的 Ecs 实例指定属于哪些 VPC, 属于则合规，不属于则\"不合规\"', 'policies:\n  # 检测您账号下的Ecs实例指定属于哪些VPC, 属于则合规，不属于则\"不合规\"。\n  - name: aliyun-ecs-vpc-type\n    resource: aliyun.ecs\n    filters:\n      - type: vpc-type\n        vpcIds: [${{value1}}, ${{value2}}]', '[{\"key\":\"value1\",\"name\":\"vpcId1\",\"defaultValue\":\"\\\"vpc-1\\\"\",\"required\":true},{\"key\":\"value2\",\"name\":\"vpcId2\",\"defaultValue\":\"\\\"vpc-2\\\"\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('e28786b3-f2b1-46de-b4b6-7835b42ae58b', 'Aliyun SLB 负载均衡监听检测', 1, 'HighRisk', 'Aliyun 账号下的 SLB 负载均衡是否开启 HTTPS 或 HTTP 监听，开启视为合规，否则不合规', 'policies:\n  # 检测您账号下的SLB负载均衡是否开启HTTPS或HTTP监听，开启视为合规，否则不合规。\n  - name: aliyun-slb-listener-type\n    resource: aliyun.slb\n    filters:\n      - type: listener-type\n        value: [${{value1}}, ${{value2}}]', '[{\"key\":\"value1\",\"name\":\"监听类型1\",\"defaultValue\":\"\\\"https\\\"\",\"required\":true},{\"key\":\"value2\",\"name\":\"监听类型2\",\"defaultValue\":\"\\\"http\\\"\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('4d427c93-5645-445a-93a3-0c536d6865ab', 'Aliyun SecurityGroup 安全组端口访问检测', 1, 'HighRisk', 'Aliyun 账号下 ECS 安全组配置允许所有端口访问视为”不合规“，否则为”合规“', 'policies:\n  # 账号下ECS安全组配置允许所有端口访问视为”不合规“，否则为”合规“\n  - name: aliyun-sg-ports\n    resource: aliyun.security-group\n    filters:\n      - type: source-ports\n        SourceCidrIp: ${{SourceCidrIp}}\n        PortRange: ${{PortRange}}', '[{\"key\":\"SourceCidrIp\",\"name\":\"目标IP地址段\",\"defaultValue\":\"\\\"0.0.0.0/0\\\"\",\"required\":true},{\"key\":\"PortRange\",\"name\":\"端口号\",\"defaultValue\":\"\\\"-1/-1\\\"\",\"required\":true}]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '001'), 1, 'custodian');

INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('2274a926-ea5e-4cdc-915e-09fa6d803bff', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('4d427c93-5645-445a-93a3-0c536d6865ab', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('4f8fa101-171a-4491-9485-e5aa091a88a4', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('e28786b3-f2b1-46de-b4b6-7835b42ae58b', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f3675431-730d-446f-b062-7301c5c40f23', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f4ebb59b-c93a-4f34-9e66-660b03943d7d', 'safety');

INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('2274a926-ea5e-4cdc-915e-09fa6d803bff', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('2274a926-ea5e-4cdc-915e-09fa6d803bff', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('2274a926-ea5e-4cdc-915e-09fa6d803bff', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('2274a926-ea5e-4cdc-915e-09fa6d803bff', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('2274a926-ea5e-4cdc-915e-09fa6d803bff', '95');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4d427c93-5645-445a-93a3-0c536d6865ab', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4d427c93-5645-445a-93a3-0c536d6865ab', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4d427c93-5645-445a-93a3-0c536d6865ab', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4d427c93-5645-445a-93a3-0c536d6865ab', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4d427c93-5645-445a-93a3-0c536d6865ab', '95');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4f8fa101-171a-4491-9485-e5aa091a88a4', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4f8fa101-171a-4491-9485-e5aa091a88a4', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4f8fa101-171a-4491-9485-e5aa091a88a4', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4f8fa101-171a-4491-9485-e5aa091a88a4', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4f8fa101-171a-4491-9485-e5aa091a88a4', '95');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('e28786b3-f2b1-46de-b4b6-7835b42ae58b', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('e28786b3-f2b1-46de-b4b6-7835b42ae58b', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('e28786b3-f2b1-46de-b4b6-7835b42ae58b', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('e28786b3-f2b1-46de-b4b6-7835b42ae58b', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('e28786b3-f2b1-46de-b4b6-7835b42ae58b', '95');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f3675431-730d-446f-b062-7301c5c40f23', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f3675431-730d-446f-b062-7301c5c40f23', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f3675431-730d-446f-b062-7301c5c40f23', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f3675431-730d-446f-b062-7301c5c40f23', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f3675431-730d-446f-b062-7301c5c40f23', '95');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f4ebb59b-c93a-4f34-9e66-660b03943d7d', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f4ebb59b-c93a-4f34-9e66-660b03943d7d', '13');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f4ebb59b-c93a-4f34-9e66-660b03943d7d', '92');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f4ebb59b-c93a-4f34-9e66-660b03943d7d', '93');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f4ebb59b-c93a-4f34-9e66-660b03943d7d', '95');

INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('2274a926-ea5e-4cdc-915e-09fa6d803bff', '1');
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('4d427c93-5645-445a-93a3-0c536d6865ab', '1');
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('4f8fa101-171a-4491-9485-e5aa091a88a4', '2');
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('e28786b3-f2b1-46de-b4b6-7835b42ae58b', '1');
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f3675431-730d-446f-b062-7301c5c40f23', '2');
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f4ebb59b-c93a-4f34-9e66-660b03943d7d', '2');

INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('0281bea0-ac3f-443c-980d-068200bf4483', '4d427c93-5645-445a-93a3-0c536d6865ab', 'aliyun.security-group');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('abb87eba-a9bc-4176-be91-e0df46468b25', 'f3675431-730d-446f-b062-7301c5c40f23', 'aliyun.rds');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('cd24cf12-4a17-4900-be38-88458b98bc8a', 'e28786b3-f2b1-46de-b4b6-7835b42ae58b', 'aliyun.slb');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('cfaaa915-eb25-4089-9c60-559095d201df', 'f4ebb59b-c93a-4f34-9e66-660b03943d7d', 'aliyun.ecs');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('da05c56e-3c4c-4ca8-8ea1-c7668e3c2a78', '2274a926-ea5e-4cdc-915e-09fa6d803bff', 'aliyun.slb');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('f03e4c89-5f6d-402b-a4af-38c28281568f', '4f8fa101-171a-4491-9485-e5aa091a88a4', 'aliyun.polardb');



INSERT INTO plugin ( id, name, icon, update_time, scan_type) VALUES ('hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 'nuclei');

INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Nuclei 漏洞检测', '漏洞检测，为您提供发现可利用漏洞的一种安全检测（渗透攻击）。', '漏洞检测', 'hummer-nuclei-plugin', 1);

SELECT @groupId := LAST_INSERT_ID();

INSERT INTO `cloud_account` (`id`, `name`, `credential`, `plugin_id`, `plugin_name`, `plugin_icon`, `status`, `create_time`, `update_time`, `creator`, `regions`, `proxy_id`) VALUES ('124d9d-f108-3198-8198-798k9971f814', 'Nuclei 漏洞检测', '{\"description\":\"基于模板的 nuclei 被用来发送请求给目标，有着实现零误报的优点，并且可以对已知的路径进行有效的检测。nuclei 的主要用于在初期的探测阶段快速地对已知的且易于检测的漏洞或者 CVE 进行检测。如果存在 WAF 的话，nuclei 使用 retryablehttp-go 库来处理各种错误，并且重新尝试攻击。\", \"targetAddress\":\"127.0.0.1\"}', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', 'VALID', concat(unix_timestamp(now()), '010'), concat(unix_timestamp(now()), '010'), 'admin', '[{\"regionId\":\"ALL\",\"regionName\":\"Nuclei 漏洞检测\"}]', 0);

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('3808ac89-6fb0-4953-a6f3-a464f1b603bd', 'Nuclei Springboot Security检测', 1, 'LowRisk', 'Nuclei 基于条件的工作流，首先尝试检测 springboot 是否在目标上运行。如果找到 springboot，则会运行它的漏洞利用列表, 无返回结果则合规，否则属于\"不合规\"', 'id: springboot-workflow\n\ninfo:\n  name: Springboot Security Checks\n  author: dwisiswant0\n\nworkflows:\n  - template: technologies/springboot-actuator.yaml\n    subtemplates:\n      - template: cves/2018/CVE-2018-1271.yaml\n      - template: cves/2018/CVE-2018-1271.yaml\n      - template: cves/2020/CVE-2020-5410.yaml\n      - template: vulnerabilities/springboot/springboot-actuators-jolokia-xxe.yaml\n      - template: vulnerabilities/springboot/springboot-h2-db-rce.yaml', '[]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('49fb8964-15ab-45b9-864c-69b7e7cd5b71', 'Nuclei SSH Public Key检测', 1, 'LowRisk', 'Nuclei SSH 公钥检测, 无返回结果属于合规，否则属于\"不合规\"', 'id: ssh-private-key\n\ninfo:\n  name: SSH Private Key Detect\n  author: pd-team\n  severity: high\n\nfile:\n  - extensions:\n      - all\n    denylist:\n      - pub\n    no-recursive: true\n    max-size: 1024 # read very small chunks\n\n    matchers:\n      - type: word\n        words:\n          - \"BEGIN OPENSSH PRIVATE KEY\"\n          - \"BEGIN PRIVATE KEY\"\n          - \"BEGIN RSA PRIVATE KEY\"\n          - \"BEGIN DSA PRIVATE KEY\"\n          - \"BEGIN EC PRIVATE KEY\"\n          - \"BEGIN PGP PRIVATE KEY BLOCK\"\n          - \"ssh-rsa\"', '[]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('5227e5cd-7e66-4f32-8515-7895fdc79535', 'Nuclei POST threads检测', 1, 'LowRisk', 'Nuclei 模板以 RAW 格式定义和多个 POST 请求，threads检测, 无返回结果属于合规，否则属于\"不合规\"', 'id: race-condition-testing\n\ninfo:\n  name: Race condition testing with multiple requests\n  author: pdteam\n  severity: info\n\nrequests:\n  - raw:  \n      - |\n        POST / HTTP/1.1\n        Pragma: no-cache\n        Host: {{Hostname}}\n        Cache-Control: no-cache, no-transform\n        User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0\n\n        id=1\n\n      - |\n        POST / HTTP/1.1\n        Pragma: no-cache\n        Host: {{Hostname}}\n        Cache-Control: no-cache, no-transform\n        User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0\n\n        id=2\n\n      - |\n        POST / HTTP/1.1\n        Pragma: no-cache\n        Host: {{Hostname}}\n        Cache-Control: no-cache, no-transform\n        User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0\n\n        id=3\n\n      - |\n        POST / HTTP/1.1\n        Pragma: no-cache\n        Host: {{Hostname}}\n        Cache-Control: no-cache, no-transform\n        User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0\n\n        id=4\n\n      - |\n        POST / HTTP/1.1\n        Pragma: no-cache\n        Host: {{Hostname}}\n        Cache-Control: no-cache, no-transform\n        User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:47.0) Gecko/20100101 Firefox/47.0\n\n        id=5\n\n    threads: 5\n    race: true\n\n    matchers:\n      - type: status\n        status:\n          - 200', '[]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6bc48581-98bb-4563-9735-a505002e344f', 'Nuclei MySQL 实例检测', 1, 'LowRisk', 'Nuclei 启用本机密码支持的 MySQL 实例容易受到攻击, 不启动属于则合规，否则属于则\"不合规\"', 'id: mysql-native-password-bruteforce\n\ninfo:\n  name: MySQL DB with enabled native password\n  author: iamthefrogy\n  severity: info\n  tags: network,mysql,bruteforce,db\n  description: MySQL instance with enabled native password support prone vulnerable for password brute-force attack.\n\nnetwork:\n  - host:\n      - \"{{Hostname}}\"\n      - \"{{Hostname}}:3306\"\n\n    matchers:\n      - type: word\n        words:\n          - \"mysql_native_password\"', '[]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('ae7de16c-0a39-4119-a5c0-d0916f549e95', 'Nuclei Basic Network Request检测', 1, 'LowRisk', 'Nuclei 模板连接到网络服务，发送一些数据并从响应中读取 4 个字节。运行匹配器以识别有效响应, 无返回结果属于合规，否则属于\"不合规\"', 'id: basic-network-request\n\ninfo:\n  name: Basic Network Request\n  author: pdteam\n  severity: info\n\nnetwork:\n  - host: \n      - \"{{Hostname}}\"\n    inputs:\n      - data: \"PING\\r\\n\"\n    read-size: 4\n    matchers:\n      - type: word\n        part: data\n        words:\n          - ${{word}}', '[{\"key\":\"word\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"PONG\\\"\",\"required\":true}]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('afd0480e-651b-4229-aa68-d642e074fb59', 'Nuclei HTTP Template检测', 1, 'LowRisk', 'Nuclei 模板请求/URL 路径并针对响应运行多个基于 OR 的匹配器, 无返回结果属于合规，否则属于\"不合规\"', 'id: http-multiple-matchers\n\ninfo:\n  name: Test HTTP Template\n  author: pdteam\n  severity: info\n\nrequests:\n  - method: GET\n    path:\n      - \"{{BaseURL}}/\"\n    matchers:\n      - type: word\n        name: php\n        words:\n          - ${{word1}}\n          - ${{word2}}\n        part: header\n\n      - type: word\n        name: node\n        words:\n          - ${{word3}}\n          - ${{word4}}\n        condition: or\n        part: header\n\n      - type: word\n        name: python\n        words:\n          - ${{word5}}\n          - ${{word6}}\n        part: header', '[{\"key\":\"word1\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"X-Powered-By: PHP\\\"\",\"required\":true},{\"key\":\"word2\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"PHPSESSID\\\"\",\"required\":true},{\"key\":\"word3\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"Server: NodeJS\\\"\",\"required\":true},{\"key\":\"word4\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"X-Powered-By: nodejs\\\"\",\"required\":true},{\"key\":\"word5\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"Python/2.\\\"\",\"required\":true},{\"key\":\"word6\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"Python/3.\\\"\",\"required\":true}]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('cfc3ad75-2599-47ab-bfb2-af8a07531250', 'Nuclei HTTP request检测', 1, 'LowRisk', 'Nuclei 模板使用 rawhttp 库并检查字符串是否与响应匹配来生成定义的格式错误的 HTTP POST 请求, 无返回结果属于合规，否则属于\"不合规\"', 'id: CL.TE-http-smuggling\n\ninfo:\n  name: HTTP request smuggling, basic CL.TE vulnerability\n  author: pdteam\n  severity: info\n  lab: https://portswigger.net/web-security/request-smuggling/lab-basic-cl-te\n\nrequests:\n  - raw:\n    - |+\n      POST / HTTP/1.1\n      Host: {{Hostname}}\n      Connection: keep-alive\n      Content-Type: application/x-www-form-urlencoded\n      Content-Length: 6\n      Transfer-Encoding: chunked\n\n      0\n\n      G\n    - |+\n      POST / HTTP/1.1\n      Host: {{Hostname}}\n      Connection: keep-alive\n      Content-Type: application/x-www-form-urlencoded\n      Content-Length: 6\n      Transfer-Encoding: chunked\n\n      0\n\n      G\n\n    unsafe: true\n    matchers:\n      - type: dsl\n        dsl:\n          - \'contains(body, \"Unrecognized method GPOST\")\'', '[]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f50705c1-8930-4a53-b32d-da08eda1161c', 'Nuclei Wordpress Security检测', 1, 'LowRisk', 'Nuclei 模板检测 wordpress 是否在输入主机上运行，​​如果找到，则运行 wordpress 的漏洞利用和 cvs 列表, 无返回结果属于合规，否则属于\"不合规\"', 'id: workflow-example\ninfo:\n  name: Test Workflow Template\n  author: pdteam\n\nworkflows:\n  - template: technologies/tech-detect.yaml\n    matchers:\n      - name: wordpress\n        subtemplates:\n          - template: cves/2019/CVE-2019-6715.yaml\n          - template: cves/2019/CVE-2019-9978.yaml\n          - template: vulnerabilities/wordpress/wordpress-db-backup.yaml\n          - template: vulnerabilities/wordpress/wordpress-debug-log.yaml\n          - template: vulnerabilities/wordpress/wordpress-directory-listing.yaml\n          - template: vulnerabilities/wordpress/wordpress-emergency-script.yaml\n          - template: vulnerabilities/wordpress/wordpress-installer-log.yaml\n          - template: vulnerabilities/wordpress/wordpress-tmm-db-migrate.yaml\n          - template: vulnerabilities/wordpress/wordpress-user-enum.yaml\n          - template: vulnerabilities/wordpress/wordpress-accessible-wpconfig.yaml\n          - template: vulnerabilities/wordpress/sassy-social-share.yaml\n          - template: vulnerabilities/wordpress/w3c-total-cache-ssrf.yaml\n          - template: vulnerabilities/wordpress/wordpress-social-metrics-tracker.yaml\n          - template: vulnerabilities/wordpress/wordpress-wordfence-xss.yaml', '[]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('fc94e69d-a3bb-46a4-9f24-60f8369c6f15', 'Nuclei Jira & Confluence检测', 1, 'LowRisk', 'Nuclei 运行两个模板的通用工作流，一个用于检测 Jira，另一个用于检测 Confluence, 无返回结果属于合规，否则属于\"不合规\"', 'id: workflow-example\ninfo:\n  name: Test Workflow Template\n  author: pdteam\n\nworkflows:\n  - template: exposed-panels/jira-detect.yaml\n  - template: vulnerabilities/confluence/confluence-ssrf-sharelinks.yaml', '[]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('ffecf574-f388-40ad-aebb-9a46ef798dcf', 'Nuclei DNS Template检测', 1, 'LowRisk', 'Nuclei 检测输入是否存在 CNAME 记录的基本 DNS 请求, 无返回结果属于合规，否则属于\"不合规\"', 'id: multiple-matcher\n\ninfo:\n  name: Test DNS Template\n  author: pdteam\n  severity: info\n\ndns:\n  - name: \"{{FQDN}}\"\n    type: CNAME\n    class: inet\n    recursion: true\n    retries: 5\n    matchers-condition: or\n    matchers:\n      - type: word\n        name: zendesk\n        words:\n          - ${{word1}}\n      - type: word\n        name: github\n        words:\n          - ${{word2}}', '[{\"key\":\"word1\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"zendesk.com\\\"\",\"required\":true},{\"key\":\"word2\",\"name\":\"匹配器\",\"defaultValue\":\"\\\"github.io\\\"\",\"required\":true}]', 'hummer-nuclei-plugin', 'Nuclei', 'nuclei.png', concat(unix_timestamp(now()), '010'), 1, 'nuclei');


INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6bc48581-98bb-4563-9735-a505002e344f', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('afd0480e-651b-4229-aa68-d642e074fb59', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('cfc3ad75-2599-47ab-bfb2-af8a07531250', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('5227e5cd-7e66-4f32-8515-7895fdc79535', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('ffecf574-f388-40ad-aebb-9a46ef798dcf', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('49fb8964-15ab-45b9-864c-69b7e7cd5b71', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('ae7de16c-0a39-4119-a5c0-d0916f549e95', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('fc94e69d-a3bb-46a4-9f24-60f8369c6f15', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('3808ac89-6fb0-4953-a6f3-a464f1b603bd', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f50705c1-8930-4a53-b32d-da08eda1161c', 'safety');


INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6bc48581-98bb-4563-9735-a505002e344f', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('afd0480e-651b-4229-aa68-d642e074fb59', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('cfc3ad75-2599-47ab-bfb2-af8a07531250', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('5227e5cd-7e66-4f32-8515-7895fdc79535', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('ffecf574-f388-40ad-aebb-9a46ef798dcf', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('49fb8964-15ab-45b9-864c-69b7e7cd5b71', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('ae7de16c-0a39-4119-a5c0-d0916f549e95', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('fc94e69d-a3bb-46a4-9f24-60f8369c6f15', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('3808ac89-6fb0-4953-a6f3-a464f1b603bd', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f50705c1-8930-4a53-b32d-da08eda1161c', @groupId);


INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('4d0c4031-3532-475d-a588-ac414dea9b50', 'f50705c1-8930-4a53-b32d-da08eda1161c', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('845997f4-f468-44b4-bb93-8beebdeea179', '6bc48581-98bb-4563-9735-a505002e344f', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('949c53b6-091f-4b25-90a7-92988ca1f5f7', 'afd0480e-651b-4229-aa68-d642e074fb59', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('a02692b1-75fc-4c64-8370-cb6e1c4b334a', 'fc94e69d-a3bb-46a4-9f24-60f8369c6f15', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('c3024009-4cfa-4898-ad0d-ec98f55cf295', 'ae7de16c-0a39-4119-a5c0-d0916f549e95', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('d064d46a-ec0c-4c91-876c-2e815fc15531', '49fb8964-15ab-45b9-864c-69b7e7cd5b71', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('d3c90d07-22c5-4437-8bf2-92ff7409a621', '5227e5cd-7e66-4f32-8515-7895fdc79535', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('d7d6d250-1766-49ab-8dda-d78d25328ac9', '3808ac89-6fb0-4953-a6f3-a464f1b603bd', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('ebeb6338-355e-4653-856a-b181b3c3a125', 'ffecf574-f388-40ad-aebb-9a46ef798dcf', 'nuclei');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('f3807c69-3ff0-4f81-a947-7b01826f55c9', 'cfc3ad75-2599-47ab-bfb2-af8a07531250', 'nuclei');




INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('AWS Prowler - AWS Security Tool', '遵循 CIS Amazon Web Services Foundations Benchmark（49 项检查）的指导方针，并有 100 多项额外检查，包括与 GDPR、HIPAA、PCI-DSS、ISO-27001、FFIEC、SOC2 等相关的检查。', '高风险', 'hummer-aws-plugin', 1);

SELECT @groupId := LAST_INSERT_ID();

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('ebc80d1e-5dd9-4b86-8037-fb7c9727084a', 'AWS 1.0 Identity and Access Management', 1, 'HighRisk', 'AWS 1.0 Identity and Access Management - CIS only - [group1]', '1.0 Identity and Access Management - CIS only - [group1] ***********\n\n1.1  [check11] Avoid the use of the root account (Scored)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored)\n\n1.5  [check15] Ensure IAM password policy requires at least one uppercase letter (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.7  [check17] Ensure IAM password policy require at least one symbol (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n1.10  [check110] Ensure IAM password policy prevents password reuse: 24 or greater (Scored)\n\n1.11  [check111] Ensure IAM password policy expires passwords within 90 days or less (Scored)\n\n1.12  [check112] Ensure no root account access key exists (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n1.14  [check114] Ensure hardware MFA is enabled for the root account (Scored)\n\n1.15 [check115] Ensure security questions are registered in the AWS account (Not Scored)\n\n1.16  [check116] Ensure IAM policies are attached only to groups or roles (Scored)\n\n1.17 [check117] Maintain current contact details (Not Scored)\n\n1.18 [check118] Ensure security contact information is registered (Not Scored)\n\n1.19 [check119] Ensure IAM instance roles are used for AWS resource access from instances (Not Scored)\n\n1.20  [check120] Ensure a support role has been created to manage incidents with AWS Support (Scored)\n\n1.21 [check121] Do not setup access keys during initial user setup for all IAM users that have a console password (Not Scored)\n\n1.22  [check122] Ensure IAM policies that allow full \"*:*\" administrative privileges are not created (Scored)\n\n7.74 [extra774] Ensure credentials unused for 30 days or greater are disabled', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"group1\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '011'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('9929cc2a-7a9b-4643-a813-0e4359b09eb0', 'AWS 2.0 Logging', 1, 'HighRisk', 'AWS 2.0 Logging - CIS only - [group2]', '2.0 Logging - CIS only - [group2] **********************************\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.2  [check22] Ensure CloudTrail log file validation is enabled (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.4  [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs (Scored)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n2.6  [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket (Scored)\n\n2.7  [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs (Scored)\n\n2.8  [check28] Ensure rotation for customer created KMS CMKs is enabled (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"group2\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '012'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('8ad73e84-141a-40c4-bd56-1813535e8e92', 'AWS 3.0 Monitoring', 1, 'HighRisk', 'AWS 3.0 Monitoring - CIS only - [group3]', '3.0 Monitoring - CIS only - [group3] *******************************\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n3.9  [check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes (Scored)\n\n3.10  [check310] Ensure a log metric filter and alarm exist for security group changes (Scored)\n\n3.11  [check311] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL) (Scored)\n\n3.12  [check312] Ensure a log metric filter and alarm exist for changes to network gateways (Scored)\n\n3.13  [check313] Ensure a log metric filter and alarm exist for route table changes (Scored)\n\n3.14  [check314] Ensure a log metric filter and alarm exist for VPC changes (Scored)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"group3\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '013'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('ee74d071-d39e-4b0e-b4a3-e7ad24fbce12', 'AWS 4.0 Networking', 1, 'HighRisk', 'AWS 4.0 Networking - CIS only - [group4]', '4.0 Networking - CIS only - [group4] *******************************\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored)\n\n4.3  [check43] Ensure the default security group of every VPC restricts all traffic (Scored)\n\n4.4 [check44] Ensure routing tables for VPC peering are \"least access\" (Not Scored)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"group4\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '014'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('0dc8ae24-71f8-449a-8834-d59f8fbdf991', 'AWS 5.0 CIS Level 1', 1, 'HighRisk', 'AWS 5.0 CIS Level 1 - CIS only - [cislevel1]', '5.0 CIS Level 1 - CIS only - [cislevel1] ***************************\n\n1.1  [check11] Avoid the use of the root account (Scored)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored)\n\n1.5  [check15] Ensure IAM password policy requires at least one uppercase letter (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.7  [check17] Ensure IAM password policy require at least one symbol (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n1.10  [check110] Ensure IAM password policy prevents password reuse: 24 or greater (Scored)\n\n1.11  [check111] Ensure IAM password policy expires passwords within 90 days or less (Scored)\n\n1.12  [check112] Ensure no root account access key exists (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n1.15 [check115] Ensure security questions are registered in the AWS account (Not Scored)\n\n1.16  [check116] Ensure IAM policies are attached only to groups or roles (Scored)\n\n1.17 [check117] Maintain current contact details (Not Scored)\n\n1.18 [check118] Ensure security contact information is registered (Not Scored)\n\n1.19 [check119] Ensure IAM instance roles are used for AWS resource access from instances (Not Scored)\n\n1.20  [check120] Ensure a support role has been created to manage incidents with AWS Support (Scored)\n\n1.22  [check122] Ensure IAM policies that allow full \"*:*\" administrative privileges are not created (Scored)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.4  [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs (Scored)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n2.6  [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket (Scored)\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n3.12  [check312] Ensure a log metric filter and alarm exist for changes to network gateways (Scored)\n\n3.13  [check313] Ensure a log metric filter and alarm exist for route table changes (Scored)\n\n3.14  [check314] Ensure a log metric filter and alarm exist for VPC changes (Scored)\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"cislevel1\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '015'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('1fbd8c76-90e7-48e4-8281-ef597bb484e8', 'AWS 6.0 CIS Level 2', 1, 'HighRisk', 'AWS 6.0 CIS Level 2 - CIS only - [cislevel2]', '6.0 CIS Level 2 - CIS only - [cislevel2] ***************************\n\n1.1  [check11] Avoid the use of the root account (Scored)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored)\n\n1.5  [check15] Ensure IAM password policy requires at least one uppercase letter (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.7  [check17] Ensure IAM password policy require at least one symbol (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n1.10  [check110] Ensure IAM password policy prevents password reuse: 24 or greater (Scored)\n\n1.11  [check111] Ensure IAM password policy expires passwords within 90 days or less (Scored)\n\n1.12  [check112] Ensure no root account access key exists (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n1.14  [check114] Ensure hardware MFA is enabled for the root account (Scored)\n\n1.15 [check115] Ensure security questions are registered in the AWS account (Not Scored)\n\n1.16  [check116] Ensure IAM policies are attached only to groups or roles (Scored)\n\n1.17 [check117] Maintain current contact details (Not Scored)\n\n1.18 [check118] Ensure security contact information is registered (Not Scored)\n\n1.19 [check119] Ensure IAM instance roles are used for AWS resource access from instances (Not Scored)\n\n1.20  [check120] Ensure a support role has been created to manage incidents with AWS Support (Scored)\n\n1.21 [check121] Do not setup access keys during initial user setup for all IAM users that have a console password (Not Scored)\n\n1.22  [check122] Ensure IAM policies that allow full \"*:*\" administrative privileges are not created (Scored)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.2  [check22] Ensure CloudTrail log file validation is enabled (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.4  [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs (Scored)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n2.6  [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket (Scored)\n\n2.7  [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs (Scored)\n\n2.8  [check28] Ensure rotation for customer created KMS CMKs is enabled (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n3.9  [check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes (Scored)\n\n3.10  [check310] Ensure a log metric filter and alarm exist for security group changes (Scored)\n\n3.11  [check311] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL) (Scored)\n\n3.12  [check312] Ensure a log metric filter and alarm exist for changes to network gateways (Scored)\n\n3.13  [check313] Ensure a log metric filter and alarm exist for route table changes (Scored)\n\n3.14  [check314] Ensure a log metric filter and alarm exist for VPC changes (Scored)\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored)\n\n4.3  [check43] Ensure the default security group of every VPC restricts all traffic (Scored)\n\n4.4 [check44] Ensure routing tables for VPC peering are \"least access\" (Not Scored)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"cislevel2\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '016'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('6bb291bd-fcdf-4aa9-8fdf-69e761c9c4e0', 'AWS 7.0 Extras', 1, 'HighRisk', 'AWS 7.0 Extras - all non CIS specific checks - [extras]', '7.0 Extras - all non CIS specific checks - [extras] ****************\n\n7.1 [extra71] Ensure users of groups with AdministratorAccess policy have MFA tokens enabled (Not Scored) (Not part of CIS benchmark)\n\n7.2 [extra72] Ensure there are no EBS Snapshots set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.3 [extra73] Ensure there are no S3 buckets open to Everyone or Any AWS user (Not Scored) (Not part of CIS benchmark)\n\n7.4 [extra74] Ensure there are no Security Groups without ingress filtering being used (Not Scored) (Not part of CIS benchmark)\n\n7.5 [extra75] Ensure there are no Security Groups not being used (Not Scored) (Not part of CIS benchmark)\n\n7.6 [extra76] Ensure there are no EC2 AMIs set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.7 [extra77] Ensure there are no ECR repositories set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.8 [extra78] Ensure there are no Public Accessible RDS instances (Not Scored) (Not part of CIS benchmark)\n\n7.9 [extra79] Check for internet facing Elastic Load Balancers (Not Scored) (Not part of CIS benchmark)\n\n7.10 [extra710] Check for internet facing EC2 Instances (Not Scored) (Not part of CIS benchmark)\n\n7.11 [extra711] Check for Publicly Accessible Redshift Clusters (Not Scored) (Not part of CIS benchmark)\n\n7.12 [extra712] Check if Amazon Macie is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.13 [extra713] Check if GuardDuty is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.14 [extra714] Check if CloudFront distributions have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.15 [extra715] Check if Amazon Elasticsearch Service (ES) domains have logging enabled\n\n7.16 [extra716] Check if Amazon Elasticsearch Service (ES) domains are set as Public or if it has open policy access\n\n7.17 [extra717] Check if Elastic Load Balancers have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.18 [extra718] Check if S3 buckets have server access logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.19 [extra719] Check if Route53 public hosted zones are logging queries to CloudWatch Logs (Not Scored) (Not part of CIS benchmark)\n\n7.20 [extra720] Check if Lambda functions invoke API operations are being recorded by CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.21 [extra721] Check if Redshift cluster has audit logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.22 [extra722] Check if API Gateway has logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.23 [extra723] Check if RDS Snapshots and Cluster Snapshots are public (Not Scored) (Not part of CIS benchmark)\n\n7.24 [extra724] Check if ACM certificates have Certificate Transparency logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.25 [extra725] Check if S3 buckets have Object-level logging enabled in CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.26 [extra726] Check Trusted Advisor for errors and warnings (Not Scored) (Not part of CIS benchmark)\n\n7.27 [extra727] Check if SQS queues have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.28 [extra728] Check if SQS queues have Server Side Encryption enabled (Not Scored) (Not part of CIS benchmark)\n\n7.29 [extra729] Ensure there are no EBS Volumes unencrypted (Not Scored) (Not part of CIS benchmark)\n\n7.30 [extra730] Check if ACM Certificates are about to expire in 7 days or less (Not Scored) (Not part of CIS benchmark)\n\n7.31 [extra731] Check if SNS topics have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.32 [extra732] Check if Geo restrictions are enabled in CloudFront distributions (Not Scored) (Not part of CIS benchmark)\n\n7.33 [extra733] Check if there are SAML Providers then STS can be used (Not Scored) (Not part of CIS benchmark)\n\n7.34 [extra734] Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it (Not Scored) (Not part of CIS benchmark)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.36 [extra736] Check exposed KMS keys (Not Scored) (Not part of CIS benchmark)\n\n7.37 [extra737] Check KMS keys with key rotation disabled (Not Scored) (Not part of CIS benchmark)\n\n7.38 [extra738] Check if CloudFront distributions are set to HTTPS (Not Scored) (Not part of CIS benchmark)\n\n7.39 [extra739] Check if RDS instances have backup enabled (Not Scored) (Not part of CIS benchmark)\n\n7.40 [extra740] Check if EBS snapshots are encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.41 [extra741] Find secrets in EC2 User Data (Not Scored) (Not part of CIS benchmark)\n\n7.42 [extra742] Find secrets in CloudFormation outputs (Not Scored) (Not part of CIS benchmark)\n\n7.43 [extra743] Check if API Gateway has client certificate enabled to access your backend endpoint (Not Scored) (Not part of CIS benchmark)\n\n7.44 [extra744] Check if API Gateway has a WAF ACL attached (Not Scored) (Not part of CIS benchmark)\n\n7.45 [extra745] Check if API Gateway endpoint is public or private (Not Scored) (Not part of CIS benchmark)\n\n7.46 [extra746] Check if API Gateway has configured authorizers (Not Scored) (Not part of CIS benchmark)\n\n7.47 [extra747] Check if RDS instances is integrated with CloudWatch Logs  (Not Scored) (Not part of CIS benchmark)\n\n7.48 [extra748] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port (Not Scored) (Not part of CIS benchmark)\n\n7.49 [extra749] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483 (Not Scored) (Not part of CIS benchmark)\n\n7.50 [extra750] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306 (Not Scored) (Not part of CIS benchmark)\n\n7.51 [extra751] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432 (Not Scored) (Not part of CIS benchmark)\n\n7.52 [extra752] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379 (Not Scored) (Not part of CIS benchmark)\n\n7.53 [extra753] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018 (Not Scored) (Not part of CIS benchmark)\n\n7.54 [extra754] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888 (Not Scored) (Not part of CIS benchmark)\n\n7.55 [extra755] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211 (Not Scored) (Not part of CIS benchmark)\n\n7.56 [extra756] Check if Redshift cluster is Public Accessible (Not Scored) (Not part of CIS benchmark)\n\n7.57 [extra757] Check EC2 Instances older than 6 months (Not Scored) (Not part of CIS benchmark)\n\n7.58 [extra758] Check EC2 Instances older than 12 months (Not Scored) (Not part of CIS benchmark)\n\n7.61 [extra761] Check if EBS Default Encryption is activated (Not Scored) (Not part of CIS benchmark)\n\n7.62 [extra762] Find obsolete Lambda runtimes (Not Scored) (Not part of CIS benchmark)\n\n7.63 [extra763] Check if S3 buckets have object versioning enabled (Not Scored) (Not part of CIS benchmark)\n\n7.64 [extra764] Check if S3 buckets have secure transport policy (Not Scored) (Not part of CIS benchmark)\n\n7.65 [extra765] Check if ECR image scan on push is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.67 [extra767] Check if CloudFront distributions have Field Level Encryption enabled (Not Scored) (Not part of CIS benchmark)\n\n7.68 [extra768] Find secrets in ECS cloudTask definitions variables (Not Scored) (Not part of CIS benchmark)\n\n7.69 [extra769] Check if IAM Access Analyzer is enabled and its findings (Not Scored) (Not part of CIS benchmark)\n\n7.70 [extra770] Check for internet facing EC2 instances with Instance Profiles attached (Not Scored) (Not part of CIS benchmark)\n\n7.71 [extra771] Check if S3 buckets have policies which allow WRITE access (Not Scored) (Not part of CIS benchmark)\n\n7.72 [extra772] Check if elastic IPs are unused (Not Scored) (Not part of CIS benchmark)\n\n7.73 [extra773] Check if CloudFront distributions are using WAF (Not Scored) (Not part of CIS benchmark)\n\n7.74 [extra774] Ensure credentials unused for 30 days or greater are disabled\n\n7.75 [extra775] Find secrets in EC2 Auto Scaling Launch Configuration (Not Scored) (Not part of CIS benchmark)\n\n7.76 [extra776] Check if ECR image scan found vulnerabilities in the newest image version (Not Scored) (Not part of CIS benchmark)\n\n7.77 [extra777] Find VPC security groups with many ingress or egress rules (Not Scored) (Not part of CIS benchmark)\n\n7.78 [extra778] Find VPC security groups with wide-open public IPv4 CIDR ranges (non-RFC1918) (Not Scored) (Not part of CIS benchmark)\n\n7.79 [extra779] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports\n\n7.80 [extra780] Check if Amazon Elasticsearch Service (ES) domains has Amazon Cognito authentication for Kibana enabled\n\n7.81 [extra781] Check if Amazon Elasticsearch Service (ES) domains has encryption at-rest enabled\n\n7.82 [extra782] Check if Amazon Elasticsearch Service (ES) domains has node-to-node encryption enabled\n\n7.83 [extra783] Check if Amazon Elasticsearch Service (ES) domains has enforce HTTPS enabled\n\n7.84 [extra784] Check if Amazon Elasticsearch Service (ES) domains internal user database enabled\n\n7.85 [extra785] Check if Amazon Elasticsearch Service (ES) domains have updates available\n\n7.86 [extra786] Check if EC2 Instance Metadata Service Version 2 (IMDSv2) is Enabled and Required (Not Scored) (Not part of CIS benchmark)\n\n7.87 [extra787] Check connection and authentication for Internet exposed Elasticsearch/Kibana ports\n\n7.88 [extra788] Check connection and authentication for Internet exposed Amazon Elasticsearch Service (ES) domains\n\n7.91 [extra791] Check if CloudFront distributions are using deprecated SSL protocols\n\n7.92 [extra792] Check if Elastic Load Balancers have insecure SSL ciphers (Not Scored) (Not part of CIS benchmark)\n\n7.93 [extra793] Check if Elastic Load Balancers have SSL listeners (Not Scored) (Not part of CIS benchmark)\n\n7.94 [extra794] Ensure EKS Control Plane Audit Logging is enabled for all log types\n\n7.95 [extra795] Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled\n\n7.96 [extra796] Restrict Access to the EKS Control Plane Endpoint\n\n7.97 [extra797] Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs)\n\n7.98 [extra798] Check if Lambda functions have resource-based policy set as Public\n\n7.99 [extra799] Check if Security Hub is enabled and its standard subscriptions\n\n7.100 [extra7100] Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *)\n\n7.101 [extra7101] Check if Amazon Elasticsearch Service (ES) domains have audit logging enabled\n\n7.102 [extra7102] Check if any of the Elastic or Public IP are in Shodan (requires Shodan API KEY)\n\n7.103 [extra7103] Check if Amazon SageMaker Notebook instances have root access disabled\n\n7.104 [extra7104] Check if Amazon SageMaker Notebook instances have VPC settings configured\n\n7.105 [extra7105] Check if Amazon SageMaker Models have network isolation enabled\n\n7.106 [extra7106] Check if Amazon SageMaker Models have VPC settings configured\n\n7.107 [extra7107] Check if Amazon SageMaker Training jobs have intercontainer encryption enabled\n\n7.108 [extra7108] Check if Amazon SageMaker Training jobs have volume and output with KMS encryption enabled\n\n7.109 [extra7109] Check if Amazon SageMaker Training jobs have network isolation enabled\n\n7.110 [extra7110] Check if Amazon SageMaker Training job have VPC settings configured.\n\n7.111 [extra7111] Check if Amazon SageMaker Notebook instances have direct internet access\n\n7.112 [extra7112] Check if Amazon SageMaker Notebook instances have data encryption enabled\n\n7.113 [extra7113] Check if RDS instances have deletion protection enabled (Not Scored) (Not part of CIS benchmark)\n\n7.114 [extra7114] Check if Glue development endpoints have S3 encryption enabled.\n\n7.115 [extra7115] Check if Glue database connection has SSL connection enabled.\n\n7.116 [extra7116] Check if Glue data catalog settings have metadata encryption enabled.\n\n7.117 [extra7117] Check if Glue data catalog settings have encrypt connection password enabled.\n\n7.118 [extra7118] Check if Glue ETL Jobs have S3 encryption enabled.\n\n7.119 [extra7119] Check if Glue development endpoints have CloudWatch logs encryption enabled.\n\n7.120 [extra7120] Check if Glue ETL Jobs have CloudWatch Logs encryption enabled.\n\n7.121 [extra7121] Check if Glue development endpoints have Job bookmark encryption enabled.\n\n7.122 [extra7122] Check if Glue ETL Jobs have Job bookmark encryption enabled.\n\n7.123 [extra7123] Check if IAM users have two active access keys\n\n7.124 [extra7124] Check if EC2 instances are managed by Systems Manager.\n\n7.125 [extra7125] Check if IAM users have Hardware MFA enabled.\n\n7.126 [extra7126] Check if there are CMK KMS keys not used\n\n7.127 [extra7127] Check if EC2 instances managed by Systems Manager are compliant with patching requirements\n\n7.128 [extra7128] Check if DynamoDB table has encryption at rest enabled using CMK KMS\n\n7.129 [extra7129] Check if Application Load Balancer has a WAF ACL attached\n\n7.130 [extra7130] Ensure there are no SNS Topics unencrypted\n\n7.131 [extra7131] Ensure RDS instances have minor version upgrade enabled\n\n7.132 [extra7132] Check if RDS instances has enhanced monitoring enabled\n\n7.133 [extra7133] Check if RDS instances have multi-AZ enabled', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"extras\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '017'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('350a097a-dfeb-4fd0-a3af-49049da5c025', 'AWS 8.0 Forensics Readiness', 1, 'HighRisk', 'AWS 8.0 Forensics Readiness - [forensics-ready]', '8.0 Forensics Readiness - [forensics-ready] ************************\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.2  [check22] Ensure CloudTrail log file validation is enabled (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.4  [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs (Scored)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n2.6  [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket (Scored)\n\n2.7  [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)\n\n7.12 [extra712] Check if Amazon Macie is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.13 [extra713] Check if GuardDuty is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.14 [extra714] Check if CloudFront distributions have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.15 [extra715] Check if Amazon Elasticsearch Service (ES) domains have logging enabled\n\n7.17 [extra717] Check if Elastic Load Balancers have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.18 [extra718] Check if S3 buckets have server access logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.19 [extra719] Check if Route53 public hosted zones are logging queries to CloudWatch Logs (Not Scored) (Not part of CIS benchmark)\n\n7.20 [extra720] Check if Lambda functions invoke API operations are being recorded by CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.21 [extra721] Check if Redshift cluster has audit logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.22 [extra722] Check if API Gateway has logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.25 [extra725] Check if S3 buckets have Object-level logging enabled in CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.101 [extra7101] Check if Amazon Elasticsearch Service (ES) domains have audit logging enabled\n\n7.94 [extra794] Ensure EKS Control Plane Audit Logging is enabled for all log types', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"forensics-ready\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '018'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('fa60960a-0e38-4502-9834-1ab1277e9aaa', 'AWS 9.0 GDPR Readiness', 1, 'HighRisk', 'AWS 9.0 GDPR Readiness - ONLY AS REFERENCE - [gdpr]', '9.0 GDPR Readiness - ONLY AS REFERENCE - [gdpr] ********************\n\n7.18 [extra718] Check if S3 buckets have server access logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.25 [extra725] Check if S3 buckets have Object-level logging enabled in CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.27 [extra727] Check if SQS queues have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n1.14  [check114] Ensure hardware MFA is enabled for the root account (Scored)\n\n7.1 [extra71] Ensure users of groups with AdministratorAccess policy have MFA tokens enabled (Not Scored) (Not part of CIS benchmark)\n\n7.31 [extra731] Check if SNS topics have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.32 [extra732] Check if Geo restrictions are enabled in CloudFront distributions (Not Scored) (Not part of CIS benchmark)\n\n7.33 [extra733] Check if there are SAML Providers then STS can be used (Not Scored) (Not part of CIS benchmark)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n3.9  [check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes (Scored)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.2  [check22] Ensure CloudTrail log file validation is enabled (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.4  [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs (Scored)\n\n2.6  [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket (Scored)\n\n2.7  [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs (Scored)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored)\n\n7.26 [extra726] Check Trusted Advisor for errors and warnings (Not Scored) (Not part of CIS benchmark)\n\n7.14 [extra714] Check if CloudFront distributions have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.15 [extra715] Check if Amazon Elasticsearch Service (ES) domains have logging enabled\n\n7.17 [extra717] Check if Elastic Load Balancers have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.19 [extra719] Check if Route53 public hosted zones are logging queries to CloudWatch Logs (Not Scored) (Not part of CIS benchmark)\n\n7.20 [extra720] Check if Lambda functions invoke API operations are being recorded by CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.21 [extra721] Check if Redshift cluster has audit logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.22 [extra722] Check if API Gateway has logging enabled (Not Scored) (Not part of CIS benchmark)\n\n4.3  [check43] Ensure the default security group of every VPC restricts all traffic (Scored)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n7.14 [extra714] Check if CloudFront distributions have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.29 [extra729] Ensure there are no EBS Volumes unencrypted (Not Scored) (Not part of CIS benchmark)\n\n7.34 [extra734] Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it (Not Scored) (Not part of CIS benchmark)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.36 [extra736] Check exposed KMS keys (Not Scored) (Not part of CIS benchmark)\n\n7.38 [extra738] Check if CloudFront distributions are set to HTTPS (Not Scored) (Not part of CIS benchmark)\n\n7.40 [extra740] Check if EBS snapshots are encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.61 [extra761] Check if EBS Default Encryption is activated (Not Scored) (Not part of CIS benchmark)\n\n1.1  [check11] Avoid the use of the root account (Scored)\n\n1.10  [check110] Ensure IAM password policy prevents password reuse: 24 or greater (Scored)\n\n1.11  [check111] Ensure IAM password policy expires passwords within 90 days or less (Scored)\n\n1.12  [check112] Ensure no root account access key exists (Scored)\n\n1.16  [check116] Ensure IAM policies are attached only to groups or roles (Scored)\n\n1.20  [check120] Ensure a support role has been created to manage incidents with AWS Support (Scored)\n\n1.22  [check122] Ensure IAM policies that allow full \"*:*\" administrative privileges are not created (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored)\n\n1.5  [check15] Ensure IAM password policy requires at least one uppercase letter (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.7  [check17] Ensure IAM password policy require at least one symbol (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n2.8  [check28] Ensure rotation for customer created KMS CMKs is enabled (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored)\n\n3.10  [check310] Ensure a log metric filter and alarm exist for security group changes (Scored)\n\n3.11  [check311] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL) (Scored)\n\n3.12  [check312] Ensure a log metric filter and alarm exist for changes to network gateways (Scored)\n\n3.13  [check313] Ensure a log metric filter and alarm exist for route table changes (Scored)\n\n3.14  [check314] Ensure a log metric filter and alarm exist for VPC changes (Scored)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored)\n\n7.11 [extra711] Check for Publicly Accessible Redshift Clusters (Not Scored) (Not part of CIS benchmark)\n\n7.2 [extra72] Ensure there are no EBS Snapshots set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.23 [extra723] Check if RDS Snapshots and Cluster Snapshots are public (Not Scored) (Not part of CIS benchmark)\n\n7.30 [extra730] Check if ACM Certificates are about to expire in 7 days or less (Not Scored) (Not part of CIS benchmark)\n\n7.39 [extra739] Check if RDS instances have backup enabled (Not Scored) (Not part of CIS benchmark)\n\n7.6 [extra76] Ensure there are no EC2 AMIs set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.63 [extra763] Check if S3 buckets have object versioning enabled (Not Scored) (Not part of CIS benchmark)\n\n7.78 [extra778] Find VPC security groups with wide-open public IPv4 CIDR ranges (non-RFC1918) (Not Scored) (Not part of CIS benchmark)\n\n7.8 [extra78] Ensure there are no Public Accessible RDS instances (Not Scored) (Not part of CIS benchmark)\n\n7.92 [extra792] Check if Elastic Load Balancers have insecure SSL ciphers (Not Scored) (Not part of CIS benchmark)\n\n7.98 [extra798] Check if Lambda functions have resource-based policy set as Public', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"gdpr\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '019'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('39c87069-a3c6-4ab3-9974-f844a89872b5', 'AWS 10.0 HIPAA Compliance', 1, 'HighRisk', 'AWS 10.0 HIPAA Compliance - ONLY AS REFERENCE - [hipaa]', '10.0 HIPAA Compliance - ONLY AS REFERENCE - [hipaa] ****************\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.6  [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket (Scored)\n\n2.7  [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)\n\n7.18 [extra718] Check if S3 buckets have server access logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.25 [extra725] Check if S3 buckets have Object-level logging enabled in CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.2 [extra72] Ensure there are no EBS Snapshots set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.5 [extra75] Ensure there are no Security Groups not being used (Not Scored) (Not part of CIS benchmark)\n\n7.17 [extra717] Check if Elastic Load Balancers have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.29 [extra729] Ensure there are no EBS Volumes unencrypted (Not Scored) (Not part of CIS benchmark)\n\n7.34 [extra734] Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it (Not Scored) (Not part of CIS benchmark)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n7.3 [extra73] Ensure there are no S3 buckets open to Everyone or Any AWS user (Not Scored) (Not part of CIS benchmark)\n\n7.40 [extra740] Check if EBS snapshots are encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark)\n\n1.12  [check112] Ensure no root account access key exists (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.5  [check15] Ensure IAM password policy requires at least one uppercase letter (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.7  [check17] Ensure IAM password policy require at least one symbol (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.4  [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs (Scored)\n\n2.8  [check28] Ensure rotation for customer created KMS CMKs is enabled (Scored)\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored)\n\n3.10  [check310] Ensure a log metric filter and alarm exist for security group changes (Scored)\n\n3.11  [check311] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL) (Scored)\n\n3.12  [check312] Ensure a log metric filter and alarm exist for changes to network gateways (Scored)\n\n3.13  [check313] Ensure a log metric filter and alarm exist for route table changes (Scored)\n\n3.14  [check314] Ensure a log metric filter and alarm exist for VPC changes (Scored)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored)\n\n3.9  [check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes (Scored)\n\n7.92 [extra792] Check if Elastic Load Balancers have insecure SSL ciphers (Not Scored) (Not part of CIS benchmark)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"hipaa\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '020'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('10754933-241e-42db-bb3c-42e13cb40b0f', 'AWS 11.0 Look for keys secrets or passwords', 1, 'HighRisk', 'AWS 11.0 Look for keys secrets or passwords around resources - [secrets]', '11.0 Look for keys secrets or passwords around resources - [secrets]\n\n7.41 [extra741] Find secrets in EC2 User Data (Not Scored) (Not part of CIS benchmark)\n\n7.42 [extra742] Find secrets in CloudFormation outputs (Not Scored) (Not part of CIS benchmark)\n\n7.59 [extra759] Find secrets in Lambda functions variables (Not Scored) (Not part of CIS benchmark)\n\n7.60 [extra760] Find secrets in Lambda functions code (Not Scored) (Not part of CIS benchmark)\n\n7.68 [extra768] Find secrets in ECS cloudTask definitions variables (Not Scored) (Not part of CIS benchmark)\n\n7.75 [extra775] Find secrets in EC2 Auto Scaling Launch Configuration (Not Scored) (Not part of CIS benchmark)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"secrets\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '021'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('7c37887f-0b8d-444c-bad7-e43cd2b41578', 'AWS 12.0 API Gateway security checks', 1, 'HighRisk', 'AWS 12.0 API Gateway security checks - [apigateway]', '12.0 API Gateway security checks - [apigateway] ********************\n\n7.22 [extra722] Check if API Gateway has logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.43 [extra743] Check if API Gateway has client certificate enabled to access your backend endpoint (Not Scored) (Not part of CIS benchmark)\n\n7.44 [extra744] Check if API Gateway has a WAF ACL attached (Not Scored) (Not part of CIS benchmark)\n\n7.45 [extra745] Check if API Gateway endpoint is public or private (Not Scored) (Not part of CIS benchmark)\n\n7.46 [extra746] Check if API Gateway has configured authorizers (Not Scored) (Not part of CIS benchmark)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"apigateway\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '022'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('197e41e7-cbc3-4eef-b5ad-5153c9232449', 'AWS 13.0 RDS security checks', 1, 'HighRisk', 'AWS 13.0 RDS security checks - [rds]', '13.0 RDS security checks - [rds] ***********************************\n\n7.8 [extra78] Ensure there are no Public Accessible RDS instances (Not Scored) (Not part of CIS benchmark)\n\n7.23 [extra723] Check if RDS Snapshots and Cluster Snapshots are public (Not Scored) (Not part of CIS benchmark)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.39 [extra739] Check if RDS instances have backup enabled (Not Scored) (Not part of CIS benchmark)\n\n7.47 [extra747] Check if RDS instances is integrated with CloudWatch Logs  (Not Scored) (Not part of CIS benchmark)\n\n7.113 [extra7113] Check if RDS instances have deletion protection enabled (Not Scored) (Not part of CIS benchmark)\n\n7.131 [extra7131] Ensure RDS instances have minor version upgrade enabled\n\n7.132 [extra7132] Check if RDS instances has enhanced monitoring enabled\n\n7.133 [extra7133] Check if RDS instances have multi-AZ enabled', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"rds\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '022'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('4a64e90e-92ea-4d5a-a753-3c5ca92a2b95', 'AWS 14.0 Elasticsearch related security checks', 1, 'HighRisk', 'AWS 14.0 Elasticsearch related security checks - [elasticsearch]', '14.0 Elasticsearch related security checks - [elasticsearch] *******\n\n7.15 [extra715] Check if Amazon Elasticsearch Service (ES) domains have logging enabled\n\n7.16 [extra716] Check if Amazon Elasticsearch Service (ES) domains are set as Public or if it has open policy access\n\n7.79 [extra779] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports\n\n7.80 [extra780] Check if Amazon Elasticsearch Service (ES) domains has Amazon Cognito authentication for Kibana enabled\n\n7.81 [extra781] Check if Amazon Elasticsearch Service (ES) domains has encryption at-rest enabled\n\n7.82 [extra782] Check if Amazon Elasticsearch Service (ES) domains has node-to-node encryption enabled\n\n7.83 [extra783] Check if Amazon Elasticsearch Service (ES) domains has enforce HTTPS enabled\n\n7.84 [extra784] Check if Amazon Elasticsearch Service (ES) domains internal user database enabled\n\n7.85 [extra785] Check if Amazon Elasticsearch Service (ES) domains have updates available\n\n7.87 [extra787] Check connection and authentication for Internet exposed Elasticsearch/Kibana ports\n\n7.88 [extra788] Check connection and authentication for Internet exposed Amazon Elasticsearch Service (ES) domains\n\n7.101 [extra7101] Check if Amazon Elasticsearch Service (ES) domains have audit logging enabled', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"elasticsearch\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '024'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('72af2230-8555-4e0c-a06a-721436a0644e', 'AWS 15.0 PCI-DSS v3.2.1 Readiness', 1, 'HighRisk', 'AWS 15.0 PCI-DSS v3.2.1 Readiness - ONLY AS REFERENCE - [pci]', '15.0 PCI-DSS v3.2.1 Readiness - ONLY AS REFERENCE - [pci] **********\n\n1.1  [check11] Avoid the use of the root account (Scored)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored)\n\n1.5  [check15] Ensure IAM password policy requires at least one uppercase letter (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.7  [check17] Ensure IAM password policy require at least one symbol (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n1.10  [check110] Ensure IAM password policy prevents password reuse: 24 or greater (Scored)\n\n1.12  [check112] Ensure no root account access key exists (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n1.14  [check114] Ensure hardware MFA is enabled for the root account (Scored)\n\n1.16  [check116] Ensure IAM policies are attached only to groups or roles (Scored)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n2.6  [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket (Scored)\n\n2.7  [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs (Scored)\n\n2.8  [check28] Ensure rotation for customer created KMS CMKs is enabled (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)\n\n3.14  [check314] Ensure a log metric filter and alarm exist for VPC changes (Scored)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n4.3  [check43] Ensure the default security group of every VPC restricts all traffic (Scored)\n\n7.13 [extra713] Check if GuardDuty is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.17 [extra717] Check if Elastic Load Balancers have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.18 [extra718] Check if S3 buckets have server access logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.2 [extra72] Ensure there are no EBS Snapshots set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.29 [extra729] Ensure there are no EBS Volumes unencrypted (Not Scored) (Not part of CIS benchmark)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.38 [extra738] Check if CloudFront distributions are set to HTTPS (Not Scored) (Not part of CIS benchmark)\n\n7.40 [extra740] Check if EBS snapshots are encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.44 [extra744] Check if API Gateway has a WAF ACL attached (Not Scored) (Not part of CIS benchmark)\n\n7.48 [extra748] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port (Not Scored) (Not part of CIS benchmark)\n\n7.5 [extra75] Ensure there are no Security Groups not being used (Not Scored) (Not part of CIS benchmark)\n\n7.50 [extra750] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306 (Not Scored) (Not part of CIS benchmark)\n\n7.51 [extra751] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432 (Not Scored) (Not part of CIS benchmark)\n\n7.53 [extra753] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018 (Not Scored) (Not part of CIS benchmark)\n\n7.54 [extra754] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888 (Not Scored) (Not part of CIS benchmark)\n\n7.55 [extra755] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211 (Not Scored) (Not part of CIS benchmark)\n\n7.56 [extra756] Check if Redshift cluster is Public Accessible (Not Scored) (Not part of CIS benchmark)\n\n7.73 [extra773] Check if CloudFront distributions are using WAF (Not Scored) (Not part of CIS benchmark)\n\n7.8 [extra78] Ensure there are no Public Accessible RDS instances (Not Scored) (Not part of CIS benchmark)\n\n7.80 [extra780] Check if Amazon Elasticsearch Service (ES) domains has Amazon Cognito authentication for Kibana enabled\n\n7.81 [extra781] Check if Amazon Elasticsearch Service (ES) domains has encryption at-rest enabled\n\n7.82 [extra782] Check if Amazon Elasticsearch Service (ES) domains has node-to-node encryption enabled\n\n7.83 [extra783] Check if Amazon Elasticsearch Service (ES) domains has enforce HTTPS enabled\n\n7.84 [extra784] Check if Amazon Elasticsearch Service (ES) domains internal user database enabled\n\n7.85 [extra785] Check if Amazon Elasticsearch Service (ES) domains have updates available\n\n7.87 [extra787] Check connection and authentication for Internet exposed Elasticsearch/Kibana ports\n\n7.88 [extra788] Check connection and authentication for Internet exposed Amazon Elasticsearch Service (ES) domains\n\n7.98 [extra798] Check if Lambda functions have resource-based policy set as Public', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"pci\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '025'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('0a5a7796-6b53-408a-ba49-7fd9e51d82f4', 'AWS 16.0 Find cross-account trust boundaries', 1, 'HighRisk', 'AWS 16.0 Find cross-account trust boundaries - [trustboundaries]', '16.0 Find cross-account trust boundaries - [trustboundaries] *******\n\n7.89 [extra789] Find trust boundaries in VPC endpoint services connections\n\n7.90 [extra790] Find trust boundaries in VPC endpoint services whitelisted principles', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"trustboundaries\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '026'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('a944a483-c23f-4d62-bdd8-d2a20a4aaeca', 'AWS 17.0 Find resources exposed to the internet', 1, 'HighRisk', 'AWS 17.0 Find resources exposed to the internet - [internet-exposed]', '17.0 Find resources exposed to the internet - [internet-exposed] ***\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored)\n\n7.2 [extra72] Ensure there are no EBS Snapshots set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.3 [extra73] Ensure there are no S3 buckets open to Everyone or Any AWS user (Not Scored) (Not part of CIS benchmark)\n\n7.4 [extra74] Ensure there are no Security Groups without ingress filtering being used (Not Scored) (Not part of CIS benchmark)\n\n7.6 [extra76] Ensure there are no EC2 AMIs set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.7 [extra77] Ensure there are no ECR repositories set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.8 [extra78] Ensure there are no Public Accessible RDS instances (Not Scored) (Not part of CIS benchmark)\n\n7.9 [extra79] Check for internet facing Elastic Load Balancers (Not Scored) (Not part of CIS benchmark)\n\n7.10 [extra710] Check for internet facing EC2 Instances (Not Scored) (Not part of CIS benchmark)\n\n7.11 [extra711] Check for Publicly Accessible Redshift Clusters (Not Scored) (Not part of CIS benchmark)\n\n7.16 [extra716] Check if Amazon Elasticsearch Service (ES) domains are set as Public or if it has open policy access\n\n7.23 [extra723] Check if RDS Snapshots and Cluster Snapshots are public (Not Scored) (Not part of CIS benchmark)\n\n7.27 [extra727] Check if SQS queues have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.31 [extra731] Check if SNS topics have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.36 [extra736] Check exposed KMS keys (Not Scored) (Not part of CIS benchmark)\n\n7.38 [extra738] Check if CloudFront distributions are set to HTTPS (Not Scored) (Not part of CIS benchmark)\n\n7.45 [extra745] Check if API Gateway endpoint is public or private (Not Scored) (Not part of CIS benchmark)\n\n7.48 [extra748] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port (Not Scored) (Not part of CIS benchmark)\n\n7.49 [extra749] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483 (Not Scored) (Not part of CIS benchmark)\n\n7.50 [extra750] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306 (Not Scored) (Not part of CIS benchmark)\n\n7.51 [extra751] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432 (Not Scored) (Not part of CIS benchmark)\n\n7.52 [extra752] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379 (Not Scored) (Not part of CIS benchmark)\n\n7.53 [extra753] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018 (Not Scored) (Not part of CIS benchmark)\n\n7.54 [extra754] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888 (Not Scored) (Not part of CIS benchmark)\n\n7.55 [extra755] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211 (Not Scored) (Not part of CIS benchmark)\n\n7.56 [extra756] Check if Redshift cluster is Public Accessible (Not Scored) (Not part of CIS benchmark)\n\n7.70 [extra770] Check for internet facing EC2 instances with Instance Profiles attached (Not Scored) (Not part of CIS benchmark)\n\n7.71 [extra771] Check if S3 buckets have policies which allow WRITE access (Not Scored) (Not part of CIS benchmark)\n\n7.78 [extra778] Find VPC security groups with wide-open public IPv4 CIDR ranges (non-RFC1918) (Not Scored) (Not part of CIS benchmark)\n\n7.79 [extra779] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Elasticsearch/Kibana ports\n\n7.87 [extra787] Check connection and authentication for Internet exposed Elasticsearch/Kibana ports\n\n7.88 [extra788] Check connection and authentication for Internet exposed Amazon Elasticsearch Service (ES) domains\n\n7.95 [extra795] Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled\n\n7.96 [extra796] Restrict Access to the EKS Control Plane Endpoint\n\n7.98 [extra798] Check if Lambda functions have resource-based policy set as Public\n\n7.102 [extra7102] Check if any of the Elastic or Public IP are in Shodan (requires Shodan API KEY)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"internet-exposed\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '027'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('9b1d1a9c-6c7e-44db-a15c-c0c82b1040eb', 'AWS 18.0 ISO 27001:2013 Readiness', 1, 'HighRisk', 'AWS 18.0 ISO 27001:2013 Readiness - ONLY AS REFERENCE - [iso27001]', '18.0 ISO 27001:2013 Readiness - ONLY AS REFERENCE - [iso27001] *****\n\n1.1  [check11] Avoid the use of the root account (Scored)\n\n1.10  [check110] Ensure IAM password policy prevents password reuse: 24 or greater (Scored)\n\n1.11  [check111] Ensure IAM password policy expires passwords within 90 days or less (Scored)\n\n1.12  [check112] Ensure no root account access key exists (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n1.14  [check114] Ensure hardware MFA is enabled for the root account (Scored)\n\n1.15 [check115] Ensure security questions are registered in the AWS account (Not Scored)\n\n1.16  [check116] Ensure IAM policies are attached only to groups or roles (Scored)\n\n1.19 [check119] Ensure IAM instance roles are used for AWS resource access from instances (Not Scored)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.22  [check122] Ensure IAM policies that allow full \"*:*\" administrative privileges are not created (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored)\n\n1.5  [check15] Ensure IAM password policy requires at least one uppercase letter (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.7  [check17] Ensure IAM password policy require at least one symbol (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.2  [check22] Ensure CloudTrail log file validation is enabled (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.4  [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs (Scored)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n2.6  [check26] Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket (Scored)\n\n2.7  [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs (Scored)\n\n2.8  [check28] Ensure rotation for customer created KMS CMKs is enabled (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored)\n\n3.10  [check310] Ensure a log metric filter and alarm exist for security group changes (Scored)\n\n3.11  [check311] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL) (Scored)\n\n3.12  [check312] Ensure a log metric filter and alarm exist for changes to network gateways (Scored)\n\n3.13  [check313] Ensure a log metric filter and alarm exist for route table changes (Scored)\n\n3.14  [check314] Ensure a log metric filter and alarm exist for VPC changes (Scored)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n3.9  [check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes (Scored)\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored)\n\n4.3  [check43] Ensure the default security group of every VPC restricts all traffic (Scored)\n\n4.4 [check44] Ensure routing tables for VPC peering are \"least access\" (Not Scored)\n\n7.1 [extra71] Ensure users of groups with AdministratorAccess policy have MFA tokens enabled (Not Scored) (Not part of CIS benchmark)\n\n7.10 [extra710] Check for internet facing EC2 Instances (Not Scored) (Not part of CIS benchmark)\n\n7.100 [extra7100] Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *)\n\n7.11 [extra711] Check for Publicly Accessible Redshift Clusters (Not Scored) (Not part of CIS benchmark)\n\n7.113 [extra7113] Check if RDS instances have deletion protection enabled (Not Scored) (Not part of CIS benchmark)\n\n7.123 [extra7123] Check if IAM users have two active access keys\n\n7.125 [extra7125] Check if IAM users have Hardware MFA enabled.\n\n7.126 [extra7126] Check if there are CMK KMS keys not used\n\n7.128 [extra7128] Check if DynamoDB table has encryption at rest enabled using CMK KMS\n\n7.129 [extra7129] Check if Application Load Balancer has a WAF ACL attached\n\n7.13 [extra713] Check if GuardDuty is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.14 [extra714] Check if CloudFront distributions have logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.130 [extra7130] Ensure there are no SNS Topics unencrypted\n\n7.18 [extra718] Check if S3 buckets have server access logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.19 [extra719] Check if Route53 public hosted zones are logging queries to CloudWatch Logs (Not Scored) (Not part of CIS benchmark)\n\n7.2 [extra72] Ensure there are no EBS Snapshots set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.20 [extra720] Check if Lambda functions invoke API operations are being recorded by CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.21 [extra721] Check if Redshift cluster has audit logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.22 [extra722] Check if API Gateway has logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.23 [extra723] Check if RDS Snapshots and Cluster Snapshots are public (Not Scored) (Not part of CIS benchmark)\n\n7.24 [extra724] Check if ACM certificates have Certificate Transparency logging enabled (Not Scored) (Not part of CIS benchmark)\n\n7.25 [extra725] Check if S3 buckets have Object-level logging enabled in CloudTrail (Not Scored) (Not part of CIS benchmark)\n\n7.26 [extra726] Check Trusted Advisor for errors and warnings (Not Scored) (Not part of CIS benchmark)\n\n7.27 [extra727] Check if SQS queues have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.28 [extra728] Check if SQS queues have Server Side Encryption enabled (Not Scored) (Not part of CIS benchmark)\n\n7.29 [extra729] Ensure there are no EBS Volumes unencrypted (Not Scored) (Not part of CIS benchmark)\n\n7.31 [extra731] Check if SNS topics have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.3 [extra73] Ensure there are no S3 buckets open to Everyone or Any AWS user (Not Scored) (Not part of CIS benchmark)\n\n7.31 [extra731] Check if SNS topics have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.39 [extra739] Check if RDS instances have backup enabled (Not Scored) (Not part of CIS benchmark)\n\n7.4 [extra74] Ensure there are no Security Groups without ingress filtering being used (Not Scored) (Not part of CIS benchmark)\n\n7.41 [extra741] Find secrets in EC2 User Data (Not Scored) (Not part of CIS benchmark)\n\n7.47 [extra747] Check if RDS instances is integrated with CloudWatch Logs  (Not Scored) (Not part of CIS benchmark)\n\n7.48 [extra748] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to any port (Not Scored) (Not part of CIS benchmark)\n\n7.5 [extra75] Ensure there are no Security Groups not being used (Not Scored) (Not part of CIS benchmark)\n\n7.56 [extra756] Check if Redshift cluster is Public Accessible (Not Scored) (Not part of CIS benchmark)\n\n7.57 [extra757] Check EC2 Instances older than 6 months (Not Scored) (Not part of CIS benchmark)\n\n7.58 [extra758] Check EC2 Instances older than 12 months (Not Scored) (Not part of CIS benchmark)\n\n7.59 [extra759] Find secrets in Lambda functions variables (Not Scored) (Not part of CIS benchmark)\n\n7.6 [extra76] Ensure there are no EC2 AMIs set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.60 [extra760] Find secrets in Lambda functions code (Not Scored) (Not part of CIS benchmark)\n\n7.61 [extra761] Check if EBS Default Encryption is activated (Not Scored) (Not part of CIS benchmark)\n\n7.62 [extra762] Find obsolete Lambda runtimes (Not Scored) (Not part of CIS benchmark)\n\n7.63 [extra763] Check if S3 buckets have object versioning enabled (Not Scored) (Not part of CIS benchmark)\n\n7.64 [extra764] Check if S3 buckets have secure transport policy (Not Scored) (Not part of CIS benchmark)\n\n7.65 [extra765] Check if ECR image scan on push is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.67 [extra767] Check if CloudFront distributions have Field Level Encryption enabled (Not Scored) (Not part of CIS benchmark)\n\n7.68 [extra768] Find secrets in ECS cloudTask definitions variables (Not Scored) (Not part of CIS benchmark)\n\n7.69 [extra769] Check if IAM Access Analyzer is enabled and its findings (Not Scored) (Not part of CIS benchmark)\n\n7.7 [extra77] Ensure there are no ECR repositories set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.71 [extra771] Check if S3 buckets have policies which allow WRITE access (Not Scored) (Not part of CIS benchmark)\n\n7.72 [extra772] Check if elastic IPs are unused (Not Scored) (Not part of CIS benchmark)\n\n7.74 [extra774] Ensure credentials unused for 30 days or greater are disabled\n\n7.76 [extra776] Check if ECR image scan found vulnerabilities in the newest image version (Not Scored) (Not part of CIS benchmark)\n\n7.77 [extra777] Find VPC security groups with many ingress or egress rules (Not Scored) (Not part of CIS benchmark)\n\n7.78 [extra778] Find VPC security groups with wide-open public IPv4 CIDR ranges (non-RFC1918) (Not Scored) (Not part of CIS benchmark)\n\n7.8 [extra78] Ensure there are no Public Accessible RDS instances (Not Scored) (Not part of CIS benchmark)\n\n7.89 [extra789] Find trust boundaries in VPC endpoint services connections\n\n7.9 [extra79] Check for internet facing Elastic Load Balancers (Not Scored) (Not part of CIS benchmark)\n\n7.90 [extra790] Find trust boundaries in VPC endpoint services whitelisted principles\n\n7.92 [extra792] Check if Elastic Load Balancers have insecure SSL ciphers (Not Scored) (Not part of CIS benchmark)\n\n7.93 [extra793] Check if Elastic Load Balancers have SSL listeners (Not Scored) (Not part of CIS benchmark)\n\n7.94 [extra794] Ensure EKS Control Plane Audit Logging is enabled for all log types\n\n7.95 [extra795] Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled\n\n7.96 [extra796] Restrict Access to the EKS Control Plane Endpoint\n\n7.98 [extra798] Check if Lambda functions have resource-based policy set as Public', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"iso27001\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '028'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('0d51321e-e26c-4147-b730-5b1403384487', 'AWS 19.0 CIS EKS Benchmark', 1, 'HighRisk', 'AWS 19.0 CIS EKS Benchmark - [eks-cis]', '19.0 CIS EKS Benchmark - [eks-cis] *********************************\n\n7.65 [extra765] Check if ECR image scan on push is enabled (Not Scored) (Not part of CIS benchmark)\n\n7.94 [extra794] Ensure EKS Control Plane Audit Logging is enabled for all log types\n\n7.95 [extra795] Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled\n\n7.96 [extra796] Restrict Access to the EKS Control Plane Endpoint\n\n7.97 [extra797] Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"eks-cis\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '029'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('0d6270fc-3744-42cd-a850-65ac0b8ef514', 'AWS 20.0 FFIEC Cybersecurity Readiness', 1, 'HighRisk', 'AWS 20.0 FFIEC Cybersecurity Readiness - ONLY AS REFERENCE - [ffiec]', '20.0 FFIEC Cybersecurity Readiness - ONLY AS REFERENCE - [ffiec] ***\n\n1.1  [check11] Avoid the use of the root account (Scored)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored)\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n3.9  [check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes (Scored)\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored)\n\n4.3  [check43] Ensure the default security group of every VPC restricts all traffic (Scored)\n\n1.10  [check110] Ensure IAM password policy prevents password reuse: 24 or greater (Scored)\n\n1.12  [check112] Ensure no root account access key exists (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n1.16  [check116] Ensure IAM policies are attached only to groups or roles (Scored)\n\n3.10  [check310] Ensure a log metric filter and alarm exist for security group changes (Scored)\n\n3.11  [check311] Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL) (Scored)\n\n3.12  [check312] Ensure a log metric filter and alarm exist for changes to network gateways (Scored)\n\n3.13  [check313] Ensure a log metric filter and alarm exist for route table changes (Scored)\n\n3.14  [check314] Ensure a log metric filter and alarm exist for VPC changes (Scored)\n\n7.2 [extra72] Ensure there are no EBS Snapshots set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.6 [extra76] Ensure there are no EC2 AMIs set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.8 [extra78] Ensure there are no Public Accessible RDS instances (Not Scored) (Not part of CIS benchmark)\n\n7.11 [extra711] Check for Publicly Accessible Redshift Clusters (Not Scored) (Not part of CIS benchmark)\n\n7.23 [extra723] Check if RDS Snapshots and Cluster Snapshots are public (Not Scored) (Not part of CIS benchmark)\n\n7.29 [extra729] Ensure there are no EBS Volumes unencrypted (Not Scored) (Not part of CIS benchmark)\n\n7.31 [extra731] Check if SNS topics have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.34 [extra734] Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it (Not Scored) (Not part of CIS benchmark)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.63 [extra763] Check if S3 buckets have object versioning enabled (Not Scored) (Not part of CIS benchmark)\n\n7.92 [extra792] Check if Elastic Load Balancers have insecure SSL ciphers (Not Scored) (Not part of CIS benchmark)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"ffiec\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '030'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('c1375dfe-c0b1-4e53-9c2b-6a0f29258a08', 'AWS 21.0 SOC2 Readiness', 1, 'HighRisk', 'AWS 21.0 SOC2 Readiness - ONLY AS REFERENCE - [soc2]', '21.0 SOC2 Readiness - ONLY AS REFERENCE - [soc2] ***\n\n1.10  [check110] Ensure IAM password policy prevents password reuse: 24 or greater (Scored)\n\n1.11  [check111] Ensure IAM password policy expires passwords within 90 days or less (Scored)\n\n1.13  [check113] Ensure MFA is enabled for the root account (Scored)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored)\n\n1.22  [check122] Ensure IAM policies that allow full \"*:*\" administrative privileges are not created (Scored)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored)\n\n1.5  [check15] Ensure IAM password policy requires at least one uppercase letter (Scored)\n\n1.6  [check16] Ensure IAM password policy require at least one lowercase letter (Scored)\n\n1.7  [check17] Ensure IAM password policy require at least one symbol (Scored)\n\n1.8  [check18] Ensure IAM password policy require at least one number (Scored)\n\n1.9  [check19] Ensure IAM password policy requires minimum length of 14 or greater (Scored)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored)\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored)\n\n3.10  [check310] Ensure a log metric filter and alarm exist for security group changes (Scored)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored)\n\n3.8  [check38] Ensure a log metric filter and alarm exist for S3 bucket policy changes (Scored)\n\n3.9  [check39] Ensure a log metric filter and alarm exist for AWS Config configuration changes (Scored)\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored)\n\n4.3  [check43] Ensure the default security group of every VPC restricts all traffic (Scored)\n\n7.11 [extra711] Check for Publicly Accessible Redshift Clusters (Not Scored) (Not part of CIS benchmark)\n\n7.2 [extra72] Ensure there are no EBS Snapshots set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.23 [extra723] Check if RDS Snapshots and Cluster Snapshots are public (Not Scored) (Not part of CIS benchmark)\n\n7.29 [extra729] Ensure there are no EBS Volumes unencrypted (Not Scored) (Not part of CIS benchmark)\n\n7.31 [extra731] Check if SNS topics have policy set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.34 [extra734] Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it (Not Scored) (Not part of CIS benchmark)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark)\n\n7.39 [extra739] Check if RDS instances have backup enabled (Not Scored) (Not part of CIS benchmark)\n\n7.6 [extra76] Ensure there are no EC2 AMIs set as Public (Not Scored) (Not part of CIS benchmark)\n\n7.8 [extra78] Ensure there are no Public Accessible RDS instances (Not Scored) (Not part of CIS benchmark)\n\n7.92 [extra792] Check if Elastic Load Balancers have insecure SSL ciphers (Not Scored) (Not part of CIS benchmark)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"soc2\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '031'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('1ab302fb-1b06-410a-b17a-fdf7843d6182', 'AWS 22.0 Amazon SageMaker related security checks', 1, 'HighRisk', 'AWS 22.0 Amazon SageMaker related security checks - [sagemaker]', '22.0 Amazon SageMaker related security checks - [sagemaker] ********\n\n7.103 [extra7103] Check if Amazon SageMaker Notebook instances have root access disabled\n\n7.104 [extra7104] Check if Amazon SageMaker Notebook instances have VPC settings configured\n\n7.111 [extra7111] Check if Amazon SageMaker Notebook instances have direct internet access\n\n7.112 [extra7112] Check if Amazon SageMaker Notebook instances have data encryption enabled\n\n7.105 [extra7105] Check if Amazon SageMaker Models have network isolation enabled\n\n7.106 [extra7106] Check if Amazon SageMaker Models have VPC settings configured\n\n7.107 [extra7107] Check if Amazon SageMaker Training jobs have intercontainer encryption enabled\n\n7.108 [extra7108] Check if Amazon SageMaker Training jobs have volume and output with KMS encryption enabled\n\n7.109 [extra7109] Check if Amazon SageMaker Training jobs have network isolation enabled\n\n7.110 [extra7110] Check if Amazon SageMaker Training job have VPC settings configured.', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"sagemaker\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '032'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f38d83c9-c4b9-47b8-8135-f9bdf96cf8ec', 'AWS 23.0 ENS Esquema Nacional', 1, 'HighRisk', 'AWS 23.0 ENS Esquema Nacional de Seguridad security checks - [ens]', '23.0 ENS Esquema Nacional de Seguridad security checks - [ens] *****\n\n7.33 [extra733] Check if there are SAML Providers then STS can be used (Not Scored) (Not part of CIS benchmark) (ens-op.acc.1.aws.iam.1)\n\n7.123 [extra7123] Check if IAM users have two active access keys (ens-op.acc.1.aws.iam.2)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored) (ens-op.acc.1.aws.iam.3 ens-op.acc.5.aws.iam.4)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored) (ens-op.acc.1.aws.iam.4 ens-op.acc.5.aws.iam.3)\n\n1.21 [check121] Do not setup access keys during initial user setup for all IAM users that have a console password (Not Scored) (ens-op.acc.1.aws.iam.5)\n\n7.100 [extra7100] Ensure that no custom IAM policies exist which allow permissive role assumption (e.g. sts:AssumeRole on *) (ens-op.acc.2.aws.iam.1)\n\n1.20  [check120] Ensure a support role has been created to manage incidents with AWS Support (Scored) (ens-op.acc.1.aws.iam.4)\n\n1.16  [check116] Ensure IAM policies are attached only to groups or roles (Scored) (ens-op.acc.3.aws.iam.1)\n\n7.124 [extra7124] Check if EC2 instances are managed by Systems Manager. (ens-op.exp.1.aws.sys.1 ens-op.acc.4.aws.sys.1)\n\n1.2  [check12] Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password (Scored) (ens-op.acc.5.aws.iam.1)\n\n7.125 [extra7125] Check if IAM users have Hardware MFA enabled. (ens-op.acc.5.aws.iam.2)\n\n1.4  [check14] Ensure access keys are rotated every 90 days or less (Scored) (ens-op.acc.1.aws.iam.4 ens-op.acc.5.aws.iam.3)\n\n1.3  [check13] Ensure credentials unused for 90 days or greater are disabled (Scored) (ens-op.acc.1.aws.iam.3 ens-op.acc.5.aws.iam.4)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored) (ens-op.acc.7.aws.iam.1 ens-op.mon.1.aws.trail.1)\n\n2.5  [check25] Ensure AWS Config is enabled in all regions (Scored) (ens-op.exp.1.aws.cfg.1)\n\n7.127 [extra7127] Check if EC2 instances managed by Systems Manager are compliant with patching requirements (ens-op.exp.1.aws.sys.1 ens-op.exp.4.aws.sys.1)\n\n3.5  [check35] Ensure a log metric filter and alarm exist for CloudTrail configuration changes (Scored) (ens-op.exp.8.aws.trail.1)\n\n2.4  [check24] Ensure CloudTrail trails are integrated with CloudWatch Logs (Scored) (ens-op.exp.8.aws.cw.1)\n\n3.1  [check31] Ensure a log metric filter and alarm exist for unauthorized API calls (Scored) (ens-op.exp.8.aws.trail.2)\n\n3.6  [check36] Ensure a log metric filter and alarm exist for AWS Management Console authentication failures (Scored) (ens-op.exp.8.aws.trail.3)\n\n3.2  [check32] Ensure a log metric filter and alarm exist for Management Console sign-in without MFA (Scored) (ens-op.exp.8.aws.trail.4)\n\n3.3  [check33] Ensure a log metric filter and alarm exist for usage of root account (Scored) (ens-op.exp.8.aws.trail.5)\n\n3.4  [check34] Ensure a log metric filter and alarm exist for IAM policy changes (Scored) (ens-op.exp.8.aws.trail.6)\n\n2.2  [check22] Ensure CloudTrail log file validation is enabled (Scored) (ens-op.exp.10.aws.trail.1)\n\n7.1 [extra71] Ensure users of groups with AdministratorAccess policy have MFA tokens enabled (Not Scored) (Not part of CIS benchmark) (ens-op.exp.10.aws.trail.2)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored) (ens-op.exp.10.aws.trail.3 ens-op.exp.10.aws.trail.4)\n\n2.3  [check23] Ensure the S3 bucket CloudTrail logs to is not publicly accessible (Scored) (ens-op.exp.10.aws.trail.3 ens-op.exp.10.aws.trail.4)\n\n2.7  [check27] Ensure CloudTrail logs are encrypted at rest using KMS CMKs (Scored) (ens-op.exp.10.aws.trail.5)\n\n3.7  [check37] Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created KMS CMKs (Scored) (ens-op.exp.11.aws.kms.1)\n\n7.36 [extra736] Check exposed KMS keys (Not Scored) (Not part of CIS benchmark) (ens-op.exp.11.aws.kms.2)\n\n7.37 [extra737] Check KMS keys with key rotation disabled (Not Scored) (Not part of CIS benchmark) (ens-op.exp.11.aws.kms.3)\n\n7.13 [extra713] Check if GuardDuty is enabled (Not Scored) (Not part of CIS benchmark) (ens-op.mon.1.aws.duty.1)\n\n2.1  [check21] Ensure CloudTrail is enabled in all regions (Scored) (ens-op.acc.7.aws.iam.1 ens-op.mon.1.aws.trail.1)\n\n2.9  [check29] Ensure VPC Flow Logging is Enabled in all VPCs (Scored) (ens-op.mon.1.aws.flow.1)\n\n7.93 [extra793] Check if Elastic Load Balancers have SSL listeners (Not Scored) (Not part of CIS benchmark) (ens-mp.com.2.aws.elb.1)\n\n7.92 [extra792] Check if Elastic Load Balancers have insecure SSL ciphers (Not Scored) (Not part of CIS benchmark) (ens-mp.com.2.aws.elb.2)\n\n7.64 [extra764] Check if S3 buckets have secure transport policy (Not Scored) (Not part of CIS benchmark) (ens-mp.com.2.aws.s3.1)\n\n7.38 [extra738] Check if CloudFront distributions are set to HTTPS (Not Scored) (Not part of CIS benchmark) (ens-mp.com.2.aws.front.1)\n\n4.3  [check43] Ensure the default security group of every VPC restricts all traffic (Scored) (ens-mp.com.4.aws.sg.1)\n\n7.4 [extra74] Ensure there are no Security Groups without ingress filtering being used (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.2)\n\n7.10 [extra710] Check for internet facing EC2 Instances (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.vpc.1)\n\n7.5 [extra75] Ensure there are no Security Groups not being used (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.3)\n\n4.1  [check41] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 22 (Scored) (ens-mp.com.4.aws.sg.4)\n\n4.2  [check42] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to port 3389 (Scored) (ens-mp.com.4.aws.sg.5)\n\n7.49 [extra749] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Oracle ports 1521 or 2483 (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.6)\n\n7.50 [extra750] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MySQL port 3306 (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.7)\n\n7.51 [extra751] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Postgres port 5432 (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.8)\n\n7.52 [extra752] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Redis port 6379 (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.9)\n\n7.53 [extra753] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to MongoDB ports 27017 and 27018 (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.10)\n\n7.54 [extra754] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Cassandra ports 7199 or 9160 or 8888 (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.11)\n\n7.55 [extra755] Ensure no security groups allow ingress from 0.0.0.0/0 or ::/0 to Memcached port 11211 (Not Scored) (Not part of CIS benchmark) (ens-mp.com.4.aws.sg.12)\n\n7.128 [extra7128] Check if DynamoDB table has encryption at rest enabled using CMK KMS (ens-mp.info.3.aws.dyndb.1)\n\n7.29 [extra729] Ensure there are no EBS Volumes unencrypted (Not Scored) (Not part of CIS benchmark) (ens-mp.info.3.aws.ebs.1)\n\n7.61 [extra761] Check if EBS Default Encryption is activated (Not Scored) (Not part of CIS benchmark) (ens-mp.info.3.aws.ebs.2)\n\n7.40 [extra740] Check if EBS snapshots are encrypted (Not Scored) (Not part of CIS benchmark) (ens-mp.info.3.aws.ebs.3)\n\n7.35 [extra735] Check if RDS instances storage is encrypted (Not Scored) (Not part of CIS benchmark) (ens-mp.info.3.aws.rds.1)\n\n7.34 [extra734] Check if S3 buckets have default encryption (SSE) enabled or use a bucket policy to enforce it (Not Scored) (Not part of CIS benchmark) (ens-mp.info.3.s3.1)\n\n7.28 [extra728] Check if SQS queues have Server Side Encryption enabled (Not Scored) (Not part of CIS benchmark) (ens-mp.info.3.sns.1)\n\n7.81 [extra781] Check if Amazon Elasticsearch Service (ES) domains has encryption at-rest enabled (ens-mp.info.3.aws.au.1)\n\n7.73 [extra773] Check if CloudFront distributions are using WAF (Not Scored) (Not part of CIS benchmark) (ens-mp.s.2.aws.waf.1)\n\n7.44 [extra744] Check if API Gateway has a WAF ACL attached (Not Scored) (Not part of CIS benchmark) (ens-mp.s.2.aws.waf.2)\n\n7.126 [extra7126] Check if there are CMK KMS keys not used (op.exp.11.aws.kms.2)\n\n7.129 [extra7129] Check if Application Load Balancer has a WAF ACL attached (ens-mp.s.2.aws.waf.3)', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"ens\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '033'), 1, 'prowler');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('e86583b9-12dd-4316-980a-5eeeba86f9ca', 'AWS 24.0 Amazon Glue related security checks', 1, 'HighRisk', 'AWS 24.0 Amazon Glue related security checks - [glue]', '24.0 Amazon Glue related security checks - [glue] ******************\n\n7.114 [extra7114] Check if Glue development endpoints have S3 encryption enabled.\n\n7.115 [extra7115] Check if Glue database connection has SSL connection enabled.\n\n7.116 [extra7116] Check if Glue data catalog settings have metadata encryption enabled.\n\n7.117 [extra7117] Check if Glue data catalog settings have encrypt connection password enabled.\n\n7.118 [extra7118] Check if Glue ETL Jobs have S3 encryption enabled.\n\n7.119 [extra7119] Check if Glue development endpoints have CloudWatch logs encryption enabled.\n\n7.120 [extra7120] Check if Glue ETL Jobs have CloudWatch Logs encryption enabled.\n\n7.121 [extra7121] Check if Glue development endpoints have Job bookmark encryption enabled.\n\n7.122 [extra7122] Check if Glue ETL Jobs have Job bookmark encryption enabled.', '[{\"key\":\"group\",\"name\":\"检测分组\",\"defaultValue\":\"glue\",\"required\":true}]', 'hummer-aws-plugin', 'AWS 亚马逊云', 'aws.png', concat(unix_timestamp(now()), '034'), 1, 'prowler');

INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('ebc80d1e-5dd9-4b86-8037-fb7c9727084a', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('9929cc2a-7a9b-4643-a813-0e4359b09eb0', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('8ad73e84-141a-40c4-bd56-1813535e8e92', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('ee74d071-d39e-4b0e-b4a3-e7ad24fbce12', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('0dc8ae24-71f8-449a-8834-d59f8fbdf991', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('1fbd8c76-90e7-48e4-8281-ef597bb484e8', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('6bb291bd-fcdf-4aa9-8fdf-69e761c9c4e0', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('350a097a-dfeb-4fd0-a3af-49049da5c025', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('fa60960a-0e38-4502-9834-1ab1277e9aaa', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('39c87069-a3c6-4ab3-9974-f844a89872b5', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('10754933-241e-42db-bb3c-42e13cb40b0f', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('7c37887f-0b8d-444c-bad7-e43cd2b41578', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('197e41e7-cbc3-4eef-b5ad-5153c9232449', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('4a64e90e-92ea-4d5a-a753-3c5ca92a2b95', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('72af2230-8555-4e0c-a06a-721436a0644e', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('0a5a7796-6b53-408a-ba49-7fd9e51d82f4', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('a944a483-c23f-4d62-bdd8-d2a20a4aaeca', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('9b1d1a9c-6c7e-44db-a15c-c0c82b1040eb', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('0d51321e-e26c-4147-b730-5b1403384487', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('0d6270fc-3744-42cd-a850-65ac0b8ef514', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('c1375dfe-c0b1-4e53-9c2b-6a0f29258a08', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('1ab302fb-1b06-410a-b17a-fdf7843d6182', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f38d83c9-c4b9-47b8-8135-f9bdf96cf8ec', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('e86583b9-12dd-4316-980a-5eeeba86f9ca', 'safety');

INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('ebc80d1e-5dd9-4b86-8037-fb7c9727084a', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('9929cc2a-7a9b-4643-a813-0e4359b09eb0', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('8ad73e84-141a-40c4-bd56-1813535e8e92', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('ee74d071-d39e-4b0e-b4a3-e7ad24fbce12', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('0dc8ae24-71f8-449a-8834-d59f8fbdf991', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('1fbd8c76-90e7-48e4-8281-ef597bb484e8', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('6bb291bd-fcdf-4aa9-8fdf-69e761c9c4e0', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('350a097a-dfeb-4fd0-a3af-49049da5c025', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('fa60960a-0e38-4502-9834-1ab1277e9aaa', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('39c87069-a3c6-4ab3-9974-f844a89872b5', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('10754933-241e-42db-bb3c-42e13cb40b0f', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('7c37887f-0b8d-444c-bad7-e43cd2b41578', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('197e41e7-cbc3-4eef-b5ad-5153c9232449', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('4a64e90e-92ea-4d5a-a753-3c5ca92a2b95', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('72af2230-8555-4e0c-a06a-721436a0644e', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('0a5a7796-6b53-408a-ba49-7fd9e51d82f4', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('a944a483-c23f-4d62-bdd8-d2a20a4aaeca', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('9b1d1a9c-6c7e-44db-a15c-c0c82b1040eb', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('0d51321e-e26c-4147-b730-5b1403384487', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('0d6270fc-3744-42cd-a850-65ac0b8ef514', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('c1375dfe-c0b1-4e53-9c2b-6a0f29258a08', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('1ab302fb-1b06-410a-b17a-fdf7843d6182', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f38d83c9-c4b9-47b8-8135-f9bdf96cf8ec', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('e86583b9-12dd-4316-980a-5eeeba86f9ca', @groupId);

INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('034eb120-b4a6-4a38-bdb4-a6b50900900c', '72af2230-8555-4e0c-a06a-721436a0644e', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('1526e4e0-19e2-4081-ab35-3ee2d339bfa5', '6bb291bd-fcdf-4aa9-8fdf-69e761c9c4e0', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('1a8f0037-27ea-48d4-83b5-08972894da73', 'c1375dfe-c0b1-4e53-9c2b-6a0f29258a08', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2302b0d4-2479-428e-97de-877aabddf2bb', '4a64e90e-92ea-4d5a-a753-3c5ca92a2b95', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2ade0bf8-d9a0-4853-b1be-ce20171d6356', '9b1d1a9c-6c7e-44db-a15c-c0c82b1040eb', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('33cd7632-6389-4e35-8a03-2e464129f62c', '7c37887f-0b8d-444c-bad7-e43cd2b41578', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('3cfe49f8-94da-4963-aeb0-b67ec5d94871', 'fa60960a-0e38-4502-9834-1ab1277e9aaa', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('3d0cfd6f-fa60-48b5-bf2b-6060a269ef0f', 'a944a483-c23f-4d62-bdd8-d2a20a4aaeca', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('44e7b6e6-b8af-4f54-84ef-5f9a23665313', '1ab302fb-1b06-410a-b17a-fdf7843d6182', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('54f3c224-71f6-4ce7-935a-54ffbd33fa06', '39c87069-a3c6-4ab3-9974-f844a89872b5', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('59236010-9c79-4322-8d13-4406774a9b76', '9929cc2a-7a9b-4643-a813-0e4359b09eb0', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('67b5377e-3230-47de-86af-91c1bc7acaa6', '8ad73e84-141a-40c4-bd56-1813535e8e92', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('6e3202e6-b382-4213-b880-d3194a0e1a0e', 'f38d83c9-c4b9-47b8-8135-f9bdf96cf8ec', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('71755cba-4be6-4456-afc0-07fdf6572846', '0d51321e-e26c-4147-b730-5b1403384487', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('76b060b2-0039-42e0-ae74-73b771625c1f', '10754933-241e-42db-bb3c-42e13cb40b0f', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('953b0487-661d-4a07-b4ea-d8fdcd69c7a8', '197e41e7-cbc3-4eef-b5ad-5153c9232449', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('97f71ad9-a75b-4774-9b43-89a336507c0a', '1fbd8c76-90e7-48e4-8281-ef597bb484e8', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('99ee3e5d-9890-47fb-90b3-f9cb89ad8fa3', '0a5a7796-6b53-408a-ba49-7fd9e51d82f4', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('ac55224a-a457-41ed-ba3e-51d8098b10d1', '0d6270fc-3744-42cd-a850-65ac0b8ef514', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('ba2cdd7b-75b6-4068-ab2e-508dbd6c3ea8', 'e86583b9-12dd-4316-980a-5eeeba86f9ca', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('c4a5b858-e9a0-4a44-8723-2f0d45623ba5', '0dc8ae24-71f8-449a-8834-d59f8fbdf991', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('cbbfa025-2917-49bb-b4ec-c16560f3fed3', 'ebc80d1e-5dd9-4b86-8037-fb7c9727084a', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('ddda73c2-719e-4baf-b8c0-a7559cd1bd2d', 'ee74d071-d39e-4b0e-b4a3-e7ad24fbce12', 'prowler');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('fc081920-c525-4d78-94cb-5f62c848ed09', '350a097a-dfeb-4fd0-a3af-49049da5c025', 'prowler');



INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('159e19e9-e956-4c52-92fc-c9746372e448', '77');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('17dbe1a1-e9e7-4513-aa07-597ae932ff73', '10');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('17dbe1a1-e9e7-4513-aa07-597ae932ff73', '123');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('ca991f61-49a4-49b2-9d14-16ca338d8149', '124');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('68363ad8-cce8-4458-b8f1-9bd1d1af54a7', '83');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('bf9a87c9-f709-4f84-8a86-5afde3eb40c3', '107');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('f7b906de-63e0-479b-b766-2e50df8fbe19', '117');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('63dedb65-0237-4402-8a5c-1d2137840fdd', '100');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('b8e09c5a-fecc-4400-b831-d7f75f9cee01', '102');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('1aab5692-85a5-4151-b67c-8c2c93353916', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('5f6c1aed-8c46-48e6-b48d-2cf06568831f', '107');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('311daee9-3c15-4b19-8fb7-97823c57eb23', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('6359bdcd-0d1d-4e43-817c-cc338f07a065', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('ccf64ae6-7f99-40fe-b45f-d86a4b63bdcc', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('ab3306d0-e734-4977-a462-42de0e1cf263', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('5c4d5e15-ce0a-4322-8406-47e8bcb10bf4', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('6bbd42bc-a251-498a-8b19-8de8c55e32aa', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('f50705c1-8930-4a53-b32d-da08eda1161c', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('3808ac89-6fb0-4953-a6f3-a464f1b603bd', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('49fb8964-15ab-45b9-864c-69b7e7cd5b71', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('5227e5cd-7e66-4f32-8515-7895fdc79535', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('6bc48581-98bb-4563-9735-a505002e344f', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('fc94e69d-a3bb-46a4-9f24-60f8369c6f15', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('cfc3ad75-2599-47ab-bfb2-af8a07531250', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('afd0480e-651b-4229-aa68-d642e074fb59', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('ffecf574-f388-40ad-aebb-9a46ef798dcf', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('ae7de16c-0a39-4119-a5c0-d0916f549e95', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('332ce586-70de-4053-a922-f76d6340a03c', '48');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('33a70278-c772-4ef0-93c9-4b9d3df1e242', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('108c875b-bf3c-4034-b07d-15faa8715257', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('7557ce1b-aacf-4cd7-bb19-6e411621daf3', '46');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('9312ca46-1ce9-4e42-86b2-7f9b5c0db090', '46');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('6a71a114-ba92-4e0b-bd9d-2f6c8ecee88d', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('f6c72297-33db-49dd-a106-06cf2ff47069', '18');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('3e324555-83e2-4ac9-8ac2-1dae350d52ff', '18');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('6967e834-ace6-48d2-9f95-f541b614810d', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('c3259122-ac07-4256-83da-b6361c9d3abb', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('94d168d0-8e62-4173-96fd-326eb267273e', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('c95fde94-53a5-4658-98a4-56a0c6d951d4', '97');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('d690be79-2e8c-4054-bbe6-496bd29e91fe', '97');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('beda16d0-93fd-4366-9ebf-f5ce1360cd60', '97');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('8c635fda-7f89-4d5c-b0f4-2116f1b65554', '80');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('fdef013f-ce14-468a-9af4-1c0fabc7e6e1', '80');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('6fd132c0-b4df-4685-b132-5441d1aef2f8', '18');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('b1491f69-f3b8-40ae-9659-4242dbc30a0b', '97');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('0be7f5d4-766c-4b2b-910d-bec0f3aac977', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('07eb95ef-6d78-4b9a-8555-a42b6a16de99', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('5c47228c-7fe1-484b-a5b6-7c1968074f69', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('b57cbdba-b4d7-4da7-84db-25b9f2d5324b', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('bd1a0479-ef54-4208-a520-50caf6acfe87', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('fa5e89e3-417d-4296-9d17-ca51ed914be5', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('befc89d7-1811-404a-9226-f8ecc22820e0', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('fa60960a-0e38-4502-9834-1ab1277e9aaa', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('350a097a-dfeb-4fd0-a3af-49049da5c025', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('6bb291bd-fcdf-4aa9-8fdf-69e761c9c4e0', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('1fbd8c76-90e7-48e4-8281-ef597bb484e8', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('0dc8ae24-71f8-449a-8834-d59f8fbdf991', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('ee74d071-d39e-4b0e-b4a3-e7ad24fbce12', '123');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('8ad73e84-141a-40c4-bd56-1813535e8e92', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('e86583b9-12dd-4316-980a-5eeeba86f9ca', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('f38d83c9-c4b9-47b8-8135-f9bdf96cf8ec', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('1ab302fb-1b06-410a-b17a-fdf7843d6182', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('c1375dfe-c0b1-4e53-9c2b-6a0f29258a08', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('0d6270fc-3744-42cd-a850-65ac0b8ef514', '123');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('9929cc2a-7a9b-4643-a813-0e4359b09eb0', '119');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('0d51321e-e26c-4147-b730-5b1403384487', '122');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('9b1d1a9c-6c7e-44db-a15c-c0c82b1040eb', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('a944a483-c23f-4d62-bdd8-d2a20a4aaeca', '125');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('0a5a7796-6b53-408a-ba49-7fd9e51d82f4', '28');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('72af2230-8555-4e0c-a06a-721436a0644e', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('4a64e90e-92ea-4d5a-a753-3c5ca92a2b95', '100');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('197e41e7-cbc3-4eef-b5ad-5153c9232449', '97');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('7c37887f-0b8d-444c-bad7-e43cd2b41578', '124');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('10754933-241e-42db-bb3c-42e13cb40b0f', '113');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('39c87069-a3c6-4ab3-9974-f844a89872b5', '98');
INSERT INTO rule_inspection_report_mapping (`rule_id`, `report_id`) VALUES ('ebc80d1e-5dd9-4b86-8037-fb7c9727084a', '90');

INSERT INTO `plugin` ( `id`, `name`, `icon`, `update_time`, `scan_type`) values ('hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 'xray');
INSERT INTO rule_group (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('XRay 漏洞检测', '漏洞检测，支持主动、被动多种检测方式，支持常见web漏洞的自动化检测。', '漏洞检测', 'hummer-xray-plugin', 1);
SELECT @groupId := LAST_INSERT_ID();
INSERT INTO `cloud_account` (`id`, `name`, `credential`, `plugin_id`, `plugin_name`, `plugin_icon`, `status`, `create_time`, `update_time`, `creator`, `regions`, `proxy_id`) VALUES ('136d9d-f168-6107-6916-798k9651f668', 'Xray 漏洞检测', '{\"description\":\"国内颇受好评的安全评估工具，支持常见 web 安全问题检测和自定义 poc。\", \"targetAddress\":\"http://testphp.vulnweb.com\"}', 'hummer-xray-plugin', 'Xray', 'xray.png', 'VALID', concat(unix_timestamp(now()), '011'), concat(unix_timestamp(now()), '011'), 'admin', '[{\"regionId\":\"ALL\",\"regionName\":\"Xray 漏洞检测\"}]', 0);

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('cd26c655-7a9a-40c7-bbbd-daf313f91088', 'XRay 路径穿越检测', 1, 'HighRisk', 'XRay 路径穿越漏洞检测，支持常见平台和编码', '路径穿越检测 (key: path-traversal)\n\n路径穿越（也被称为路径遍历/directory traversal/path traversal）是通过使用 ../ 等目录控制序列或者文件的绝对路径来访问存储在文件系统上的任意文件和目录，特别是应用程序源代码、配置文件、重要的系统文件等。', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"path-traversal\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('8655bb52-093b-4fa5-a0c3-d42cc5f20c8b', 'XRay 目录枚举检测', 1, 'HighRisk', 'XRay 目录枚举漏洞检测，检测备份文件、临时文件、debug 页面、配置文件等10余类敏感路径和文件', '目录枚举 (key: dirscan)\n\n检测备份文件、临时文件、debug 页面、配置文件等10余类敏感路径和文件', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"dirscan\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('3fada30a-8878-406c-98ff-7528843b44d8', 'XRay 文件上传检测', 1, 'HighRisk', 'XRay 文件上传漏洞检测，支持常见的后端语言', '文件上传检测 (key: upload)\n\n文件上传漏洞检测，支持常见的后端语言', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"upload\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('032e5449-2107-42a2-8b58-124ee9f32e8e', 'XRay 弱口令检测', 1, 'HighRisk', 'XRay 弱口令漏洞检测，支持检测 HTTP 基础认证和简易表单弱口令，内置常见用户名和密码字典', '弱口令检测 (key: brute-force)\n\n弱口令漏洞检测，支持检测 HTTP 基础认证和简易表单弱口令，内置常见用户名和密码字典', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"brute-force\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('882faf36-0690-4f07-91f1-aff002ac3714', 'XRay 基线检查', 1, 'HighRisk', 'XRay 基线检查，检测低 SSL 版本、缺失的或错误添加的 http 头等', '基线检查 (key: baseline)\n\n基线检查，检测低 SSL 版本、缺失的或错误添加的 http 头等', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"baseline\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862', 'XRay 命令/代码注入检测', 1, 'HighRisk', 'XRay 命令/代码注入漏洞检测，支持 shell 命令注入、PHP 代码执行、模板注入等', '命令/代码注入检测 (key: cmd-injection)\n\nCommand Injection，即命令注入攻击，是指由于嵌入式应用程序或者web应用程序对用户提交的数据过滤不严格，导致黑客可以通过构造特殊命令字符串的方式，将数据提交至应用程序中，并利用该方式执行外部程序或系统命令实施攻击，非法获取数据或者网络资源等。', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"cmd-injection\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('e8a568ce-8678-4457-a225-499cfcb95b88', 'XRay 任意跳转检测', 1, 'HighRisk', 'XRay 任意跳转检测，支持 HTML meta 跳转、30x 跳转等', '任意跳转检测 (key: redirect)\n\n任意跳转检测，支持 HTML meta 跳转、30x 跳转等', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"redirect\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('d95c1dba-c8c0-4359-9d60-56c5bda9d779', 'XRay ssrf 检测', 1, 'HighRisk', 'XRay ssrf 漏洞检测，ssrf 检测模块，支持常见的绕过技术和反连平台检测', 'ssrf 检测 (key: ssrf)\n\n服务端请求伪造（Server Side Request Forgery, SSRF）指的是攻击者在未能取得服务器所有权限时，利用服务器漏洞以服务器的身份发送一条构造好的请求给服务器所在内网。SSRF攻击通常针对外部网络无法直接访问的内部系统。', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"ssrf\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('d8b7c414-76be-4c61-adb0-dc548f4d9f17', 'XRay jsonp 检测', 1, 'HighRisk', 'XRay jsonp 漏洞检测，检测包含敏感信息可以被跨域读取的 jsonp 接口', 'jsonp 检测 (key: jsonp)\n\nJsonp(JSON with Padding) 是json 的一种\"使用模式\"，可以让网页从别的域名（网站）那获取资料，即跨域读取数据。jsonp 漏洞检测，检测包含敏感信息可以被跨域读取的 jsonp 接口', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"jsonp\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f2791618-0a3a-4e63-9f57-0f35be7465e5', 'XRay XSS 漏洞检测', 1, 'HighRisk', 'XRay 利用语义分析的方式检测 XSS 跨站脚本攻击漏洞', 'XSS漏洞检测 (key: xss)\n\nXSS全称跨站脚本(Cross Site Scripting)，为不和层叠样式表(Cascading Style Sheets, CSS)的缩写混淆，故缩写为XSS。跨站点脚本(XSS)攻击是一种注射型攻击，攻击者在可信的网页中嵌入恶意代码，用户访问可信网页时触发XSS而被攻击', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"xss\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('1e58a7be-5ca4-4a50-a00f-87446695c1b8', 'XRay XML 实体注入检测', 1, 'HighRisk', 'XRay XML 实体注入漏洞检测，支持有回显和反连平台检测', 'XML 实体注入检测 (key: xxe)\n\nXXE漏洞全称XML External Entity Injection即xml外部实体注入漏洞，XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致可加载恶意外部文件，造成文件读取、命令执行、内网端口检测、攻击内网网站、发起dos攻击等危害。', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"xxe\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('4aba704c-f0b0-4562-aaf9-290abd07bfb0', 'XRay Thinkphp系列漏洞检测', 1, 'HighRisk', 'XRay Thinkphp系列漏洞检测，检测ThinkPHP开发的网站的相关漏洞', 'Thinkphp系列漏洞检测 (高级版，key: thinkphp)\n\nThinkphp系列漏洞检测，检测ThinkPHP开发的网站的相关漏洞', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"thinkphp\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('733bfbc4-a96e-4bb1-91cc-9e2899fe4f41', 'XRay Struts2 系列漏洞检测', 1, 'HighRisk', 'XRay Struts2 系列漏洞检测，检测目标网站是否存在Struts2系列漏洞，包括s2-016、s2-032、s2-045等常见漏洞', 'Struts2 系列漏洞检测 (高级版，key: struts)\n\nXRay Struts2 系列漏洞检测，检测目标网站是否存在Struts2系列漏洞，包括s2-016、s2-032、s2-045等常见漏洞', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"struts\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('9db4936b-b345-4532-b70b-868d0e2ebbc3', 'XRay SQL 注入检测', 1, 'HighRisk', 'XRay SQL 注入攻击漏洞检测，支持报错注入、布尔注入和时间盲注等', 'SQL 注入检测 (key: sqldet)\n\nSQL注入攻击是web安全防御所面临的最常见攻击手段。 攻击者利用web网站没有细致过滤访问者提交的SQL语句的漏洞，构造特殊的输入参数作为访问请求的一部分，通过绕过服务器防护执行恶意SQL命令的方式，获取web服务器系统信息、拷贝或删除文件、操作数据库、甚至提升权限以进行更多恶意行为。', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"sqldet\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('2974f736-a00c-4448-b275-f19f9defb560', 'XRay POC 管理', 1, 'HighRisk', 'XRay POC 框架管理检测', 'poc 管理 (key: phantasm)\n\n默认内置部分常用的 poc，用户可以根据需要自行构建 poc 并运行', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"phantasm\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('f5dccf29-2366-4ea2-acaa-98f7ddfcd0e9', 'XRay CRLF 注入检测', 1, 'HighRisk', 'XRay CRLF 注入检测，检测 HTTP 头注入，支持 query、body 等位置的参数', 'CRLF 注入 (key: crlf-injection)\n\nCRLF是Carriage-Return Line-Feed的缩写，意思是回车换行，就是回车(CR, ASCII 13, \\r) 换行(LF, ASCII 10, \\n)。 换行在有的ASCII码表也用newline（简nl）来进行表示,这里的lf是line feed的概念，意思是一样的。', '[{\"key\":\"plugins\",\"name\":\"检测分组\",\"defaultValue\":\"crlf-injection\",\"required\":true}]', 'hummer-xray-plugin', 'XRay', 'xray.png', concat(unix_timestamp(now()), '001'), 1, 'xray');

INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('8655bb52-093b-4fa5-a0c3-d42cc5f20c8b', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('9db4936b-b345-4532-b70b-868d0e2ebbc3', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f2791618-0a3a-4e63-9f57-0f35be7465e5', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('cd26c655-7a9a-40c7-bbbd-daf313f91088', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('1e58a7be-5ca4-4a50-a00f-87446695c1b8', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('2974f736-a00c-4448-b275-f19f9defb560', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('3fada30a-8878-406c-98ff-7528843b44d8', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('032e5449-2107-42a2-8b58-124ee9f32e8e', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('d8b7c414-76be-4c61-adb0-dc548f4d9f17', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('d95c1dba-c8c0-4359-9d60-56c5bda9d779', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('882faf36-0690-4f07-91f1-aff002ac3714', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('e8a568ce-8678-4457-a225-499cfcb95b88', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('f5dccf29-2366-4ea2-acaa-98f7ddfcd0e9', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('4aba704c-f0b0-4562-aaf9-290abd07bfb0', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('733bfbc4-a96e-4bb1-91cc-9e2899fe4f41', 'safety');

INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('8655bb52-093b-4fa5-a0c3-d42cc5f20c8b',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('9db4936b-b345-4532-b70b-868d0e2ebbc3',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f2791618-0a3a-4e63-9f57-0f35be7465e5',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('cd26c655-7a9a-40c7-bbbd-daf313f91088',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('1e58a7be-5ca4-4a50-a00f-87446695c1b8',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('2974f736-a00c-4448-b275-f19f9defb560',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('3fada30a-8878-406c-98ff-7528843b44d8',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('032e5449-2107-42a2-8b58-124ee9f32e8e',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d8b7c414-76be-4c61-adb0-dc548f4d9f17',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d95c1dba-c8c0-4359-9d60-56c5bda9d779',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('882faf36-0690-4f07-91f1-aff002ac3714',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('e8a568ce-8678-4457-a225-499cfcb95b88',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('f5dccf29-2366-4ea2-acaa-98f7ddfcd0e9',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('4aba704c-f0b0-4562-aaf9-290abd07bfb0',  @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('733bfbc4-a96e-4bb1-91cc-9e2899fe4f41',  @groupId);

INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('8655bb52-093b-4fa5-a0c3-d42cc5f20c8b', '38');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('8655bb52-093b-4fa5-a0c3-d42cc5f20c8b', '56');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('8655bb52-093b-4fa5-a0c3-d42cc5f20c8b', '57');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('9db4936b-b345-4532-b70b-868d0e2ebbc3', '56');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('9db4936b-b345-4532-b70b-868d0e2ebbc3', '38');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f2791618-0a3a-4e63-9f57-0f35be7465e5', '50');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f2791618-0a3a-4e63-9f57-0f35be7465e5', '73');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f2791618-0a3a-4e63-9f57-0f35be7465e5', '116');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862', '63');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862', '65');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862', '67');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862', '22');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862', '50');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4ee4f0f0-9990-4570-baa3-356421672862', '73');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('cd26c655-7a9a-40c7-bbbd-daf313f91088', '70');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('cd26c655-7a9a-40c7-bbbd-daf313f91088', '53');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('1e58a7be-5ca4-4a50-a00f-87446695c1b8', '73');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('2974f736-a00c-4448-b275-f19f9defb560', '120');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('3fada30a-8878-406c-98ff-7528843b44d8', '38');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('032e5449-2107-42a2-8b58-124ee9f32e8e', '121');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('032e5449-2107-42a2-8b58-124ee9f32e8e', '34');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('032e5449-2107-42a2-8b58-124ee9f32e8e', '111');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('032e5449-2107-42a2-8b58-124ee9f32e8e', '32');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d8b7c414-76be-4c61-adb0-dc548f4d9f17', '102');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d8b7c414-76be-4c61-adb0-dc548f4d9f17', '94');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d8b7c414-76be-4c61-adb0-dc548f4d9f17', '100');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d95c1dba-c8c0-4359-9d60-56c5bda9d779', '18');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d95c1dba-c8c0-4359-9d60-56c5bda9d779', '19');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d95c1dba-c8c0-4359-9d60-56c5bda9d779', '29');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('882faf36-0690-4f07-91f1-aff002ac3714', '5');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('882faf36-0690-4f07-91f1-aff002ac3714', '124');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('e8a568ce-8678-4457-a225-499cfcb95b88', '123');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f5dccf29-2366-4ea2-acaa-98f7ddfcd0e9', '125');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('f5dccf29-2366-4ea2-acaa-98f7ddfcd0e9', '124');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4aba704c-f0b0-4562-aaf9-290abd07bfb0', '125');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('4aba704c-f0b0-4562-aaf9-290abd07bfb0', '124');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('733bfbc4-a96e-4bb1-91cc-9e2899fe4f41', '125');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('733bfbc4-a96e-4bb1-91cc-9e2899fe4f41', '124');

INSERT INTO `plugin` ( `id`, `name`, `icon`, `update_time`, `scan_type`) values ('hummer-tsunami-plugin', 'Tsunami', 'tsunami.png', concat(unix_timestamp(now()), '001'), 'tsunami');

INSERT INTO `cloud_account` (`id`, `name`, `credential`, `plugin_id`, `plugin_name`, `plugin_icon`, `status`, `create_time`, `update_time`, `creator`, `regions`, `proxy_id`) VALUES ('6953e0fd-57f3-4ca8-915f-e8b97725fcd7', 'Tsunami 网络安全检测', '{\"description\":\"功能强大的通用网络安全检测工具,可以帮助广大安全研究人员以高可信度的方式检测和检测高危严重漏洞。\",\"ip\":\"127.0.0.1\"}', 'hummer-tsunami-plugin', 'Tsunami', 'tsunami.png', 'VALID', concat(unix_timestamp(now()), '001'), concat(unix_timestamp(now()), '001'), 'admin', '[{"regionId":"ALL","regionName":"Tsunami 网络安全检测"}]', 0);

INSERT INTO `rule_group` (`name`, `description`, `level`, `plugin_id`, `flag`) VALUES ('Baidu 等保预检', '等保合规检查（全称为等级保护合规检查）为您提供了全面覆盖通信网络、区域边界、计算环境和管理中心的网络安全检查。', '等保三级', 'hummer-baidu-plugin', '1');
SELECT @groupId := LAST_INSERT_ID();

INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('09b1030c-e094-4d23-a75b-e3d876f55a67', 'Baidu CDN 域名 HTTPS 监听检测', '1', 'HighRisk', 'Badiu 检测 CDN 域名是否开启 HTTPS 监听，若开启视为“合规”，否则视为“不合规”', 'policies:\n    # 检测CDN域名是否开启HTTPS监听\n    - name: baidu-cdn-ssl-protocol\n      resource: baidu.cdn\n      filters:\n        - type: ssl-protocol', '[]', 'hummer-baidu-plugin', '百度云', 'baidu.png', concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('2fc93189-2ebe-40c7-b5cb-61d52d9184d8', 'Baidu BCC 实例公网 IP 监测', '1', 'HighRisk', 'Baidu BCC实例未直接绑定公网 IP，符合视为“合规”，否则视为“不合规”。该规则仅适用于 IPv4 协议', 'policies:\n    # bcc实例未直接绑定公网IP，视为“合规”。该规则仅适用于 IPv4 协议。\n    - name: baidu-instance-public-ipaddress\n      resource: baidu.instance\n      filters:\n        - type: public-ip-address', '[]', 'hummer-baidu-plugin', '百度云', 'baidu.png',  concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('45a0e76a-2f12-4681-b955-4d0eab099dce', 'Baidu BCC 实例网络类型检测', '1', 'HighRisk', 'Baidu 账号下所有 BBC 实例已关联到 VPC，关联到视为“合规”，否则视为“不合规”', 'policies:\n    # 实例网络类型扫描 账号下所有bcc实例已关联到VPC\n    - name: baidu-instance-network-type\n      resource: baidu.instance\n      filters:\n        - type: instance-network-type', '[]', 'hummer-baidu-plugin', '百度云', 'baidu.png',  concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('73b0db2f-b946-4d03-a4bd-95ee7d4c9108', 'Baidu 普通型负载公网 IP 绑定检测', '1', 'HighRisk', 'Baidu 普通型负载均衡实例未直接绑定公网 IP，视为“合规”BBC否则视为“不合规”。该规则仅适用于 IPv4 协议', 'policies:\n    # 普通型负载均衡实例未直接绑定公网IP，视为“合规”。\n    - name: baidu-blb-public-ip\n      resource: baidu.blb\n      filters:\n        - type: public-ip-address', '[]', 'hummer-baidu-plugin', '百度云', 'baidu.png', concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('77001a71-f984-4fea-9883-44c566ca13fb', 'Baidu EIP 带宽峰值检测', '1', 'HighRisk', 'Baidu 检测您账号下的弹性 IP 实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测您账号下的弹性IP实例是否达到最低带宽要求\n    - name: baidu-eip-bandwidth\n      resource: baidu.eip\n      filters:\n        - type: bandwidth\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"带宽\",\"defaultValue\":\"2\",\"required\":true}]', 'hummer-baidu-plugin', '百度云', 'baidu.png',  concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('862db318-ce25-41ed-85fa-fc1ea4d691ec', 'Baidu 磁盘加密状态检测', '1', 'HighRisk', 'Baidu 账号下所有的磁盘均已加密；是则视为“合规”，否则视为“不合规”', 'policies:\n    # 所有的磁盘均已加密\n    - name: baidu-volume-encrypted\n      resource: baidu.volume\n      filters:\n        - type: encrypted', '[]', 'hummer-baidu-plugin', '百度云', 'baidu.png',  concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('98a56ff2-03fd-49a9-b52c-982ce0f04f70', 'Baidu BCC VPC 检测', '1', 'HighRisk', 'Baidu 账号下的 BCC 实例指定属于哪些 VPC, 属于则合规，不属于则\"不合规\"', 'policies:\n    # #bcc实例指定属于哪些VPC, 属于则合规\n    - name: baidu-instance-vpc-type\n      resource: baidu.instance\n      filters:\n        - type: vpc-type\n          vpcIds: [ \'${{value1}}\', \'${{value2}}\']', '[{\"key\":\"value1\",\"name\":\"vpcid1\",\"defaultValue\":\"111\",\"required\":true},{\"key\":\"value2\",\"name\":\"vpcid2\",\"defaultValue\":\"222\",\"required\":true}]', 'hummer-baidu-plugin', '百度云', 'baidu.png',  concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('bb8e4fea-a238-4231-87b8-3aac5c2c2323', 'Baidu BBC 实例公网 IP 检测', '1', 'HighRisk', 'Baidu BBC 实例未直接绑定公网 IP，符合视为“合规”，否则视为“不合规”。该规则仅适用于 IPv4 协议', 'policies:\n    # 检测 BBC 实例未直接绑定公网 IP，视为“合规”。\n    - name: baidu-bbc-public-ip\n      resource: baidu.bbc\n      filters:\n        - type: public-ip-address', '[]', 'hummer-baidu-plugin', '百度云', 'baidu.png',  concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('ca3f9cfa-892e-43ce-abfc-4373329926f3', 'Baidu 应用型负载公网 IP 绑定检测', '1', 'HighRisk', 'Baidu 应用型负载均衡实例未直接绑定公网 IP，视为“合规”，否则视为“不合规”。该规则仅适用于 IPv4 协议', 'policies:\n    # 应用型负载均衡实例未直接绑定公网 IP，视为“合规”。\n    - name: baidu-app-blb-public-ip\n      resource: baidu.app-blb\n      filters:\n        - type: public-ip-address', '[]', 'hummer-baidu-plugin', '百度云', 'baidu.png',  concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('d3b291c0-e8b5-4560-84b2-4f23d0235401', 'Baidu BBC 实例带宽检测', '1', 'HighRisk', 'Baidu 检测 BBC 实例是否达到最低带宽要求，符合视为“合规”，否则视为“不合规”', 'policies:\n    # 检测BBC实例是否达到最低带宽要求\n    - name: baidu-bbc-bandwidth\n      resource: baidu.bbc\n      filters:\n        - type: bandwidth\n          value: ${{value}}', '[{\"key\":\"value\",\"name\":\"带宽\",\"defaultValue\":\"2\",\"required\":true}]', 'hummer-baidu-plugin', '百度云', 'baidu.png',  concat(unix_timestamp(now()), '001'), '1', 'custodian');
INSERT INTO `rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`) VALUES ('fe93c715-8803-4a9b-b2f0-522571b162fb', 'Baidu SecurityGroup 安全组端口访问', '1', 'HighRisk', 'Baidu 账号下 ECS 安全组配置允许所有端口访问视为”不合规“，否则为”合规“', 'policies:\n    # 账号下安全组配置允许所有端口访问视为”不合规“，否则为”合规“\n    - name: baidu-sg-source-ports\n      resource: baidu.security-group\n      filters:\n        - type: source-ports\n          SourceIp: \'${{soruceIp}}\'\n          PortRange: \'${{portRange}}\'', '[{\"key\":\"soruceIp\",\"name\":\"源ip\",\"defaultValue\":\"all\",\"required\":true},{\"key\":\"portRange\",\"name\":\"端口范围\",\"defaultValue\":\"-1\",\"required\":true}]', 'hummer-baidu-plugin', '百度云', 'baidu.png', concat(unix_timestamp(now()), '001'), '1', 'custodian');

INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('2fc93189-2ebe-40c7-b5cb-61d52d9184d8', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('45a0e76a-2f12-4681-b955-4d0eab099dce', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('98a56ff2-03fd-49a9-b52c-982ce0f04f70', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('77001a71-f984-4fea-9883-44c566ca13fb', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('09b1030c-e094-4d23-a75b-e3d876f55a67', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('fe93c715-8803-4a9b-b2f0-522571b162fb', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('ca3f9cfa-892e-43ce-abfc-4373329926f3', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('862db318-ce25-41ed-85fa-fc1ea4d691ec', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('73b0db2f-b946-4d03-a4bd-95ee7d4c9108', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('bb8e4fea-a238-4231-87b8-3aac5c2c2323', @groupId);
INSERT INTO `rule_group_mapping` (`rule_id`, `group_id`) VALUES ('d3b291c0-e8b5-4560-84b2-4f23d0235401', @groupId);

INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('2fc93189-2ebe-40c7-b5cb-61d52d9184d8', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('45a0e76a-2f12-4681-b955-4d0eab099dce', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('98a56ff2-03fd-49a9-b52c-982ce0f04f70', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('77001a71-f984-4fea-9883-44c566ca13fb', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('09b1030c-e094-4d23-a75b-e3d876f55a67', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('fe93c715-8803-4a9b-b2f0-522571b162fb', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('ca3f9cfa-892e-43ce-abfc-4373329926f3', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('862db318-ce25-41ed-85fa-fc1ea4d691ec', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('73b0db2f-b946-4d03-a4bd-95ee7d4c9108', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('bb8e4fea-a238-4231-87b8-3aac5c2c2323', 'safety');
INSERT INTO `rule_tag_mapping` (`rule_id`, `tag_key`) VALUES ('d3b291c0-e8b5-4560-84b2-4f23d0235401', 'safety');

INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('042e3d80-22b6-4e44-b696-a7047b284e62', '77001a71-f984-4fea-9883-44c566ca13fb', 'baidu.eip');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('154d8a44-ea0f-4394-994d-448883264b16', '45a0e76a-2f12-4681-b955-4d0eab099dce', 'baidu.instance');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('28e4742e-2b3a-45e7-8d74-75def002d91c', 'fe93c715-8803-4a9b-b2f0-522571b162fb', 'baidu.security-group');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('2f6370e4-3eb1-4374-b783-a6961d6c3ace', '862db318-ce25-41ed-85fa-fc1ea4d691ec', 'baidu.volume');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('44af820d-ab67-4810-bd50-451fb1706053', 'ca3f9cfa-892e-43ce-abfc-4373329926f3', 'baidu.app-blb');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('9196070f-a848-4f1d-ad46-d07ab7fb77f5', 'bb8e4fea-a238-4231-87b8-3aac5c2c2323', 'baidu.bbc');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('97faef6e-c7e8-4178-9f77-0237a864b18a', 'd3b291c0-e8b5-4560-84b2-4f23d0235401', 'baidu.bbc');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('a52d35c8-7790-4d70-9467-2070dc55da82', '09b1030c-e094-4d23-a75b-e3d876f55a67', 'baidu.cdn');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('bea2987e-3421-4c46-95f0-5a78649fca51', '98a56ff2-03fd-49a9-b52c-982ce0f04f70', 'baidu.instance');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('dff8b9df-4767-4d1d-a3cc-f4d38c4b1a79', '73b0db2f-b946-4d03-a4bd-95ee7d4c9108', 'baidu.blb');
INSERT INTO `rule_type` (`id`, `rule_id`, `resource_type`) VALUES ('fc0aadcd-ec6a-4370-b30e-09c585ad2689', '2fc93189-2ebe-40c7-b5cb-61d52d9184d8', 'baidu.instance');

INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('2fc93189-2ebe-40c7-b5cb-61d52d9184d8', '18');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('45a0e76a-2f12-4681-b955-4d0eab099dce', '3');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('98a56ff2-03fd-49a9-b52c-982ce0f04f70', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('77001a71-f984-4fea-9883-44c566ca13fb', '2');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('09b1030c-e094-4d23-a75b-e3d876f55a67', '52');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('fe93c715-8803-4a9b-b2f0-522571b162fb', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('ca3f9cfa-892e-43ce-abfc-4373329926f3', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('862db318-ce25-41ed-85fa-fc1ea4d691ec', '53');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('73b0db2f-b946-4d03-a4bd-95ee7d4c9108', '10');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('bb8e4fea-a238-4231-87b8-3aac5c2c2323', '18');
INSERT INTO `rule_inspection_report_mapping` (`rule_id`, `report_id`) VALUES ('d3b291c0-e8b5-4560-84b2-4f23d0235401', '2');
