
INSERT INTO `hummer_risk`.`rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`, `suggestion`, `xpack_tag`) VALUES ('8a5961b5-6c8d-4518-9bfe-a0712e0a1990', 'Aliyun RAM 根帐户访问密钥检测', 1, 'CriticalRisk', '确保不存在根帐户访问密钥，不是root账户或不存在密钥视为”合规“，否则视为”不合规“', 'policies:\n  #  确保不存在根帐户访问密钥，不是root账户或不存在密钥视为”合规“，否则视为”不合规“\n  - name: aliyun-ram-no-root-access-key\n    resource: aliyun.ram-user\n    filters:\n      - type: credential\n        key: access_keys\n        value: 0', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '004'), 1, 'custodian', NULL, 0);
INSERT INTO `hummer_risk`.`rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`, `suggestion`, `xpack_tag`) VALUES ('4ded1dcc-2b8e-4a9f-b33a-91651a97764a', 'Aliyun RAM 定期轮换访问密钥检测', 1, 'HighRisk', 'AK/SK是重要的访问凭证，一般情况下需要用户定期轮换所有访问密钥。如果没有开启定期轮换或轮换周期大于90天视为”不合规“，否则视为”合规“', 'policies:\n  #  AK/SK是重要的访问凭证，一般情况下需要用户定期轮换所有访问密钥。如果没有开启定期轮换或轮换周期大于90天视为”不合规“，否则视为”合规“\n  - name: aliyun-ram-rotate-access-key-90-days\n    resource: aliyun.ram-user\n    filters:\n      - type: credential\n        key: access_keys.active\n        value: true\n      - type: credential\n        key: access_keys.last_rotated\n        value_type: age\n        value: 90\n        op: gt\n      - type: credential\n        key: access_keys.last_rotated\n        value: null\n        op: ne', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '004'), 1, 'custodian', NULL, 0);
INSERT INTO `hummer_risk`.`rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`, `suggestion`, `xpack_tag`) VALUES ('db88a915-0a33-406b-8719-3ab807a204d3', 'Aliyun RAM 密码使用时间检测', 1, 'MediumRisk', '确保 RAM 密码使用时间不能超过某一时间，超期时间小于90天视为”不合规“，否则视为”合规“', 'policies:\n  #  确保 RAM 密码使用时间不能超过某一时间，超期时间小于90天视为”不合规“，否则视为”合规“\n  - name: aliyun-ram-password-policy-expires-passwords\n    resource: aliyun.ram-password-policy\n    filters:\n      - type: password-policy\n        key: MaxPasswordAge\n        value: 90\n        op: lt', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '004'), 1, 'custodian', NULL, 0);
INSERT INTO `hummer_risk`.`rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`, `suggestion`, `xpack_tag`) VALUES ('a3e8e54a-3820-4bbc-9057-a86ad109f417', 'Aliyun RAM 密码策略登录检测', 1, 'MediumRisk', '确保 RAM 密码策略防止密码超期后不可以登录，依然可以登录视为”不合规“，否则视为”合规“', 'policies:\n  #  确保 RAM 密码策略防止密码超期后不可以登录，依然可以登录视为”不合规“，否则视为”合规“\n  - name: aliyun-ram-password-policy-expires-passwords\n    resource: aliyun.ram-password-policy\n    filters:\n      - type: password-policy\n        key: HardExpire\n        value: false', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '004'), 1, 'custodian', NULL, 0);
INSERT INTO `hummer_risk`.`rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`, `suggestion`, `xpack_tag`) VALUES ('0a7e5e67-1999-4d91-9acd-bbe9a7521222', 'Aliyun RAM 密码策略长度检测', 1, 'MediumRisk', 'RAM 密码策略的长度不能少于14，长度小于14视为”不合规“，否则视为”合规“', 'policies:\n  #  RAM 密码策略的长度不能少于14，长度小于14视为”不合规“，否则视为”合规“\n  - name: aliyun-ram-password-policy-minimum-length-14\n    resource: aliyun.ram-password-policy\n    filters:\n      - type: password-policy\n        key: MinimumPasswordLength\n        value: 14\n        op: lt', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '004'), 1, 'custodian', NULL, 0);
INSERT INTO `hummer_risk`.`rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`, `suggestion`, `xpack_tag`) VALUES ('643a4446-53c5-4899-8aa1-72708c8067da', 'Aliyun RAM 密码策略检查', 1, 'MediumRisk', 'RAM 密码策略检查，需要包含特殊符号，大写字母，小写字母，包含视为”合规“，否则为”不合规“', 'policies:\n  #  RAM 密码策略检查，需要包含特殊符号，大写字母，小写字母，包含视为”合规“，否则为”不合规“\n  - name: aliyun-ram-password-policy-require-symbol\n    resource: aliyun.ram-password-policy\n    filters:\n    - or:\n      - type: password-policy\n        key: RequireSymbols\n        value: false\n      - type: password-policy\n        key: RequireLowercaseCharacters\n        value: false\n      - type: password-policy\n        key: RequireUppercaseCharacters\n        value: false', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '004'), 1, 'custodian', NULL, 0);
INSERT INTO `hummer_risk`.`rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`, `suggestion`, `xpack_tag`) VALUES ('e02b3f86-5ba8-4b14-833f-66567ccf5725', 'Aliyun RAM 防止密码重复使用检查', 1, 'MediumRisk', '确保 RAM 密码策略防止密码重复使用，需要设置不小于24，同时要确认已开启密码策略配置。开启视为”合规“，否则为”不合规“', 'policies:\n  #  确保 RAM 密码策略防止密码重复使用，需要设置不小于24，同时要确认已开启密码策略配置。开启视为”合规“，否则为”不合规“\n  - name: aliyun-ram-password-policy-reuse-24\n    resource: aliyun.ram-password-policy\n    filters:\n      - type: password-policy\n        key: PasswordReusePrevention\n        value: 24\n        op: lt', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '004'), 1, 'custodian', NULL, 0);
INSERT INTO `hummer_risk`.`rule` (`id`, `name`, `status`, `severity`, `description`, `script`, `parameter`, `plugin_id`, `plugin_name`, `plugin_icon`, `last_modified`, `flag`, `scan_type`, `suggestion`, `xpack_tag`) VALUES ('5ae66cce-623c-4d6a-9d7e-83ffc1ec121b', 'Aliyun SAML 提供商检测', 1, 'LowRisk', '检查是否有 SAML 提供商，SAML 帮助用户在每次进行身份验证时默认担任角色。存在视为”合规“，否则视为”不合规“', 'policies:\n  #  检查是否有 SAML 提供商，SAML 帮助用户在每次进行身份验证时默认担任角色。存在视为”合规“，否则视为”不合规“\n  - name: aliyun-ram-check-saml-providers\n    resource: aliyun.ram\n    filters:\n       - type: has-saml-providers\n         value: false', '[]', 'hummer-aliyun-plugin', '阿里云', 'aliyun.png', concat(unix_timestamp(now()), '004'), 1, 'custodian', NULL, 0);
